import{d as U,p as O,ம as M,n as E,e0 as W,r,q as C,c as z,a as L,x as G,w as a,b as e,V as H,h as o,i as J,e as F,z as b,t as v,at as K,f as w,m as Q,T as X,W as d,e1 as A,e2 as Y,bG as Z,j as ee,am as te,R as ae,ao as se,bs as oe,y as ne,bt as ue,H as ie,I as re,J as le}from"./index-BRylzrLF.js";const ce={class:"text-center"},me={class:"text-h6 font-weight-light mb-2"},fe=U({__name:"NouveauProjet",emits:["nouveau"],setup(ve,{emit:P}){const B=P,c=O(),{$மொ:n}=M(),{mdAndUp:D}=E(),h=W(),x=r(!1),u=r(0),l=["noms","descriptions","motsClefs","ajouterBds","confirmation"],T=C(()=>{switch(l[u.value]){case"noms":return"projet.nouveau.titreNoms";case"descriptions":return"projet.nouveau.titreDescriptions";case"motsClefs":return"projet.nouveau.titreMotsClefs";case"ajouterBds":return"projet.nouveau.titreAjouterBds";case"confirmation":return"projet.nouveau.titreConfirmation";default:return""}}),y=C(()=>{switch(l[u.value]){case"noms":return"projet.nouveau.sousTitreNoms";case"descriptions":return"projet.nouveau.sousTitreDescriptions";case"motsClefs":return"projet.nouveau.sousTitreMotsClefs";case"ajouterBds":return"projet.nouveau.sousTitreAjouterBds";case"confirmation":return"projet.nouveau.sousTitreConfirmation";default:return""}}),$=()=>{const t=l[u.value];u.value++},k=()=>{const t=l[u.value];u.value--},g=C(()=>{switch(l[u.value]){case"noms":return{actif:Object.keys(m.value).length>0,visible:!0};case"confirmation":return{actif:!1,visible:!1};default:return{actif:!0,visible:!0}}}),N=C(()=>{switch(l[u.value]){case"noms":return{actif:!1,visible:!1};case"confirmation":return{actif:!j.value,visible:!0};default:return{actif:!0,visible:!0}}}),m=r({}),q=t=>{m.value=t},f=r({}),I=t=>{f.value=t},p=r([]),_=r([]),V=r(!1),j=r(!1),S=async()=>{j.value=!0;const t=await c.projets.créerProjet();if(!t)throw new Error("Projet non créé.");await c.projets.sauvegarderNomsProjet({idProjet:t,noms:Object.fromEntries(Object.entries(m.value))}),await c.projets.sauvegarderDescriptionsProjet({idProjet:t,descriptions:Object.fromEntries(Object.entries(f.value))}),await c.projets.ajouterMotsClefsProjet({idProjet:t,idsMotsClefs:p.value}),await Promise.all(_.value.map(async s=>await c.projets.ajouterBdProjet({idProjet:t,idBd:s}))),B("nouveau",t),R(),V.value&&h.push(encodeURI(`/données/projet/${encodeURIComponent(t)}`))},R=()=>{m.value={},f.value={},p.value=[],_.value=[],u.value=0,j.value=!1,x.value=!1};return(t,s)=>(L(),z(G,{modelValue:x.value,"onUpdate:modelValue":s[5]||(s[5]=i=>x.value=i)},{activator:a(({props:i})=>[ie(t.$slots,"activator",re(le({props:i})))]),default:a(()=>[e(H,{class:"mx-auto","min-width":o(D)?750:300},{default:a(()=>[e(J,null,{default:a(()=>[e(F,{class:"text-h5 justify-space-between"},{default:a(()=>[b("span",null,v(o(n)(T.value)),1)]),_:1}),e(K,null,{default:a(()=>[w(v(o(n)(y.value)),1)]),_:1})]),_:1}),e(Q,null,{default:a(()=>[e(X,{modelValue:u.value,"onUpdate:modelValue":s[4]||(s[4]=i=>u.value=i),style:{"overflow-y":"scroll"}},{default:a(()=>[e(d,{value:0},{default:a(()=>[e(A,{"texte-aucun-nom":o(n)("communs.texteAucunNom"),"indice-langue":o(n)("communs.indiceLangue"),"etiquette-nom":o(n)("communs.étiquetteNom"),"indice-nom":o(n)("projets.nouveau.texteIndiceNom"),"noms-initiaux":m.value,"autorisation-modification":!0,onAjusterNoms:q},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1}),e(d,{value:1},{default:a(()=>[e(A,{"texte-aucun-nom":o(n)("projets.nouveau.texteAucuneDescription"),"indice-langue":o(n)("communs.indiceLangue"),"etiquette-nom":o(n)("projets.nouveau.texteÉtiquetteDescription"),"indice-nom":o(n)("projets.nouveau.texteIndiceDescription"),"noms-initiaux":f.value,"autorisation-modification":!0,onAjusterNoms:I},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1}),e(d,{value:2},{default:a(()=>[e(Y,{multiples:"",originaux:p.value,onSelectionnee:s[0]||(s[0]=i=>p.value=i)},null,8,["originaux"])]),_:1}),e(d,{value:3},{default:a(()=>[e(Z,{multiples:!1,originales:_.value,onSelectionnee:s[1]||(s[1]=i=>_.value=i)},null,8,["originales"])]),_:1}),e(d,{value:4},{default:a(()=>[b("div",ce,[b("h3",me,v(o(n)("projets.nouveau.texteCréer")),1),b("p",null,[e(ee,{class:"mt-3",variant:"outlined",loading:j.value,onClick:s[2]||(s[2]=()=>S())},{default:a(()=>[w(v(o(n)("projets.nouveau.texteBtnCréation")),1)]),_:1},8,["loading"])]),e(te,{modelValue:V.value,"onUpdate:modelValue":s[3]||(s[3]=i=>V.value=i)},{default:a(()=>[w(v(o(n)("projets.nouveau.ouvrirAprèsCréation")),1)]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(ae),e(se,null,{default:a(()=>[e(oe,{visible:N.value.visible,actif:N.value.actif,onRetour:k},null,8,["visible","actif"]),e(ne),e(ue,{visible:g.value.visible,actif:g.value.actif,onSuivant:$},null,8,["visible","actif"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}});export{fe as _};
//# sourceMappingURL=NouveauProjet.vue_vue_type_script_setup_true_lang-CNm-dbRr.js.map

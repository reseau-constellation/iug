import{d as B,c as m,a as u,ag as Ue,w as a,b as e,j as M,ம as F,n as oe,p as ie,r as P,s as A,q as N,v as ge,x as le,V as z,h as t,i as fe,e as pe,f as E,t as b,y as ne,m as W,z as g,A as q,F as D,R as J,aK as Be,aL as ve,M as ue,K as w,X as me,N as L,Q as X,aj as $e,ak as Te,al as Ve,H as se,I as Q,J as Z,an as ke,cu as He,cv as Ke,ah as We,az as we,aq as Re,c8 as qe,cw as Xe,G as te,cx as Qe,ai as ae,c9 as ze,a5 as be,a1 as Ce,a4 as Oe,u as Ze,o as Ye,aB as ea,aC as aa,aG as ta,ca as na,aZ as ia,a_ as sa,a$ as he,b0 as la,by as je,bz as oa,cb as ua,cc as Ie,cd as ra,ce as da,a8 as ca,cg as ma,ch as fa,bA as De,bB as pa,ci as va,a2 as ba,B as Ae,b1 as _a,O as Ee,aF as Na,T as xa,b2 as Me,W as ya}from"./index-C7pHU6pD.js";import{a as Je,t as Ca,V as ga,E as $a,b as Ta,d as Va,e as ka,f as wa,c as ha,g as ja,h as Ia,i as Da,_ as Aa,j as Ea,k as Ma}from"./VBreadcrumbs-BPNWRW4O.js";import{_ as Pa}from"./SélecteurMembre.vue_vue_type_script_setup_true_lang-w7gd7zkr.js";import{_ as Sa}from"./NouvelleBd.vue_vue_type_script_setup_true_lang-BFXpccRc.js";import{c as Ua,a as Ba,b as ye}from"./SélecteurNuée.vue_vue_type_script_setup_true_lang-Bo7djRRa.js";import{_ as Ra}from"./ChoisirStatut.vue_vue_type_script_setup_true_lang-DV5_sClQ.js";import{a as qa}from"./CarteNuée.vue_vue_type_script_setup_true_lang-DSdMAv7y.js";import{u as za}from"./historiqueDocuments-B_UPKPha.js";import{V as Oa,a as Pe}from"./VTabs-C1UqakUv.js";import{V as Se}from"./VSlideGroupItem-C2SvuwUS.js";import"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-B37LvuBL.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-CQtjUZ7D.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-B6UoC_bg.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-DjVBkkTe.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-NuKGUz5h.js";const Ja=B({__name:"ItemMembreAcceptéNuée",props:{idCompte:{}},emits:["effacer"],setup(o,{emit:s}){const i=s;return(r,d)=>(u(),m(Ue,{compte:o.idCompte,"montrer-anonymes":""},{fin:a(()=>[e(M,{icon:"mdi-cancel",size:"small",variant:"flat",onClick:d[0]||(d[0]=()=>i("effacer",o.idCompte))})]),_:1},8,["compte"]))}}),La=B({__name:"ItemMembreExclusNuée",props:{idCompte:{}},emits:["effacer"],setup(o,{emit:s}){const i=s;return(r,d)=>(u(),m(Ue,{compte:o.idCompte,"montrer-anonymes":""},{fin:a(()=>[e(M,{icon:"mdi-cancel",size:"small",variant:"flat",onClick:d[0]||(d[0]=()=>i("effacer",o.idCompte))})]),_:1},8,["compte"]))}}),Fa={class:"mt-2 font-weight-bold"},Ga={class:"text-disabled"},Ha={class:"text-disabled"},Ka={class:"mt-2 font-weight-bold"},Wa={key:0,class:"text-h6 text-disabled text-center"},Xa={class:"text-center"},Qa={class:"text-h5"},Za={class:"text-disabled text-h6"},Ya=B({__name:"CarteAutorisationsNuée",props:{idNuee:{}},setup(o){const s=o,{$மொ:i}=F(),{mdAndUp:r}=oe(),d=ie(),l=P(!1),f=A(d.suivrePermission,{idObjet:N(()=>s.idNuee)}),T=A(d.nuées.suivrePhilosophieAutorisation,{idNuée:N(()=>s.idNuee)}),c=P(T.value);ge(()=>{c.value=T.value});const p=A(d.nuées.suivreAutorisationsMembresDeNuée,{idNuée:N(()=>s.idNuee)}),S=N(()=>p.value?.filter(I=>I.statut==="accepté").map(I=>I.idCompte)),U=N(()=>p.value?.filter(I=>I.statut==="exclus").map(I=>I.idCompte)),V=async I=>{c.value==="CJPI"?await Promise.all(I.map(async h=>await d.nuées.accepterMembreNuée({idNuée:s.idNuee,idCompte:h}))):c.value==="IJPC"&&await Promise.all(I.map(async h=>await d.nuées.exclureMembreDeNuée({idNuée:s.idNuee,idCompte:h})))},k=async I=>{await d.nuées.révoquerExclusionMembreNuée({idNuée:s.idNuee,idCompte:I})},G=async I=>{await d.nuées.révoquerAcceptationMembreNuée({idNuée:s.idNuee,idCompte:I})},re=N(()=>c.value!==T.value),de=()=>{};return(I,h)=>(u(),m(le,{modelValue:l.value,"onUpdate:modelValue":h[7]||(h[7]=y=>l.value=y)},{activator:a(({props:y})=>[se(I.$slots,"activateur",Q(Z({props:y})))]),default:a(()=>[e(z,{class:"mx-auto","min-width":t(r)?500:300},{default:a(()=>[e(fe,null,{default:a(()=>[e(pe,{class:"d-flex align-center"},{default:a(()=>[E(b(t(i)("nuées.autorisations.carte.titre"))+" ",1),e(ne),e(M,{icon:"mdi-close",size:"small",variant:"flat",onClick:h[0]||(h[0]=y=>l.value=!1)})]),_:1})]),_:1}),t(f)?(u(),m(W,{key:0},{default:a(()=>[g("p",Fa,b(t(i)("nuées.autorisations.philosophie")),1),e(J),e(Be,{modelValue:c.value,"onUpdate:modelValue":h[1]||(h[1]=y=>c.value=y)},{default:a(()=>[e(ve,{value:"CJPI",class:"my-2"},{label:a(()=>[g("div",null,[g("p",null,b(t(i)("nuées.nouvelle.parInvitation")),1),g("p",Ga,b(t(i)("nuées.nouvelle.indiceParInvitation")),1)])]),_:1}),e(ve,{value:"IJPC",class:"my-2"},{label:a(()=>[g("div",null,[g("p",null,b(t(i)("nuées.nouvelle.ouverteÀTous")),1),g("p",Ha,b(t(i)("nuées.nouvelle.indiceOuverteÀTous")),1)])]),_:1})]),_:1},8,["modelValue"]),g("p",Ka,b(t(i)(`nuées.autorisations.${c.value==="CJPI"?"membresAutorisés":"membresBloqués"}`)),1),e(J),e(le,null,{activator:a(({props:y})=>[e(ue,w(y,{"prepend-icon":c.value==="CJPI"?"mdi-account-plus-outline":"mdi-account-cancel-outline"}),{default:a(()=>[E(b(t(i)(`nuées.autorisations.${c.value==="CJPI"?"ajouterMembreAccepté":"ajouterMembreExclus"}`)),1)]),_:1},16,["prepend-icon"])]),default:a(()=>[e(z,{class:"mx-auto","max-width":500,"min-width":300},{default:a(()=>[e(W,null,{default:a(()=>[e(Pa,{multiples:"",interdits:c.value==="CJPI"?S.value:U.value,onSelectionnee:h[2]||(h[2]=y=>V(y))},null,8,["interdits"])]),_:1})]),_:1})]),_:1}),(c.value==="CJPI"?!S.value?.length:!U.value?.length)?(u(),q("p",Wa,b(t(i)(`nuées.autorisations.${c.value==="CJPI"?"aucunMembreAccepté":"aucunMembreExclus"}`)),1)):D("",!0),c.value==="CJPI"?(u(),m(me,{key:1},{default:a(()=>[(u(!0),q(X,null,L(S.value,y=>(u(),m(Ja,{key:y,"id-compte":y,onEffacer:h[3]||(h[3]=_=>G(_))},null,8,["id-compte"]))),128))]),_:1})):c.value==="IJPC"?(u(),m(me,{key:2},{default:a(()=>[(u(!0),q(X,null,L(U.value,y=>(u(),m(La,{key:y,"id-compte":y,onEffacer:h[4]||(h[4]=_=>k(_))},null,8,["id-compte"]))),128))]),_:1})):D("",!0)]),_:1})):(u(),m(W,{key:1},{default:a(()=>[g("div",Xa,[g("p",Qa,b(c.value==="CJPI"?t(i)("nuées.autorisations.parInvitation"):t(i)("nuées.autorisations.ouverteÀTous")),1),g("p",Za,b(c.value==="CJPI"?t(i)("nuées.autorisations.indiceParInvitation"):t(i)("nuées.autorisations.indiceOuverteÀTous")),1)])]),_:1})),e($e,null,{default:a(()=>[e(ne),e(Te,{onClick:h[5]||(h[5]=y=>l.value=!1)}),e(Ve,{actif:re.value,onClick:h[6]||(h[6]=()=>de())},null,8,["actif"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),et={class:"text-center"},at={key:0,class:"my-4 text-h6 text-disabled"},tt=B({__name:"CarteBdsDeNuée",props:{idNuee:{}},setup(o){const s=o,{$மொ:i}=F(),{mdAndUp:r}=oe(),d=ie(),l=P(!1),{résultats:f}=ke(d.nuées.suivreBdsCorrespondantes,{idNuée:N(()=>s.idNuee)});return(T,c)=>(u(),m(le,{modelValue:l.value,"onUpdate:modelValue":c[1]||(c[1]=p=>l.value=p)},{activator:a(({props:p})=>[se(T.$slots,"activateur",Q(Z({props:p})))]),default:a(()=>[e(z,{class:"mx-auto","min-width":t(r)?500:300},{default:a(()=>[e(fe,null,{default:a(()=>[e(pe,{class:"d-flex align-center"},{default:a(()=>[E(b(t(i)("nuées.bds.carte.titre"))+" ",1),e(ne),e(M,{icon:"mdi-close",size:"small",variant:"flat",onClick:c[0]||(c[0]=p=>l.value=!1)})]),_:1})]),_:1}),e(W,null,{default:a(()=>[e(me,null,{default:a(()=>[e(Sa,{init:{type:"nuée",id:o.idNuee}},{activateur:a(({props:p})=>[e(ue,w(p,{"prepend-icon":"mdi-database-plus-outline"}),{default:a(()=>[E(b(t(i)("nuées.bds.créer")),1)]),_:1},16)]),_:1},8,["init"]),e(J),(u(!0),q(X,null,L(t(f),p=>(u(),m(He,{id:p,key:p},null,8,["id"]))),128)),g("div",et,[t(f)?.length?D("",!0):(u(),q("p",at,b(t(i)("nuées.bds.aucuneBd")),1))])]),_:1})]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),nt={class:"font-weight-bold"},it={class:"text-medium-emphasis text-caption"},st={class:"font-weight-bold"},lt={class:"text-medium-emphasis text-caption"},ot=B({__name:"CarteCopierNuée",props:{idNuee:{}},setup(o){const s=o,i=Ke(),{mdAndUp:r}=oe(),d=ie(),{$மொ:l}=F(),f=P(!1),T=P(!1),c=P("dépendante"),p=P(!0),S=async()=>{T.value=!0;const U=c.value==="indépendante"?await d.nuées.copierNuée({idNuée:s.idNuee}):await d.nuées.créerNuée({nuéeParent:s.idNuee});T.value=!1,f.value=!1,p.value&&i.push(encodeURI(`/données/nuée/${encodeURIComponent(U)}`))};return(U,V)=>(u(),m(le,{modelValue:f.value,"onUpdate:modelValue":V[5]||(V[5]=k=>f.value=k)},{activator:a(({props:k})=>[se(U.$slots,"activateur",Q(Z({props:k})))]),default:a(()=>[e(z,{class:"mx-auto",width:t(r)?500:300},{default:a(()=>[e(fe,null,{default:a(()=>[e(pe,{class:"d-flex align-center"},{default:a(()=>[E(b(t(l)("nuées.copier.titre"))+" ",1),e(ne),e(M,{icon:"mdi-close",size:"small",variant:"flat",onClick:V[0]||(V[0]=k=>f.value=!1)})]),_:1})]),_:1}),e(W,null,{default:a(()=>[e(Be,{modelValue:c.value,"onUpdate:modelValue":V[1]||(V[1]=k=>c.value=k)},{default:a(()=>[e(ve,{value:"indépendante",class:"my-2"},{label:a(()=>[g("div",null,[g("p",nt,b(t(l)("nuées.copier.indépendante")),1),g("p",it,b(t(l)("nuées.copier.indiceIndépendante")),1)])]),_:1}),e(ve,{value:"dépendante",class:"my-2"},{label:a(()=>[g("div",null,[g("p",st,b(t(l)("nuées.copier.dépendante")),1),g("p",lt,b(t(l)("nuées.copier.indiceDépendante")),1)])]),_:1})]),_:1},8,["modelValue"]),e(We,{modelValue:p.value,"onUpdate:modelValue":V[2]||(V[2]=k=>p.value=k),color:"primary",label:t(l)("nuées.copier.ouvrirCopie")},null,8,["modelValue","label"])]),_:1}),e(J),e($e,null,{default:a(()=>[e(Ve,{actif:"","en-attente":T.value,onClick:V[3]||(V[3]=()=>S())},null,8,["en-attente"]),e(Te,{onClick:V[4]||(V[4]=k=>f.value=!1)})]),_:1})]),_:1},8,["width"])]),_:3},8,["modelValue"]))}}),ut=B({__name:"CarteStatutNuée",props:{idNuee:{}},setup(o){const s=o,{$மொ:i}=F(),{mdAndUp:r}=oe(),d=ie(),l=P(!1),f=A(d.nuées.suivreStatutNuée,{idNuée:N(()=>s.idNuee)}),T=P();ge(()=>{T.value=f.value});const c=N(()=>f.value?.statut!==T.value?.statut||f.value?.idNouvelle!==T.value?.idNouvelle),p=P(!1),S=async()=>{p.value=!0,T.value&&await d.nuées.changerStatutNuée({idNuée:s.idNuee,statut:T.value}),p.value=!1,l.value=!1};return(U,V)=>(u(),m(le,{modelValue:l.value,"onUpdate:modelValue":V[3]||(V[3]=k=>l.value=k)},{activator:a(({props:k})=>[se(U.$slots,"activateur",Q(Z({props:k})))]),default:a(()=>[e(z,{class:"mx-auto","min-width":t(r)?500:300},{default:a(()=>[e(fe,null,{default:a(()=>[e(pe,null,{default:a(()=>[E(b(t(i)("nuées.statut.carte.titre")),1)]),_:1})]),_:1}),e(W,null,{default:a(()=>[e(Ra,{initial:T.value,onChoisir:V[0]||(V[0]=k=>T.value=k)},{sélecteur:a(({choisirNouvelle:k})=>[e(Ua,{multiples:!1,onSelectionnee:G=>k(G[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e($e,null,{default:a(()=>[e(ne),e(Te,{onClick:V[1]||(V[1]=k=>l.value=!1)}),e(Ve,{actif:c.value,"en-attente":p.value,onClick:V[2]||(V[2]=()=>S())},null,8,["actif","en-attente"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),rt=B({__name:"CarteCodeNuée",props:{id:{}},setup(o){const{மொழி:s,மாற்றுமொழிகள்:i}=we(),r=N(()=>[s.value,...i.value]),d=o,l=N(()=>({ts:`import { créerConstellation, type nuées } from "@constl/ipa";

const client = créerConstellation();

const analyser = async (données: nuées.donnéesNuéeExportation) => {
    console.log(données)  // Faire quelque chose de plus intelligent ici :)
}
const fOublierDonnées = await client.nuées.suivreDonnéesExportation({
    idNuée: "${d.id}",
    // Modifier langues selon vos besoins
    langues: [${r.value.map(f=>'"'+f+'"').join(", ")}],
    f: analyser
});
`,py:`from constellationPy import Serveur, ClientSync

with Serveur():
    client = ClientSync()

    données = client.obt_données_nuée(
        id_nuée="${d.id}",
        # Modifier langues selon vos besoins
        langues=[${r.value.map(f=>'"'+f+'"').join(", ")}]
    )

    # Analyser ou sauvegarder les données ici, par exemple...
    données.exporter("fichier.ods")  # ou bien "fichier.xlsx" pour Excel

    # Accéder à un tableau en format pandas
    données_tableau = tableau_exporté_à_pandas(données["Un tableau"])
`,julia:`import Constellation

Constellation.avecServeur() do port
    Constellation.avecClient(port) do client
        donnéesRéseau = Constellation.obtDonnéesTableauNuée(
          client, 
          "${d.id}", 
          // Modifier langues selon vos besoins
          [${r.value.map(f=>'"'+f+'"').join(", ")}]
        )
    end
end`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    f <- function(résultats) {
      print(résultats)

      # Analyser les données ici...
    }

    oublier <- client$obtDonnéesTableauNuée(
      f=f,
      idNuée="${d.id}",
    )
  }
)
`}));return(f,T)=>(u(),m(Je,{codes:l.value,"langage-defaut":"py"},{activateur:a(({props:c})=>[se(f.$slots,"activateur",Q(Z({props:c})))]),_:3},8,["codes"]))}}),dt=B({__name:"ItemAutorisationsNuée",props:{idNuee:{}},setup(o){const{$மொ:s}=F();return(i,r)=>(u(),m(ue,{"prepend-icon":"mdi-account-multiple-check-outline"},{default:a(()=>[e(Re,null,{default:a(()=>[E(b(t(s)("nuées.autorisations.item.titre")),1)]),_:1})]),_:1}))}}),ct=B({__name:"ItemBdsDeNuée",props:{idNuee:{}},setup(o){const s=o,{$மொ:i}=F(),r=ie(),{résultats:d}=ke(r.nuées.suivreBdsCorrespondantes,{idNuée:N(()=>s.idNuee)}),l=N(()=>d.value?.length);return(f,T)=>(u(),m(ue,{"prepend-icon":"mdi-database-check-outline"},{default:a(()=>[e(Re,null,{default:a(()=>[E(b(t(i)("nuées.bds.item.titre",l.value)),1)]),_:1})]),_:1}))}}),mt=B({__name:"CarteCodeTableauNuée",props:{idNuee:{},clefTableau:{}},setup(o){const s=o,{மொழி:i,மாற்றுமொழிகள்:r}=we(),d=N(()=>[i.value,...r.value]),l={ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.nuées.suivreDonnéesExportationTableau({
  idNuée: "${s.idNuee}",
  clefTableau: "${s.clefTableau}",
  langues: [${d.value.map(f=>'"'+f+'"').join(", ")}],  // Modifier langues selon vos besoins
  f: monAnalyse
});
`,py:`from constellationPy import Serveur, ClientSync

with Serveur():
    client = ClientSync()

    données = client.obt_données_tableau_nuée(
      idNuée: "${s.idNuee}",
      clefTableau: "${s.clefTableau}",
      # Modifier langues selon vos besoins
      langues=[${d.value.map(f=>'"'+f+'"').join(", ")}]
    )

    # Analyser ou sauvegarder les données ici...
    données.to_excel("./MesDonnéesExportées.xlsx")
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "nuées.suivreDonnéesExportationTableau", 
        Dict([
          ("idNuée","${s.idNuee}"),
          ("clefTableau","${s.clefTableau}"),
          ("langues", [${d.value.map(f=>'"'+f+'"').join(", ")}])
        ])
    ) do résultat
        print(résultat)
    end
  end
end

`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "tableaux.suivreDonnéesExportation", 
      list(
        idNuée="${s.idNuee}",
        clefTableau="${s.clefTableau}",
        langues=c(${d.value.map(f=>'"'+f+'"').join(", ")})
      )
    )
  }
)

`};return(f,T)=>(u(),m(Je,{codes:l,"langage-defaut":"py"},{activateur:a(({props:c})=>[se(f.$slots,"activateur",Q(Z({props:c})))]),_:3}))}}),ft={class:"text-h6 text-disabled"},pt=["onClick"],vt=B({__name:"TableauNuée",props:{idNuee:{},idTableau:{},clefTableau:{}},setup(o){const{$மொ:s}=F(),i=ie(),r=o,d=A(i.suivrePermission,{idObjet:N(()=>r.idTableau)}),l=A(i.tableaux.suivreVariables,{idTableau:N(()=>r.idTableau)}),f=A(i.nuées.suivreRèglesTableauNuée,{idNuée:N(()=>r.idNuee),clefTableau:N(()=>r.clefTableau)}),{résultats:T}=ke(i.nuées.suivreDonnéesTableauNuée,{idNuée:N(()=>r.idNuee),clefTableau:N(()=>r.clefTableau)}),c=N(()=>T.value?.map(y=>Object.assign({},y.élément.données,{idCompte:y.idCompte}))),p=N(()=>c.value?.toSorted((_,v)=>S.value&&S.value.map(C=>_[C.key]===void 0?v[C.key]===void 0?0:C.order==="asc"?1:-1:v[C.key]===void 0?_[C.key]===void 0?0:C.order==="asc"?-1:1:_[C.key]>v[C.key]?C.order==="asc"?1:-1:_[C.key]<v[C.key]?C.order==="asc"?-1:1:0).find(C=>C!==0)||0)),S=P(),U=A(i.nuées.suivreColonnesTableauNuée,{idNuée:N(()=>r.idNuee),clefTableau:N(()=>r.clefTableau)}),V=A(i.nuées.suivreColonnesEtCatégoriesTableauNuée,{idNuée:N(()=>r.idNuee),clefTableau:N(()=>r.clefTableau)}),k=N(()=>(U.value||[]).map(y=>{const _=V.value?.find(v=>v.id===y.id)?.catégorie;return{key:y.id,sortable:_===void 0||(_?.type==="simple"?Ca(_.catégorie):!1),info:{index:y.index,catégorie:_,variable:y.variable}}})),G=N(()=>[...(U.value||[]).map(y=>({key:y.id})),{key:"idCompte"}]),re=async({idVariable:y,idColonne:_,index:v,règles:C})=>{_=await i.nuées.ajouterColonneTableauNuée({idTableau:r.idTableau,idVariable:y,idColonne:_}),v&&await i.nuées.changerColIndexTableauNuée({idTableau:r.idTableau,idColonne:_,val:!0});for(const R of C)await i.nuées.ajouterRègleTableauNuée({idTableau:r.idTableau,idColonne:_,règle:R})},de=async({idColonne:y,index:_,règles:v})=>{await i.nuées.changerColIndexTableauNuée({idTableau:r.idTableau,idColonne:y,val:_});for(const C of v.nouvelles)await i.nuées.ajouterRègleTableauNuée({idTableau:r.idTableau,idColonne:y,règle:C});for(const C of v.àEffacer)await i.nuées.effacerRègleTableauNuée({idTableau:r.idTableau,idRègle:C})},I=async({idColonne:y})=>{await i.nuées.effacerColonneTableauNuée({idTableau:r.idTableau,idColonne:y})},h=async()=>{await i.nuées.effacerTableauNuée({idNuée:r.idNuee,idTableau:r.idTableau})};return(y,_)=>(u(),m(ga,{headers:G.value,items:p.value},qe({top:a(()=>[e(Va,{flat:"",density:"compact"},{default:a(()=>[e(ne),t(d)?(u(),m(Ba,{key:0,"id-tableau":o.idTableau,"variables-interdites":t(l),onNouvelle:_[0]||(_[0]=v=>re(v))},{activateur:a(({props:v})=>[e(M,w(v,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):D("",!0),e(mt,{"id-nuee":o.idNuee,"clef-tableau":o.clefTableau},{activateur:a(({props:v})=>[e(ae,{text:t(s)("code.indice"),"open-delay":200,location:"bottom"},{activator:a(({props:C})=>[e(M,w({...v,...C},{icon:"mdi-xml"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-nuee","clef-tableau"]),t(d)?(u(),m(ze,{key:1,onEffacer:_[1]||(_[1]=()=>h())},{activateurctivator:a(({props:v})=>[e(M,w(v,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):D("",!0)]),_:1})]),"no-data":a(()=>[g("span",ft,b(t(s)("tableaux.aucuneDonnée")),1)]),"header.idCompte":a(({column:v,isSorted:C,getSortIcon:R,toggleSort:ce})=>[g("span",{onClick:()=>ce(v)},[e(Qe,null,{default:a(({isHovering:Y,props:H})=>[g("span",Q(Z(H)),[E(b(t(s)("nuées.tableau.entêteContributrice"))+" ",1),v.sortable?(u(),q(X,{key:0},[C(v)?(u(),m(te,{key:0,icon:R(v)},null,8,["icon"])):(u(),m(te,{key:1,icon:"mdi-arrow-up",color:Y?"disabled":"rgba(255,255,255,0)"},null,8,["color"]))],64)):D("",!0)],16)]),_:2},1024)],8,pt)]),"item.idCompte":a(({item:v})=>[e(Xe,{compte:v.idCompte},null,8,["compte"])]),_:2},[L(k.value,v=>({name:`header.${v.key}`,fn:a(({column:C,isSorted:R,getSortIcon:ce,toggleSort:Y})=>[e($a,{"id-colonne":v.key,"id-variable":v.info.variable,"id-tableau":o.idTableau,index:!!v.info.index,regles:t(f)?.filter(H=>H.colonne===v.key),"permission-modifier":!!t(d),ordonnable:C.sortable,"est-ordonnee":R(C),"icone-ordonner":ce(C),onBasculerOrdonner:()=>Y(C),onSauvegarder:H=>de({idColonne:v.key,...H}),onEffacer:()=>I({idColonne:v.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),L(k.value,v=>({name:`item.${v.key}`,fn:a(({item:C})=>[e(Ta,{categorie:v.info.catégorie?.catégorie,val:C[v.key],editable:!1},null,8,["categorie","val"])])}))]),1032,["headers","items"]))}}),bt=B({__name:"ItemMétadonnées",props:{id:{},clef:{},val:{},modifiable:{type:Boolean}},emits:["modifiee","effacee"],setup(o,{emit:s}){const i=o,r=s,d=P(),l=P(i.clef),f=()=>{r("modifiee",{clef:l.value,val:d.value})},T=()=>r("effacee");return(c,p)=>(u(),m(ue,null,qe({default:a(()=>[e(Oe,null,{default:a(()=>[e(be,null,{default:a(()=>[E(b(o.clef),1)]),_:1}),e(be,null,{default:a(()=>[e(Ce,{modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=S=>d.value=S),readonly:!o.modifiable,onBlur:f},{default:a(()=>[E(b(o.val),1)]),_:1},8,["modelValue","readonly"])]),_:1})]),_:1})]),_:2},[o.modifiable?{name:"append",fn:a(()=>[e(te,{icon:"mdi-delete",onClick:T})]),key:"0"}:void 0]),1024))}}),_t=B({__name:"CarteMétadonnées",props:{modifiable:{type:Boolean},metadonnees:{}},setup(o){const{$மொ:s}=F(),i=oe(),r=P(!1),d=P(""),l=P(""),f=()=>{d.value="",l.value=""};return(T,c)=>(u(),m(le,{modelValue:r.value,"onUpdate:modelValue":c[2]||(c[2]=p=>r.value=p)},{activator:a(({props:p})=>[se(T.$slots,"activateur",Q(Z({props:p})))]),default:a(()=>[e(z,{"min-width":t(i)?500:300,class:"mx-auto"},{default:a(()=>[e(fe,null,{default:a(()=>[e(pe,null,{default:a(()=>[E(b(t(s)("communs.métadonnées.titreCarte")),1)]),_:1})]),_:1}),e(W,null,{default:a(()=>[e(me,null,{default:a(()=>[o.modifiable?(u(),m(ue,{key:0},{default:a(()=>[e(Oe,null,{default:a(()=>[e(be,{cols:4},{default:a(()=>[e(Ce,{modelValue:d.value,"onUpdate:modelValue":c[0]||(c[0]=p=>d.value=p),label:t(s)("communs.métadonnées.indiceClef"),variant:"outlined","hide-details":"",density:"compact"},null,8,["modelValue","label"])]),_:1}),e(be,{cols:8},{default:a(()=>[e(Ce,{modelValue:l.value,"onUpdate:modelValue":c[1]||(c[1]=p=>l.value=p),label:t(s)("communs.métadonnées.indiceVal"),variant:"outlined","hide-details":"",density:"compact","append-icon":"mdi-content-save-outline","onClick:append":f},null,8,["modelValue","label"])]),_:1})]),_:1}),e(J,{class:"my-2"})]),_:1})):D("",!0),(u(!0),q(X,null,L(Object.entries(o.metadonnees),p=>(u(),m(bt,{id:p[0],key:p[0],clef:p[0],val:p[1],modifiable:o.modifiable},null,8,["id","clef","val","modifiable"]))),128))]),_:1})]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),Nt={class:"text-center"},xt={class:"text-center"},yt={key:0,class:"text-disabled"},Ct={class:"text-center"},gt={class:"mt-6 text-h5"},$t={class:"d-flex flex-wrap"},Tt={class:"mt-6 text-h5"},Vt={key:0,class:"text-disabled"},kt={class:"mt-6 text-h5"},wt={class:"d-flex flex-wrap"},ht={class:"mt-6 text-h5"},jt={key:2,class:"text-center"},It={class:"text-h5 mt-5"},Gt=B({__name:"PageNuée",props:{id:{}},setup(o){const s=o,i=ie(),{mdAndUp:r}=oe(),{isRtl:d}=Ze(),{$மொ:l}=F(),f=za(),{obtImageDéco:T}=aa();Ye(()=>{f.documentOuvert({id:s.id,à:Date.now()})});const c=N(()=>[{title:l("navigation.données"),href:encodeURI("/données/")},{title:U.value||l("nuées.sansNom"),disabled:!0}]),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:p}=we(),S=A(i.nuées.suivreNomsNuée,{idNuée:N(()=>s.id)}),U=p(S),V=async j=>{const{àEffacer:$,àAjouter:n}=Me({anciennes:S.value,nouvelles:j});for(const x of $)await i.nuées.effacerNomNuée({idNuée:s.id,langue:x});await i.nuées.sauvegarderNomsNuée({idNuée:s.id,noms:n})},k=A(i.nuées.suivreDescriptionsNuée,{idNuée:N(()=>s.id)}),G=p(k),re=async j=>{const{àEffacer:$,àAjouter:n}=Me({anciennes:k.value,nouvelles:j});for(const x of $)await i.nuées.effacerDescriptionNuée({idNuée:s.id,langue:x});await i.nuées.sauvegarderDescriptionsNuée({idNuée:s.id,descriptions:n})},de=ea(A(i.nuées.suivreImage,{idNuée:N(()=>s.id)})),I=T("logoBD"),h=async j=>{j?await i.nuées.sauvegarderImage({idNuée:s.id,image:{contenu:new Uint8Array(j.contenu),nomFichier:j.fichier}}):await i.nuées.effacerImage({idNuée:s.id})},y=T("vide"),_=A(i.suivrePermission,{idObjet:N(()=>s.id)}),v=A(i.réseau.suivreAuteursNuée,{idNuée:N(()=>s.id)}),C=A(i.nuées.suivreVariablesNuée,{idNuée:N(()=>s.id)}),R=A(i.nuées.suivreMotsClefsNuée,{idNuée:N(()=>s.id)}),ce=async j=>{const $=j.filter(x=>!R.value?.includes(x)),n=R.value?.filter(x=>!j.includes(x))||[];await i.nuées.ajouterMotsClefsNuée({idNuée:s.id,idsMotsClefs:$}),await Promise.all(n.map(x=>i.nuées.effacerMotClefNuée({idNuée:s.id,idMotClef:x})))},Y=A(i.nuées.suivreStatutNuée,{idNuée:N(()=>s.id)}),H=A(i.nuées.suivreMétadonnéesNuée,{idNuée:N(()=>s.id)}),Le=async({clef:j,val:$})=>{await i.nuées.sauvegarderMétadonnéeNuée({idNuée:s.id,clef:j,métadonnée:$})},ee=A(i.nuées.suivreTableauxNuée,{idNuée:N(()=>s.id)}),_e=N(()=>{if(ee.value)return[...ee.value].sort((j,$)=>j.id>$.id?-1:1)}),O=P();ge(()=>{!O.value&&_e.value?.length&&(O.value=_e.value[0].clef),O.value&&!_e.value?.map(j=>j.clef).includes(O.value)&&(O.value=void 0)});const K=P(!1),Ne=async({noms:j,cols:$})=>{K.value=!0;try{const n=await i.bds.ajouterTableauBd({idBd:s.id});await i.nuées.sauvegarderNomsTableauNuée({idTableau:n,noms:j}),await Promise.all($.map(async x=>{await i.nuées.ajouterColonneTableauNuée({idTableau:n,idColonne:x.info.id,idVariable:x.info.variable}),x.info.index&&await i.nuées.changerColIndexTableauNuée({idTableau:n,idColonne:x.info.id,val:!0}),await Promise.all(x.règles.map(async xe=>await i.nuées.ajouterRègleTableauNuée({idTableau:n,idColonne:x.info.id,règle:xe})))}))}finally{K.value=!1}},Fe=async j=>{await i.nuées.effacerTableauNuée({idNuée:s.id,idTableau:j})},Ge=async()=>{await i.nuées.effacerNuée({idNuée:s.id})};return(j,$)=>(u(),m(ta,null,{default:a(()=>[g("div",null,[t(r)?(u(),m(ka,{key:0,items:c.value,class:"pa-0"},{divider:a(()=>[e(te,null,{default:a(()=>[E(b(t(d)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:a(({item:n})=>[e(wa,{disabled:n.disabled,onClick:x=>n.href&&j.$router.push(n.href)},{default:a(()=>[e(na,{texte:n.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(u(),m(M,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:$[0]||($[0]=()=>j.$router.push(encodeURI("/données/")))}))]),e(sa,{"src-image":t(de),"img-defaut":t(I),editable:!!t(_),"taille-avatar":t(r)?275:175,"max-taille-image":t(ia),onImageChangee:$[1]||($[1]=n=>h(n))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),g("div",Nt,[e(he,{"etiquette-nom":t(l)("objet.étiquetteNom"),"indice-nom":t(l)("objet.indiceNom"),"indice-langue":t(l)("objet.indiceLangue"),"texte-aucun-nom":t(l)("objet.texteAucunNom"),"noms-initiaux":t(S),titre:t(l)("objet.titreDialogueNoms"),"sous-titre":t(l)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!t(_),onAjusterNoms:V},{activateur:a(({props:n})=>[g("span",w(n,{class:"text-h4"}),[E(b(t(U)||t(l)("nuées.sansNom"))+" ",1),e(M,{icon:t(_)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(la,{id:o.id},null,8,["id"]),e(ne)]),g("div",xt,[e(Ie,{"n-max":5,items:t(R)},{jeton:a(({id:n})=>[e(je,{id:n},{activateur:a(({props:x})=>[e(ua,w(x,{id:n,class:"me-1 mb-1"}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:a(({id:n})=>[e(je,{id:n},{activateur:a(({props:x})=>[e(oa,w(x,{id:n}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),t(R)&&!t(R).length?(u(),q("span",yt,b(t(l)("nuées.aucunMotClef")),1)):D("",!0),t(_)&&t(R)?(u(),m(ra,{key:1,originaux:t(R),onSauvegarder:$[2]||($[2]=n=>ce(n))},null,8,["originaux"])):D("",!0)]),g("div",Ct,[e(qa,{"id-nuee":o.id},{activateur:a(({props:n})=>[e(ae,{"open-delay":"200",location:"bottom",text:t(l)("épingler.épingler")},{activator:a(({props:x})=>[e(M,w({...n,...x},{icon:"",variant:"flat"}),{default:a(()=>[e(da,{id:o.id},null,8,["id"])]),_:1},16)]),_:2},1032,["text"])]),_:1},8,["id-nuee"]),e(ha,{"id-objet":o.id,"noms-objet":t(S),"type-objet":"nuée"},{activateur:a(({props:n})=>[e(ae,{text:t(l)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:a(({props:x})=>[e(M,w({...n,...x},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),e(rt,{id:o.id},{activateur:a(({props:n})=>[e(ae,{text:t(l)("code.indice"),"open-delay":200,location:"bottom"},{activator:a(({props:x})=>[e(M,w({...n,...x},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),e(ot,{"id-nuee":o.id},{activateur:a(({props:n})=>[e(ae,{"open-delay":"200",location:"bottom",text:t(l)("nuées.copier.indice")},{activator:a(({props:x})=>[e(M,w({...n,...x},{icon:"mdi-content-copy",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-nuee"]),t(H)?(u(),m(_t,{key:0,metadonnees:t(H),modifiable:!!t(_),onSauvegarde:$[3]||($[3]=n=>Le(n))},{activateur:a(({props:n})=>[e(ae,{"open-delay":"200",location:"bottom",text:t(l)("nuées.métadonnéees.indice")},{activator:a(({props:x})=>[e(M,w({...n,...x},{icon:"mdi-bracket",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["metadonnees","modifiable"])):D("",!0),t(_)?(u(),m(ze,{key:1,onEffacer:$[4]||($[4]=()=>Ge())},{activateur:a(({props:n})=>[e(ae,{"open-delay":"200",location:"bottom",text:t(l)("effacer.indice")},{activator:a(({props:x})=>[e(M,w({...n,...x},{variant:"flat",icon:""}),{default:a(()=>[e(te,{color:"error"},{default:a(()=>[...$[9]||($[9]=[E("mdi-delete",-1)])]),_:1})]),_:1},16)]),_:2},1032,["text"])]),_:1})):D("",!0)]),e(J),e(W,null,{default:a(()=>[e(he,{"etiquette-nom":t(l)("objet.étiquetteDescription"),"indice-nom":t(l)("objet.indiceDescription"),"indice-langue":t(l)("objet.indiceLangue"),"texte-aucun-nom":t(l)("objet.texteAucuneDescription"),"noms-initiaux":t(k),titre:t(l)("objet.titreDialogueDescriptions"),"sous-titre":t(l)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!t(_),longue:"",onAjusterNoms:re},{activateur:a(({props:n})=>[g("span",{class:ca({"text-disabled":!t(G)})},b(t(G)||t(l)("communs.baseCarteObjet.sansDescription")),3),e(M,w(n,{icon:t(_)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),g("p",gt,b(t(l)("nuées.info")),1),e(J,{class:"mb-2"}),g("div",$t,[t(Y)&&(t(Y).statut!=="active"||t(_))?(u(),m(z,{key:0,flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(ut,{"id-nuee":o.id},{activateur:a(({props:n})=>[e(ja,w(n,{"type-objet":"nuée",statut:t(Y)}),null,16,["statut"])]),_:1},8,["id-nuee"])]),_:1})):D("",!0),e(z,{flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(ma,{id:o.id,auteurs:t(v),"permission-moderateur":t(_)==="MODÉRATEUR"},{activateur:a(({props:n})=>[e(Ia,w(n,{auteurs:t(v)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(fa,{id:o.id},{activateur:a(({props:n})=>[e(Da,w(n,{id:o.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(Aa,{"id-objet":o.id,permission:t(_),"type-objet":"bd"},{activateur:a(({props:n})=>[e(Ea,w(n,{"id-objet":o.id}),null,16,["id-objet"])]),_:1},8,["id-objet","permission"])]),_:1})]),g("p",Tt,b(t(l)("nuées.variables")),1),e(J,{class:"mb-2"}),e(Ie,{"n-max":5,items:t(C)},{jeton:a(({id:n})=>[e(De,{id:n},{activateur:a(({props:x})=>[e(va,w(x,{id:n,class:"me-1 mb-1"}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:a(({id:n})=>[e(De,{id:n},{activateur:a(({props:x})=>[e(pa,w(x,{id:n}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),t(C)?.length?D("",!0):(u(),q("p",Vt,b(t(l)("nuées.aucuneVariable")),1)),g("p",kt,b(t(l)("nuées.gestion")),1),e(J,{class:"mb-2"}),g("div",wt,[e(z,{flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(Ya,{"id-nuee":o.id},{activateur:a(({props:n})=>[e(dt,w(n,{"id-nuee":o.id}),null,16,["id-nuee"])]),_:1},8,["id-nuee"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:a(()=>[e(tt,{"id-nuee":o.id},{activateur:a(({props:n})=>[e(ct,w(n,{"id-nuee":o.id}),null,16,["id-nuee"])]),_:1},8,["id-nuee"])]),_:1})]),e(me,null,{default:a(()=>[g("p",ht,b(t(l)("nuées.tableaux")),1),e(J),t(r)?(u(),m(Oa,{key:0,modelValue:O.value,"onUpdate:modelValue":$[6]||($[6]=n=>O.value=n),class:"mt-2"},{default:a(()=>[(u(!0),q(X,null,L(t(ee),n=>(u(),m(Pe,{key:n.clef,value:n.clef,color:"primary",size:"small"},{default:a(()=>[e(Ma,{id:n.id,clef:n.clef,onEffacer:()=>Fe(n.id)},null,8,["id","clef","onEffacer"])]),_:2},1032,["value"]))),128)),e(ye,{onSauvegarder:Ne},{activateur:a(({props:n})=>[t(_)?(u(),m(Pe,w({key:0},n,{"append-icon":K.value?void 0:"mdi-plus",disabled:K.value,variant:"tonal",class:"mx-1",label:"",onClick:$[5]||($[5]=ba(()=>{},["stop"]))}),{default:a(()=>[E(b(t(l)("tableaux.nouveau"))+" ",1),K.value?(u(),m(Ae,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):D("",!0)]),_:1},16,["append-icon","disabled"])):D("",!0)]),_:1})]),_:1},8,["modelValue"])):(u(),m(_a,{key:1,modelValue:O.value,"onUpdate:modelValue":$[7]||($[7]=n=>O.value=n),class:"mt-4","show-arrows":"","center-active":""},{default:a(()=>[(u(!0),q(X,null,L(t(ee),n=>(u(),m(Se,{key:n.clef,value:n.clef},{default:a(({isSelected:x,toggle:xe})=>[e(Ee,{class:"mx-1",variant:"tonal",label:"",active:!1,color:x?"primary":"",onClick:xe},{default:a(()=>[E(b(n.clef.slice(0,10))+" ",1),e(te,{class:"ms-2",icon:"mdi-pencil",variant:"flat",size:"x-small"})]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(Se,{key:"nouveau",value:"nouveau"},{default:a(()=>[e(ye,{onSauvegarder:Ne},{activateur:a(({props:n})=>[t(_)?(u(),m(Ee,w({key:0},n,{"append-icon":K.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:K.value}),{default:a(()=>[E(b(t(l)("tableaux.nouveau"))+" ",1),K.value?(u(),m(Ae,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):D("",!0)]),_:1},16,["append-icon","disabled"])):D("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),t(ee)&&!t(ee).length?(u(),q("div",jt,[g("p",It,b(t(l)("tableaux.aucun")),1),e(Na,{src:t(y),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e(ye,{onSauvegarder:Ne},{activateur:a(({props:n})=>[t(_)?(u(),m(M,w({key:0},n,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:a(()=>[e(te,{icon:"mdi-table",start:""})]),default:a(()=>[E(" "+b(t(l)("tableaux.nouveau")),1)]),_:1},16)):D("",!0)]),_:1})])):D("",!0)]),_:1}),e(xa,{modelValue:O.value,"onUpdate:modelValue":$[8]||($[8]=n=>O.value=n)},{default:a(()=>[(u(!0),q(X,null,L(t(ee),n=>(u(),m(ya,{key:n.clef,value:n.clef},{default:a(()=>[e(vt,{"id-tableau":n.id,"clef-tableau":n.clef,"id-nuee":o.id},null,8,["id-tableau","clef-tableau","id-nuee"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{Gt as default};
//# sourceMappingURL=PageNuée-n1I7mUAU.js.map

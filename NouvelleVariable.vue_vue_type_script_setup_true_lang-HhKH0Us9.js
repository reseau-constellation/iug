import{d as M,p as Q,ம as X,n as G,r as o,q as d,c as N,a as g,x as Y,w as l,b as a,V as Z,h as i,i as ee,e as ae,z as O,t as m,ap as te,f as w,m as le,T as ie,W as f,ac as se,aX as ne,eI as re,M as q,K as U,eJ as ue,ah as oe,eq as $,a1 as ce,A,F as ve,cI as de,aq as me,Q as fe,N as be,j as pe,aj as ge,bt as _e,y as Ve,bu as xe,H as Ce,I as we,J as ye,cJ as Ne,ad as je,eF as ke}from"./index-Dm5yWyzV.js";const Te={key:0,class:"my-2 text-center text-disabled"},De={class:"text-center"},Ue=M({__name:"NouvelleVariable",emits:["nouvelle"],setup(Oe,{emit:I}){const B=I,b=Q(),{$மொ:s}=X(),{mdAndUp:S}=G(),y=o(!1),r=o(0),u=["catégorie","noms","descriptions","unités","règles","confirmation"],h=d(()=>{switch(u[r.value]){case"catégorie":return"variables.nouvelle.titreCatégorie";case"noms":return"variables.nouvelle.titreNoms";case"descriptions":return"variables.nouvelle.titreDescriptions";case"unités":return"variables.nouvelle.titreUnités";case"règles":return"variables.nouvelle.titreRègles";case"confirmation":return"variables.nouvelle.titreConfirmation";default:return""}}),L=d(()=>{switch(u[r.value]){case"catégorie":return"variables.nouvelle.sousTitreCatégorie";case"noms":return"variables.nouvelle.sousTitreNoms";case"descriptions":return"variables.nouvelle.sousTitreDescriptions";case"unités":return"variables.nouvelle.sousTitreUnités";case"règles":return"variables.nouvelle.sousTitreRègles";case"confirmation":return"variables.nouvelle.sousTitreConfirmation";default:return""}}),R=()=>{switch(u[r.value]){case"règles":r.value=u.indexOf(D.value?"unités":"descriptions");break;default:r.value--;break}},E=()=>{switch(u[r.value]){case"descriptions":r.value=u.indexOf(D.value?"unités":"règles");break;default:r.value++;break}},j=d(()=>{switch(u[r.value]){case"catégorie":return{actif:!!c.value,visible:!0};case"noms":return{actif:!!Object.keys(p.value).length,visible:!0};case"confirmation":return{actif:!1,visible:!1};default:return{actif:!0,visible:!0}}}),k=d(()=>{switch(u[r.value]){case"catégorie":return{actif:!1,visible:!1};case"confirmation":return{actif:!C.value,visible:!0};default:return{actif:!0,visible:!0}}}),_=o(!1),c=o(),T=d(()=>{if(c.value)return{type:_.value?"liste":"simple",catégorie:c.value}}),p=o({}),F=t=>{p.value=t},V=o({}),P=t=>{V.value=t},x=o(),D=d(()=>c.value==="numérique"),v=o([]),J=t=>{v.value=[...v.value,{règle:t,id:Ne()}]},W=t=>{v.value=v.value.filter(n=>n.id!==t)},C=o(!1),z=async()=>{if(C.value=!0,!T.value)return;const t=await b.variables.créerVariable({catégorie:T.value}),n=[b.variables.sauvegarderNomsVariable({idVariable:t,noms:Object.fromEntries(Object.entries(p.value))}),b.variables.sauvegarderDescriptionsVariable({idVariable:t,descriptions:Object.fromEntries(Object.entries(V.value))}),...v.value.map(e=>b.variables.ajouterRègleVariable({idVariable:t,règle:e.règle}))];x.value&&n.push(b.variables.sauvegarderUnitésVariable({idVariable:t,idUnité:x.value})),B("nouvelle",t),H()},H=()=>{c.value=void 0,_.value=!1,p.value={},V.value={},r.value=0,C.value=!1,y.value=!1};return(t,n)=>(g(),N(Y,{modelValue:y.value,"onUpdate:modelValue":n[6]||(n[6]=e=>y.value=e)},{activator:l(({props:e})=>[Ce(t.$slots,"activateur",we(ye({props:e})))]),default:l(()=>[a(Z,{class:"mx-auto","min-width":i(S)?500:300},{default:l(()=>[a(ee,null,{default:l(()=>[a(ae,{class:"text-h5 justify-space-between"},{default:l(()=>[O("span",null,m(i(s)(h.value)),1)]),_:1}),a(te,null,{default:l(()=>[w(m(i(s)(L.value)),1)]),_:1})]),_:1}),a(le,null,{default:l(()=>[a(ie,{modelValue:r.value,"onUpdate:modelValue":n[5]||(n[5]=e=>r.value=e),style:{"overflow-y":"scroll"}},{default:l(()=>[a(f,{value:0},{default:l(()=>[a(ne,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),class:"mt-2",items:i(re),label:i(s)("variables.nouvelle.catégorie"),variant:"outlined"},{item:l(({item:e,props:K})=>[a(q,U(K,{title:i(s)(`variables.catégories.${e.raw}`),subtitle:i(s)(`variables.indicesCatégories.${e.raw}`),"prepend-icon":i(ue)({type:"simple",catégorie:e.raw})||"mdi-variable"}),null,16,["title","subtitle","prepend-icon"])]),selection:l(({item:e})=>[w(m(i(s)(`variables.catégories.${e.raw}`)),1)]),_:1},8,["modelValue","items","label"]),se(a(oe,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=e=>_.value=e),label:i(s)("variables.nouvelle.typeListe"),color:"primary","append-icon":"mdi-format-list-bulleted"},null,8,["modelValue","label"]),[[je,!1]])]),_:1}),a(f,{value:1},{default:l(()=>[a($,{"texte-aucun-nom":i(s)("communs.texteAucunNom"),"indice-langue":i(s)("communs.indiceLangue"),"etiquette-nom":i(s)("communs.étiquetteNom"),"indice-nom":i(s)("variables.nouvelle.texteIndiceNom"),"noms-initiaux":p.value,"autorisation-modification":!0,onAjusterNoms:F},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1}),a(f,{value:u.indexOf("descriptions")},{default:l(()=>[a($,{"texte-aucun-nom":i(s)("variables.nouvelle.texteAucuneDescription"),"indice-langue":i(s)("communs.indiceLangue"),"etiquette-nom":i(s)("variables.nouvelle.texteÉtiquetteDescription"),"indice-nom":i(s)("variables.nouvelle.texteIndiceDescription"),"noms-initiaux":V.value,"autorisation-modification":!0,longue:"",onAjusterNoms:P},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1},8,["value"]),a(f,{value:u.indexOf("unités")},{default:l(()=>[a(ce,{modelValue:x.value,"onUpdate:modelValue":n[2]||(n[2]=e=>x.value=e),variant:"outlined"},null,8,["modelValue"])]),_:1},8,["value"]),a(f,{value:u.indexOf("règles")},{default:l(()=>[a(de,{source:{type:"variable"},"categorie-variable":c.value,onSauvegarder:n[3]||(n[3]=e=>J(e))},{activateur:l(({props:e})=>[a(q,U(e,{"prepend-icon":"mdi-plus"}),{default:l(()=>[a(me,null,{default:l(()=>[w(m(i(s)("variables.règles.nouvelle")),1)]),_:1})]),_:2},1040)]),_:1},8,["categorie-variable"]),(g(!0),A(fe,null,be(v.value,e=>(g(),N(ke,{key:e.id,regle:e,effacable:"","autorisation-modifier":"",onEffacer:()=>W(e.id)},null,8,["regle","onEffacer"]))),128)),v.value.length?ve("",!0):(g(),A("p",Te,m(i(s)("variables.règles.aucune")),1))]),_:1},8,["value"]),(g(),N(f,{key:u.indexOf("confirmation")},{default:l(()=>[O("div",De,[a(pe,{class:"mt-3",variant:"outlined",loading:C.value,onClick:n[4]||(n[4]=()=>z())},{default:l(()=>[w(m(i(s)("variables.nouvelle.texteBtnCréation")),1)]),_:1},8,["loading"])])]),_:1}))]),_:1},8,["modelValue"])]),_:1}),a(ge,null,{default:l(()=>[a(_e,{visible:k.value.visible,actif:k.value.actif,onRetour:R},null,8,["visible","actif"]),a(Ve),a(xe,{visible:j.value.visible,actif:j.value.actif,onSuivant:E},null,8,["visible","actif"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}});export{Ue as _};
//# sourceMappingURL=NouvelleVariable.vue_vue_type_script_setup_true_lang-HhKH0Us9.js.map

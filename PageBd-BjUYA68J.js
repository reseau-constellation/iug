import{d as Y,q as L,c as p,a as u,w as t,H as De,I as ge,J as xe,n as Ae,க as ve,p as pe,r as A,s as C,x as Be,h as a,b as e,V as z,i as Ce,e as ke,f as h,t as V,y as G,j as B,m as fe,X as Me,M as Z,Z as ue,B as J,bB as te,R as ce,bC as qe,F as $,G as Q,v as Ee,bD as Xe,ao as he,bE as ze,as as Fe,bF as Ze,bG as Je,aO as Ye,bH as ea,N as me,am as Se,K as x,z as N,S as aa,an as le,bI as Ge,u as ta,ம as ia,o as la,aC as na,bJ as oa,aG as sa,bK as da,aY as ra,aZ as ua,a_ as Ie,a$ as ca,A as ie,bt as Ne,bu as ma,bL as fa,bM as Le,bN as va,bO as pa,bP as ba,a8 as _a,bQ as ya,bR as ga,bv as Pe,bw as xa,bS as Ba,Q as we,O as je,a2 as Ca,b0 as ka,aF as Va,T as Ta,b1 as Oe,W as wa}from"./index-DDb1PrSJ.js";import{u as ja}from"./historiqueDocuments-CjEp01rB.js";import{_ as $a,t as ha,V as Da,E as Aa,a as Ea,b as Qe,c as He,d as Sa,e as Ia,f as Na,g as La,h as Pa,i as Oa,j as Ra,k as Re}from"./VBreadcrumbs-m2aOMzTC.js";import{_ as Ua}from"./ChoisirStatut.vue_vue_type_script_setup_true_lang-DAEzRnDA.js";import{a as Ma,b as $e}from"./SélecteurNuée.vue_vue_type_script_setup_true_lang-JRdRQf3m.js";import{V as qa}from"./VSwitch-DEZVHQ7U.js";import{V as za,a as Fa}from"./VTabs-CuzQLEIU.js";import{V as Ue}from"./VSlideGroupItem-BJ6QQBIx.js";import"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-B1eOKfPQ.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-BCGVC2PO.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-DQvw3Ey8.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-DJIRyEo6.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-B-sCm-lK.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-DTr5LNJ_.js";const Ga=Y({__name:"CarteCodeBd",props:{id:{}},setup(S){const d=S,o=L(()=>({ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.bds.suivreDonnéesExportation({
  idBd: "${d.id}",
  f: monAnalyse
})
`,py:`from constellationPy import Serveur, ClientSync
    
with Serveur():
    client = ClientSync()

    données = client.bds.suivreDonnéesExportation(
      idBd="${d.id}"
    )
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "bds.suivreDonnéesExportation", 
        Dict([("idBd","${d.id}")])
    ) do résultat
        print(résultat)
    end
  end
end
`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "bds.suivreDonnéesExportation", 
      list(idBd="${d.id}")
    )
  }
)
`}));return(v,_)=>(u(),p($a,{codes:o.value},{activator:t(({props:g})=>[De(v.$slots,"activator",ge(xe({props:g})))]),_:3},8,["codes"]))}}),Qa=Y({__name:"CarteQualitéBd",props:{idBd:{}},setup(S){const{mdAndUp:d}=Ae(),{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),_=S,g=pe(),s=A(!1),y=C(g.bds.suivreQualitéBd,{idBd:_.idBd}),E=C(g.bds.suivreLicenceBd,{idBd:_.idBd}),H=C(g.bds.suivreLicenceContenuBd,{idBd:_.idBd}),P=C(g.suivrePermission,{idObjet:_.idBd});return(w,T)=>(u(),p(Be,{modelValue:s.value,"onUpdate:modelValue":T[1]||(T[1]=D=>s.value=D),"max-width":a(d)?500:300},{activator:t(({props:D})=>[De(w.$slots,"activator",ge(xe({props:D})))]),default:t(()=>[e(z,null,{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,{class:"d-flex"},{default:t(()=>[h(V(a(v)("bds.qualité.titre"))+" ",1),e(G),e(B,{icon:"mdi-close",size:"small",variant:"flat",onClick:T[0]||(T[0]=D=>s.value=!1)})]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Me,null,{default:t(()=>[e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(y)?.total||0)*100,width:5,indeterminate:a(y)?.total===void 0,color:a(te)(a(y)?.total).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[2]||(T[2]=[h("Score total")])),_:1}),e(ce),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(y)?.accès||0)*100,width:5,indeterminate:a(y)?.accès===void 0,color:a(te)(a(y)?.accès).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[3]||(T[3]=[h("Accessibilité")])),_:1}),e(qe,{licence:a(E),"licence-contenu":a(H),"permission-modifier":!!a(P)},{activator:t(({props:D})=>[e(Z,ge(xe(D)),{prepend:t(()=>[e(ue,null,{default:t(()=>[a(y)?.licence===void 0?(u(),p(J,{key:0,width:5,indeterminate:"",color:a(te)(a(y)?.licence).couleur},null,8,["color"])):$("",!0),e(Q,{icon:a(y)?.licence?"mdi-check":"mdi-alert-circle-outline",color:a(te)(a(y)?.licence).couleur},null,8,["icon","color"])]),_:1})]),title:t(()=>[h(V(a(y)?.licence===void 0?a(v)("bds.qualité.rechercheLicence"):a(y).licence?a(v)("bds.qualité.licenceOuverte"):a(v)("bds.qualité.licenceNonReconnue")),1)]),_:2},1040)]),_:1},8,["licence","licence-contenu","permission-modifier"]),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(y)?.valide||0)*100,width:5,indeterminate:a(y)?.valide===void 0,color:a(te)(a(y)?.valide).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[4]||(T[4]=[h("Validation données")])),_:1}),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(y)?.couverture||0)*100,width:5,indeterminate:a(y)?.couverture===void 0,color:a(te)(a(y)?.couverture).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>T[5]||(T[5]=[h("Couverture tests")])),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue","max-width"]))}}),Ha=Y({__name:"CarteStatutBd",props:{idBd:{}},setup(S){const d=S,{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),{mdAndUp:_}=Ae(),g=pe(),s=A(!1),y=C(g.bds.suivreStatutBd,{idBd:d.idBd}),E=A();Ee(()=>{E.value=y.value});const H=L(()=>y.value?.statut!==E.value?.statut||y.value?.idNouvelle!==E.value?.idNouvelle),P=A(!1),w=async()=>{P.value=!0,E.value&&await g.bds.changerStatutBd({idBd:d.idBd,statut:ze(E.value)}),P.value=!1,s.value=!1};return(T,D)=>(u(),p(Be,{modelValue:s.value,"onUpdate:modelValue":D[2]||(D[2]=I=>s.value=I)},{activator:t(({props:I})=>[De(T.$slots,"activator",ge(xe({props:I})))]),default:t(()=>[e(z,{class:"mx-auto","min-width":a(_)?500:300},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[h(V(a(v)("données.statut.carte.titre")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Ua,{initial:E.value,onChoisir:D[0]||(D[0]=I=>E.value=I)},{sélecteur:t(({choisirNouvelle:I})=>[e(Xe,{multiples:!1,onSelectionnee:F=>I(F[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(B,{disabled:!H.value,loading:P.value,variant:"flat",color:"primary",onClick:w},{default:t(()=>[h(V(a(v)("communs.sauvegarder")),1)]),_:1},8,["disabled","loading"]),e(B,{variant:"flat","append-icon":"mdi-close",onClick:D[1]||(D[1]=I=>s.value=!1)},{default:t(()=>[h(V(a(v)("communs.fermer")),1)]),_:1})]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),Wa=Y({__name:"ItemQualitéBd",props:{id:{}},setup(S){return(d,o)=>(u(),p(Z,null,{prepend:t(()=>[e(Je,{id:d.id},null,8,["id"])]),default:t(()=>[e(Fe,null,{default:t(()=>[e(Ze,{id:d.id},null,8,["id"])]),_:1})]),_:1}))}}),Ka=Y({__name:"ItemLicence",props:{licence:{}},setup(S){const d=pe(),{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),_=S,g=C(d.licences.suivreLicences),s=L(()=>_.licence&&g.value&&Object.keys(g.value).includes(_.licence));return(y,E)=>(u(),p(Z,null,{prepend:t(()=>[e(Q,{start:"",color:s.value?"primary":"error"},{default:t(()=>[h(V(s.value?"mdi-scale-balance":"mdi-alert"),1)]),_:1},8,["color"])]),default:t(()=>[e(Fe,null,{default:t(()=>[h(V(s.value?a(v)(`licences.info.${y.licence}.abr`):y.licence),1)]),_:1})]),_:1}))}}),Xa={class:"my-4 text-h6 text-disabled"},Za=Y({__name:"TableauBd",props:{idTableau:{},idBd:{}},setup(S){const{மொழியாக்கம்_பயன்படுத்து:d}=ve(),{$மொ:o}=d(),v=pe(),_=S,g=C(v.suivrePermission,{idObjet:_.idTableau}),s=C(v.tableaux.suivreNomsTableau,{idTableau:_.idTableau}),y=C(v.tableaux.suivreVariables,{idTableau:_.idTableau}),E=C(v.tableaux.suivreColonnesTableau,{idTableau:L(()=>_.idTableau)}),H=C(v.tableaux.suivreColonnesEtCatégoriesTableau,{idTableau:L(()=>_.idTableau)}),P=L(()=>(E.value||[]).map(r=>{const n=H.value?.find(l=>l.id===r.id)?.catégorie;return{key:r.id,sortable:n===void 0||(n?.type==="simple"?ha(n.catégorie):!1),info:{index:r.index,catégorie:n,variable:r.variable}}})),w=L(()=>{const r={key:"actions",sortable:!1,info:{}};return[...P.value,r]}),T=async({idVariable:r,idColonne:n,index:l,règles:f})=>{n=await v.tableaux.ajouterColonneTableau({idTableau:_.idTableau,idVariable:r,idColonne:n}),l&&await v.tableaux.changerColIndex({idTableau:_.idTableau,idColonne:n,val:!0});for(const k of f)await v.tableaux.ajouterRègleTableau({idTableau:_.idTableau,idColonne:n,règle:k})},D=async({idColonne:r,index:n,règles:l})=>{await v.tableaux.changerColIndex({idTableau:_.idTableau,idColonne:r,val:n});for(const f of l.nouvelles)await v.tableaux.ajouterRègleTableau({idTableau:_.idTableau,idColonne:r,règle:f});for(const f of l.àEffacer)await v.tableaux.effacerRègleTableau({idTableau:_.idTableau,idRègle:f})},I=async({idColonne:r})=>{await v.tableaux.effacerColonneTableau({idTableau:_.idTableau,idColonne:r})},F=C(v.tableaux.suivreDonnées,{idTableau:_.idTableau}),be=L(()=>{const r=F.value?.toSorted((l,f)=>ne.value&&ne.value.map(k=>l.données[k.key]===void 0?f.données[k.key]===void 0?0:k.order==="asc"?1:-1:f.données[k.key]===void 0?l.données[k.key]===void 0?0:k.order==="asc"?-1:1:l.données[k.key]>f.données[k.key]?k.order==="asc"?1:-1:l.données[k.key]<f.données[k.key]?k.order==="asc"?-1:1:0).find(k=>k!==0)||0),n={id:"-1",données:{}};return W.value&&r?[n,...r]:r}),ne=A(),R=A([]),Ve=C(v.tableaux.suivreRègles,{idTableau:_.idTableau}),W=A(!1),ee=A(!1),K=A(),U=L(()=>{const r=[];for(const[n,l]of Object.entries(K.value||{})){const f=F.value?.find(k=>k.id===n);f&&M({modifs:l,original:f.données})&&r.push({idÉlément:n,vals:l})}return r}),oe=L(()=>U.value.length+(Object.keys(j.value).length?1:0)),M=({modifs:r,original:n})=>Object.keys(r).some(l=>n[l]!==r[l]),j=A({});Ee(()=>{W.value||(j.value={})});const O=L(()=>Object.keys(j.value).length>0),se=({val:r,idCol:n,idÉlément:l})=>{if(l==="-1")r!==void 0?j.value[n]=r:delete j.value[n];else{const f=K.value||{};f[l]||(f[l]={}),f[l][n]=r,K.value=f}},de=async({vals:r})=>Object.fromEntries(await Promise.all(Object.entries(r).map(async([n,l])=>{if(l instanceof File){const f=await v.ajouterÀSFIP({contenu:new Uint8Array(await l.arrayBuffer()),nomFichier:l.name});return[n,f]}else return[n,l]}))),_e=async()=>{ee.value=!0;for(const{idÉlément:r,vals:n}of U.value)await v.tableaux.modifierÉlément({idTableau:_.idTableau,idÉlément:r,vals:await de({vals:n})});O.value&&await ye(),K.value=void 0,ee.value=!1},ye=async()=>{await v.tableaux.ajouterÉlément({idTableau:_.idTableau,vals:await de({vals:j.value})}),j.value={}},ae=A(!1),X=A(!1),q=A(!1),c=A(!1),b=A(!1);Ye([c,b],()=>{ae.value=X.value});const i=async({idÉlément:r})=>{q.value=!0,await v.tableaux.effacerÉlément({idTableau:_.idTableau,idÉlément:r}),q.value=!1},m=async()=>{q.value=!0,await Promise.all(R.value.map(r=>i({idÉlément:r}))),R.value=[],q.value=!1},re=async()=>{await v.bds.effacerTableauBd({idBd:_.idBd,idTableau:_.idTableau})};return(r,n)=>(u(),p(Da,{modelValue:R.value,"onUpdate:modelValue":n[13]||(n[13]=l=>R.value=l),headers:w.value,items:be.value,"show-select":!!a(g),"multi-sort":"","onUpdate:sortBy":n[14]||(n[14]=l=>ne.value=l)},ea({top:t(()=>[e(Sa,{flat:"",density:"compact"},{default:t(()=>[e(G),a(g)?(u(),p(B,{key:0,icon:"",disabled:!oe.value,onClick:n[0]||(n[0]=()=>_e())},{default:t(()=>[oe.value?(u(),p(aa,{key:0,color:"success",content:oe.value},{default:t(()=>[e(Q,{color:"primary",icon:"mdi-content-save-outline"})]),_:1},8,["content"])):(u(),p(Q,{key:1,color:"primary",icon:"mdi-content-save-check-outline"}))]),_:1},8,["disabled"])):$("",!0),a(g)?(u(),p(qa,{key:1,modelValue:W.value,"onUpdate:modelValue":n[1]||(n[1]=l=>W.value=l),class:"me-4",density:"compact",color:"primary","true-icon":"mdi-pencil-outline","false-icon":"mdi-pencil-off-outline","hide-details":""},null,8,["modelValue"])):$("",!0),a(g)?(u(),p(Ma,{key:2,"id-tableau":r.idTableau,"variables-interdites":a(y),onNouvelle:n[2]||(n[2]=l=>T(l))},{activator:t(({props:l})=>[e(B,x(l,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):$("",!0),e(Qe,{"id-objet":r.idTableau,"type-objet":"tableau"},{activator:t(({props:l})=>[e(le,{text:a(o)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(B,x({...l,...f},{icon:"mdi-sync"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(He,{"id-objet":r.idTableau,"noms-objet":a(s),"type-objet":"tableau"},{activator:t(({props:l})=>[e(le,{text:a(o)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(B,x({...l,...f},{icon:"mdi-download"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),a(g)?(u(),p(Ge,{key:3,onEffacer:n[3]||(n[3]=()=>re())},{activator:t(({props:l})=>[e(B,x(l,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):$("",!0)]),_:1})]),"no-data":t(()=>[N("p",Xa,V(a(o)("tableaux.aucuneDonnée")),1),$("",!0)]),"item.actions":t(({item:l})=>[l.id==="-1"?(u(),p(B,{key:0,disabled:!O.value,icon:"mdi-content-save-outline",size:"small",variant:"flat",onClick:n[9]||(n[9]=()=>ye())},null,8,["disabled"])):ae.value&&a(g)?(u(),p(B,{key:1,size:"small",icon:"mdi-delete",variant:"flat",loading:q.value,onClick:()=>i({idÉlément:l.id})},null,8,["loading","onClick"])):a(g)?(u(),p(Be,{key:2,modelValue:c.value,"onUpdate:modelValue":n[12]||(n[12]=f=>c.value=f)},{activator:t(({props:f})=>[e(B,x(f,{variant:"flat",icon:"mdi-delete",size:"small",loading:q.value}),null,16,["loading"])]),default:t(()=>[e(z,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[h(V(a(o)("tableaux.données.titreEffacer")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Se,{modelValue:X.value,"onUpdate:modelValue":n[10]||(n[10]=f=>X.value=f),label:a(o)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(B,{variant:"text",text:a(o)("communs.oui"),onClick:()=>{i({idÉlément:l.id}),c.value=!1}},null,8,["text","onClick"]),e(B,{variant:"text",color:"primary",text:a(o)("communs.non"),onClick:n[11]||(n[11]=f=>c.value=!1)},null,8,["text"]),e(G)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])):$("",!0)]),_:2},[me(P.value||[],l=>({name:`header.${l.key}`,fn:t(({column:f,isSorted:k,getSortIcon:We,toggleSort:Ke})=>[e(Aa,{"id-colonne":l.key,"id-variable":l.info.variable,"id-tableau":r.idTableau,index:!!l.info.index,regles:a(Ve)?.filter(Te=>Te.colonne===l.key),"permission-modifier":!!a(g),ordonnable:f.sortable,"est-ordonnee":k(f),"icone-ordonner":We(f),onBasculerOrdonner:()=>Ke(f),onSauvegarder:Te=>D({idColonne:l.key,...Te}),onEffacer:()=>I({idColonne:l.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),a(g)?{name:"header.actions",fn:t(()=>[ae.value?(u(),p(B,{key:0,icon:"mdi-delete",variant:"flat",size:"small",loading:q.value,readonly:!R.value.length,onClick:n[4]||(n[4]=()=>m())},null,8,["loading","readonly"])):(u(),p(Be,{key:1,modelValue:b.value,"onUpdate:modelValue":n[8]||(n[8]=l=>b.value=l)},{activator:t(({props:l})=>[e(B,x(l,{icon:"",variant:"flat",size:"small",readonly:!R.value.length,loading:q.value}),{default:t(()=>[e(Q,{icon:"mdi-delete",color:R.value.length?void 0:"disabled"},null,8,["color"])]),_:2},1040,["readonly","loading"])]),default:t(()=>[e(z,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[h(V(a(o)("tableaux.données.titreEffacerSélectionnées",R.value.length)),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Se,{modelValue:X.value,"onUpdate:modelValue":n[5]||(n[5]=l=>X.value=l),label:a(o)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(B,{variant:"text",text:a(o)("communs.oui"),onClick:n[6]||(n[6]=()=>{m(),b.value=!1})},null,8,["text"]),e(B,{variant:"text",color:"primary",text:a(o)("communs.non"),onClick:n[7]||(n[7]=l=>b.value=!1)},null,8,["text"]),e(G)]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),key:"0"}:void 0,me(P.value,l=>({name:`item.${l.key}`,fn:t(({item:f})=>[e(Ea,{categorie:l.info.catégorie?.catégorie,val:f.données[l.key],editable:!!a(g)&&W.value,onModifiee:({val:k})=>se({idCol:l.key,idÉlément:f.id,val:k})},null,8,["categorie","val","editable","onModifiee"])])}))]),1032,["modelValue","headers","items","show-select"]))}}),Ja={class:"text-center"},Ya={class:"text-center"},et={key:0,class:"text-disabled"},at={class:"text-center"},tt={class:"mt-6 text-h5"},it={class:"d-flex flex-wrap"},lt={class:"mt-6 text-h5"},nt={key:0,class:"text-disabled"},ot={class:"mt-6 text-h5"},st={key:2,class:"text-center"},dt={class:"text-h5 mt-5"},kt=Y({__name:"PageBd",props:{id:{}},setup(S){const d=S,o=pe(),{mdAndUp:v}=Ae(),{isRtl:_}=ta(),{மொழியாக்கம்_பயன்படுத்து:g}=ve(),{$மொ:s}=g(),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:y}=ia(),{obtImageDéco:E}=na(),H=ja();la(()=>{H.documentOuvert({id:d.id,à:Date.now()})});const P=E("vide"),w=C(o.suivrePermission,{idObjet:d.id}),T=C(o.bds.suivreNomsBd,{idBd:d.id}),D=y(T),I=async c=>{const{àEffacer:b,àAjouter:i}=Oe({anciennes:T.value,nouvelles:c});for(const m of b)await o.bds.effacerNomBd({idBd:d.id,langue:m});await o.bds.sauvegarderNomsBd({idBd:d.id,noms:i})},F=C(o.bds.suivreDescriptionsBd,{idBd:d.id}),be=y(F),ne=async c=>{const{àEffacer:b,àAjouter:i}=Oe({anciennes:F.value,nouvelles:c});for(const m of b)await o.bds.effacerDescriptionBd({idBd:d.id,langue:m});await o.bds.sauvegarderDescriptionsBd({idBd:d.id,descriptions:i})},R=oa(C(o.bds.suivreImage,{idBd:d.id})),Ve=E("logoBD"),W=async c=>{c?await o.bds.sauvegarderImage({idBd:d.id,image:{contenu:new Uint8Array(c.contenu),nomFichier:c.fichier}}):await o.bds.effacerImage({idBd:d.id})},ee=C(o.bds.suivreStatutBd,{idBd:d.id}),K=C(o.bds.suivreVariablesBd,{idBd:d.id}),U=C(o.bds.suivreMotsClefsBd,{idBd:d.id}),oe=async c=>{const b=c.filter(m=>!U.value?.includes(m)),i=U.value?.filter(m=>!c.includes(m))||[];await o.bds.ajouterMotsClefsBd({idBd:d.id,idsMotsClefs:b}),await Promise.all(i.map(m=>o.bds.effacerMotClefBd({idBd:d.id,idMotClef:m})))},M=C(o.bds.suivreTableauxBd,{idBd:d.id}),j=A();Ee(()=>{!j.value&&M.value?.length&&(j.value=M.value[0].clef),j.value&&!M.value?.map(c=>c.clef).includes(j.value)&&(j.value=void 0)});const O=A(!1),se=async({noms:c,cols:b})=>{O.value=!0;try{const i=await o.bds.ajouterTableauBd({idBd:d.id});await o.tableaux.sauvegarderNomsTableau({idTableau:i,noms:ze(c)}),await Promise.all(b.map(async m=>{await o.tableaux.ajouterColonneTableau({idTableau:i,idColonne:m.info.id,idVariable:m.info.variable}),m.info.index&&await o.tableaux.changerColIndex({idTableau:i,idColonne:m.info.id,val:!0}),await Promise.all(m.règles.map(async re=>await o.tableaux.ajouterRègleTableau({idTableau:i,idColonne:m.info.id,règle:re})))}))}finally{O.value=!1}},de=C(o.réseau.suivreAuteursBd,{idBd:d.id}),_e=C(o.bds.suivreLicenceBd,{idBd:d.id}),ye=C(o.bds.suivreLicenceContenuBd,{idBd:d.id}),ae=async({licence:c,licenceContenu:b})=>{await o.bds.changerLicenceBd({idBd:d.id,licence:c}),b&&await o.bds.changerLicenceContenuBd({idBd:d.id,licenceContenu:b})},X=L(()=>[{title:s("navigation.données"),href:encodeURI("/données/")},{title:D.value||s("bds.sansNom"),disabled:!0}]),q=async()=>{await o.bds.effacerBd({idBd:d.id})};return(c,b)=>(u(),p(sa,null,{default:t(()=>[N("div",null,[a(v)?(u(),p(Ia,{key:0,items:X.value,class:"pa-0"},{divider:t(()=>[e(Q,null,{default:t(()=>[h(V(a(_)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:t(({item:i})=>[e(Na,{disabled:i.disabled,onClick:m=>i.href&&c.$router.push(i.href)},{default:t(()=>[e(da,{texte:i.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(u(),p(B,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:b[0]||(b[0]=()=>c.$router.push(encodeURI("/données/")))}))]),e(ua,{"src-image":a(R),"img-defaut":a(Ve),editable:!!a(w),"taille-avatar":a(v)?275:175,"max-taille-image":a(ra),onImageChangee:b[1]||(b[1]=i=>W(i))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),N("div",Ja,[e(Ie,{"etiquette-nom":a(s)("objet.étiquetteNom"),"indice-nom":a(s)("objet.indiceNom"),"indice-langue":a(s)("objet.indiceLangue"),"texte-aucun-nom":a(s)("objet.texteAucunNom"),"noms-initiaux":a(T),titre:a(s)("objet.titreDialogueNoms"),"sous-titre":a(s)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!a(w),onAjusterNoms:I},{activator:t(({props:i})=>[N("span",x(i,{class:"text-h4"}),[h(V(a(D)||a(s)("bds.sansNom"))+" ",1),e(B,{icon:a(w)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(ca,{id:c.id},null,8,["id"]),e(G)]),N("div",Ya,[e(Le,{"n-max":5,items:a(U)},{jeton:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:m})=>[e(fa,x(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:m})=>[e(ma,x(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(U)&&!a(U).length?(u(),ie("span",et,V(a(s)("bds.aucunMotClef")),1)):$("",!0),a(w)&&a(U)?(u(),p(va,{key:1,originaux:a(U),onSauvegarder:b[2]||(b[2]=i=>oe(i))},null,8,["originaux"])):$("",!0)]),N("div",at,[e(ba,{"id-bd":c.id},{activator:t(({props:i})=>[e(le,{"open-delay":"200",location:"bottom",text:a(s)("épingler.épingler")},{activator:t(({props:m})=>[e(B,x({...i,...m},{icon:"",variant:"flat"}),{default:t(()=>[e(pa,{id:c.id},null,8,["id"])]),_:2},1040)]),_:2},1032,["text"])]),_:1},8,["id-bd"]),e(He,{"id-objet":c.id,"noms-objet":a(T),"type-objet":"bd"},{activator:t(({props:i})=>[e(le,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(B,x({...i,...m},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),e(Ga,{id:c.id},{activator:t(({props:i})=>[e(le,{text:a(s)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(B,x({...i,...m},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),$("",!0),a(w)?(u(),p(Ge,{key:1,onEffacer:q},{activator:t(({props:i})=>[e(le,{"open-delay":"200",location:"bottom",text:a(s)("effacer.indice")},{activator:t(({props:m})=>[e(B,x({...i,...m},{variant:"flat",icon:""}),{default:t(()=>[e(Q,{color:"error"},{default:t(()=>b[7]||(b[7]=[h("mdi-delete")])),_:1})]),_:2},1040)]),_:2},1032,["text"])]),_:1})):$("",!0)]),e(ce),e(fe,null,{default:t(()=>[e(Ie,{"etiquette-nom":a(s)("objet.étiquetteDescription"),"indice-nom":a(s)("objet.indiceDescription"),"indice-langue":a(s)("objet.indiceLangue"),"texte-aucun-nom":a(s)("objet.texteAucuneDescription"),"noms-initiaux":a(F),titre:a(s)("objet.titreDialogueDescriptions"),"sous-titre":a(s)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!a(w),longue:"",onAjusterNoms:ne},{activator:t(({props:i})=>[N("span",{class:_a({"text-disabled":!a(be)})},V(a(be)||a(s)("communs.baseCarteObjet.sansDescription")),3),e(B,x(i,{icon:a(w)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),N("p",tt,V(a(s)("bds.info")),1),e(ce,{class:"mb-2"}),N("div",it,[a(ee)&&(a(ee).statut!=="active"||a(w))?(u(),p(z,{key:0,flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Ha,{"id-bd":c.id},{activator:t(({props:i})=>[e(La,x(i,{"type-objet":"bd",statut:a(ee)}),null,16,["statut"])]),_:1},8,["id-bd"])]),_:1})):$("",!0),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Qa,{"id-bd":c.id},{activator:t(({props:i})=>[e(Wa,x(i,{id:c.id}),null,16,["id"])]),_:1},8,["id-bd"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ya,{id:c.id,auteurs:a(de),"permission-moderateur":a(w)==="MODÉRATEUR"},{activator:t(({props:i})=>[e(Pa,x(i,{auteurs:a(de)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(qe,{licence:a(_e),"licence-contenu":a(ye),"permission-modifier":a(w)==="MODÉRATEUR",onChangerLicence:ae},{activator:t(({props:i})=>[e(Ka,x(i,{licence:a(_e),onChangerLicence:ae}),null,16,["licence"])]),_:1},8,["licence","licence-contenu","permission-modifier"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ga,{id:c.id},{activator:t(({props:i})=>[e(Oa,x(i,{id:c.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Qe,{"id-objet":c.id,permission:a(w),"type-objet":"bd"},{activator:t(({props:i})=>[e(Ra,x(i,{"id-objet":c.id}),null,16,["id-objet"])]),_:1},8,["id-objet","permission"])]),_:1})]),N("p",lt,V(a(s)("bds.variables")),1),e(ce,{class:"mb-2"}),e(Le,{"n-max":5,items:a(K)},{jeton:t(({id:i})=>[e(Pe,{id:i},{activator:t(({props:m})=>[e(Ba,x(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Pe,{id:i},{activator:t(({props:m})=>[e(xa,x(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(K)?.length?$("",!0):(u(),ie("p",nt,V(a(s)("bds.aucuneVariable")),1)),e(Me,null,{default:t(()=>[N("p",ot,V(a(s)("bds.tableaux")),1),e(ce),a(v)?(u(),p(za,{key:0,modelValue:j.value,"onUpdate:modelValue":b[4]||(b[4]=i=>j.value=i),class:"mt-2"},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(Fa,{key:i.clef,value:i.clef,color:"primary",size:"small",density:"compact"},{default:t(()=>[e(Re,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["value"]))),128)),e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(w)?(u(),p(je,x({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",disabled:O.value,variant:"text",class:"mx-1 my-auto",size:"x-large",label:"",onClick:b[3]||(b[3]=Ca(()=>{},["stop"]))}),{default:t(()=>[h(V(a(s)("tableaux.nouveau"))+" ",1),O.value?(u(),p(J,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1},8,["modelValue"])):(u(),p(ka,{key:1,modelValue:j.value,"onUpdate:modelValue":b[5]||(b[5]=i=>j.value=i),class:"mt-4","show-arrows":"","center-active":""},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(Ue,{key:i.clef,value:i.clef},{default:t(({isSelected:m,toggle:re})=>[e(je,{class:"mx-1",variant:"tonal",label:"",active:!1,color:m?"primary":"",onClick:re},{default:t(()=>[e(Re,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(Ue,{key:"nouveau",value:"nouveau"},{default:t(()=>[e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(w)?(u(),p(je,x({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:O.value}),{default:t(()=>[h(V(a(s)("tableaux.nouveau"))+" ",1),O.value?(u(),p(J,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),a(M)&&!a(M).length?(u(),ie("div",st,[N("p",dt,V(a(s)("tableaux.aucun")),1),e(Va,{src:a(P),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(w)?(u(),p(B,x({key:0},i,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:t(()=>[e(Q,{icon:"mdi-table",start:""})]),default:t(()=>[h(" "+V(a(s)("tableaux.nouveau")),1)]),_:2},1040)):$("",!0)]),_:1})])):$("",!0)]),_:1}),e(Ta,{modelValue:j.value,"onUpdate:modelValue":b[6]||(b[6]=i=>j.value=i)},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(wa,{key:i.clef,value:i.clef},{default:t(()=>[e(Za,{"id-tableau":i.id,"id-bd":c.id},null,8,["id-tableau","id-bd"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{kt as default};
//# sourceMappingURL=PageBd-BjUYA68J.js.map

import{d as O,க as A,n as B,r as x,c as q,a as p,x as R,w as a,b as t,V as H,h as i,i as X,e as G,f as j,t as N,y as oe,j as M,m as Q,W as ne,L as E,J as F,G as W,H as Y,I as K,q as C,p as I,o as Z,cg as me,Y as S,F as ue,dl as de,ck as pe,v as fe,A as U,aX as z,a9 as ve,bF as _e,dn as ye,a2 as ae,dp as J,av as be,P as L,bS as D,s as ee,dq as Ve,aN as P,Q as le,ap as xe,bT as ge,ம as je,aD as ke,aH as qe,z as we,M as $e}from"./index-DadGBWwK.js";import{_ as Ne,a as Ce,f as te,c as Te,d as he,e as De,g as Se,h as Fe,i as Ue,b as ie}from"./OptionsDocumentsExportation.vue_vue_type_script_setup_true_lang-2VpWmd21.js";import{_ as Ee}from"./TitrePage.vue_vue_type_script_setup_true_lang-Dd__mfm9.js";import{a as Oe}from"./index-DKUMIF59.js";import{o as Ae}from"./action-D-jaXKJc.js";import"./SélecteurNuée.vue_vue_type_script_setup_true_lang-Fe1vmUjv.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-C6qxYXjU.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-Cu8z0fKe.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-B96EaPsT.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-BRrt_sAJ.js";import"./_baseClone-06yv4Cqo.js";const Me=O({__name:"NouvelleAutomatisation",setup(w){const{மொழியாக்கம்_பயன்படுத்து:v}=A(),{$மொ:l}=v(),{mdAndUp:n}=B(),e=x(!1);return(s,o)=>(p(),q(R,{modelValue:e.value,"onUpdate:modelValue":o[1]||(o[1]=c=>e.value=c)},{activator:a(({props:c})=>[W(s.$slots,"activator",Y(K({props:c})))]),default:a(()=>[t(H,{class:"mx-auto","max-width":i(n)?500:300},{default:a(()=>[t(X,null,{default:a(()=>[t(G,{class:"d-flex"},{default:a(()=>[j(N(i(l)(""))+" Ajout d'automatisation ",1),t(oe),t(M,{icon:"mdi-close",size:"small",variant:"flat",onClick:o[0]||(o[0]=c=>e.value=!1)})]),_:1})]),_:1}),t(Q,null,{default:a(()=>[t(ne,null,{default:a(()=>[t(Ne,null,{activator:a(({props:c})=>[t(E,F({"prepend-icon":"mdi-import"},c),{default:a(()=>o[2]||(o[2]=[j(" Importer ")])),_:2},1040)]),_:1}),t(Ce,null,{activator:a(({props:c})=>[t(E,F({"prepend-icon":"mdi-export"},c),{default:a(()=>o[3]||(o[3]=[j(" Exporter ")])),_:2},1040)]),_:1})]),_:1})]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Pe=()=>{const w=Oe();return v=>{const l=i(v),n=C(()=>l?w.value.getTime()-l:void 0);return C(()=>{if(n.value!==void 0){const s=Math.abs(n.value),o=n.value<0?-1:1;return s<1e3?{unité:"millisecondes",n:s*o}:s<1e3*60?{unité:"secondes",n:Math.floor(s/1e3)*o}:s<1e3*60*60?{unité:"minutes",n:Math.floor(s/(1e3*60))*o}:s<1e3*60*60*24?{unité:"heures",n:Math.floor(s/(1e3*60*60))*o}:s<1e3*60*60*24*7?{unité:"jours",n:Math.floor(s/(1e3*60*60*24))*o}:s<1e3*60*60*24*30?{unité:"semaines",n:Math.floor(s/(1e3*60*60*24*7))*o}:s<1e3*60*60*24*365.25?{unité:"mois",n:Math.floor(s/(1e3*60*60*24*30))*o}:{unité:"années",n:Math.floor(s/(1e3*60*60*24*365.25))*o}}})}},Be=({t:w,clefs:v={dans:{millisecondes:"communs.temps.dans.ms",secondes:"communs.temps.dans.secondes",minutes:"communs.temps.dans.minutes",heures:"communs.temps.dans.heures",jours:"communs.temps.dans.jours",semaines:"communs.temps.dans.semaines",mois:"communs.temps.dans.mois",années:"communs.temps.dans.années"},depuis:{millisecondes:"communs.temps.depuis.ms",secondes:"communs.temps.depuis.secondes",minutes:"communs.temps.depuis.minutes",heures:"communs.temps.depuis.heures",jours:"communs.temps.depuis.jours",semaines:"communs.temps.depuis.semaines",mois:"communs.temps.depuis.mois",années:"communs.temps.depuis.années"}}})=>{const l=Pe();return n=>{const e=l(n);return C(()=>{if(e.value)return w(v[e.value.n<0?"dans":"depuis"][e.value.unité],{n:Math.abs(e.value.n)})})}},Ie=O({__name:"ItemStatutAutomatisation",props:{statut:{},spécification:{}},setup(w){const v=I(),{மொழியாக்கம்_பயன்படுத்து:l}=A(),{$மொ:n}=l(),e=Be({t:n}),s=w,o=C(()=>{switch(s.statut.type){case"erreur":return{icône:"mdi-alert",couleur:"error"};case"programmée":return{icône:"mdi-check",couleur:"success"};case"sync":return{icône:"mdi-sync",couleur:"primary"};case"écoute":return{icône:"",couleur:"success"};default:throw new Error(JSON.stringify(s.statut))}}),c=x(new Date().getTime());let m;Z(()=>{m=window.setInterval(()=>c.value=new Date().getTime(),1e3)}),me(()=>{m&&clearInterval(m)});const _=async()=>{},y=e(C(()=>s.statut.type==="programmée"?s.statut.à:s.statut.type==="erreur"?s.statut.prochaineProgramméeÀ:void 0)),T=e(C(()=>s.statut.type==="sync"?s.statut.depuis:void 0)),h=C(()=>{switch(s.statut.type){case"écoute":return"automatisations.jetonStatut.écoute";case"sync":return n("automatisations.jetonStatut.sync",{depuis:T.value});case"programmée":return n("automatisations.jetonStatut.programmée",{dans:y.value});case"erreur":return s.statut.prochaineProgramméeÀ?n("automatisations.jetonStatut.erreurRéssayer",{dans:y.value}):"automatisations.jetonStatut.erreur";default:throw new Error(s.statut)}}),d=async()=>await v.automatisations.lancerManuellement({id:s.spécification.id});return(k,u)=>(p(),q(E,{title:"Ce dispositif"},{prepend:a(()=>[t(ue,{start:"",color:o.value.couleur},{default:a(()=>[j(N(o.value.icône),1)]),_:1},8,["color"])]),subtitle:a(()=>[j(N(i(n)(h.value)),1)]),default:a(()=>[k.spécification?.type==="exportation"?(p(),q(te,{key:0,class:"my-2",spécification:k.spécification,onClick:u[0]||(u[0]=()=>_())},null,8,["spécification"])):S("",!0),t(M,{class:"my-2",size:"small",variant:"outlined","append-icon":"mdi-refresh",onClick:d},{default:a(()=>u[1]||(u[1]=[j(' "Relancer" ')])),_:1})]),_:1}))}}),ze={key:0},Je={key:0,class:"d-flex"},Le={key:0,class:"d-flex mb-4"},Re=O({__name:"OptionsFréquenceExportation",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(w){const v=de(w,"modelValue"),{mdAndUp:l}=B(),{மொழியாக்கம்_பயன்படுத்து:n}=A(),{$மொ:e}=n(),s=pe(),o=[{value:"manuelle",title:"automatisations.fréquence.manuelle",sélection:"automatisations.exportation.fréquence.sélection.manuelle"},{value:"dynamique",title:"automatisations.fréquence.dynamique",sélection:"automatisations.exportation.fréquence.sélection.dynamique"},{value:"fixe",title:"automatisations.fréquence.fixe",sélection:"automatisations.exportation.fréquence.sélection.fixe"}],c=x(J?"manuelle":"fixe"),m=x(v.value?.type==="fixe"?v.value.détails.n.toString():"1"),_=C(()=>s.எண்ணுக்கு({உரை:m.value})),y=x("jours"),T=["années","mois","semaines","jours","heures","minutes","secondes","millisecondes"],h=u=>{try{return s.எண்ணுக்கு({உரை:u}),!0}catch{return e("règles.numérique")}},d=u=>(u|0)===u,k=()=>_.value!==void 0&&_.value>0&&d(_.value)?!0:e("règles.nombreEntierPositif");return fe(()=>{switch(c.value){case"manuelle":{const u={type:"manuelle"};v.value=u;break}case"dynamique":{const u={type:"dynamique"};v.value=u;break}case"fixe":{const u={type:"fixe",détails:{unités:y.value,n:_.value}};v.value=u;break}}}),(u,b)=>(p(),U(L,null,[t(z,{modelValue:c.value,"onUpdate:modelValue":b[2]||(b[2]=r=>c.value=r),class:ve(i(l)?["mb-4"]:["mb-2"]),items:o,variant:"outlined",density:"compact","hide-details":""},_e({item:a(({props:r,item:$})=>[t(E,F({...r,title:i(e)($.title)},{disabled:i(J)&&($.value==="manuelle"||$.value==="dynamique")}),{default:a(()=>[i(J)&&($.value==="manuelle"||$.value==="dynamique")?(p(),U("span",ze,[t(ue,{size:"small",start:""},{default:a(()=>b[5]||(b[5]=[j("mdi-alert-outline")])),_:1}),j(" "+N(i(e)("automatisations.fréquence.pasSurNavig")),1)])):S("",!0)]),_:2},1040,["disabled"])]),selection:a(({item:r})=>[j(N(i(e)(r.raw.sélection)),1)]),_:2},[i(l)?{name:"append",fn:a(()=>[t(ye,null,{default:a(()=>[c.value==="fixe"?(p(),U("div",Je,[t(ae,{modelValue:m.value,"onUpdate:modelValue":b[0]||(b[0]=r=>m.value=r),variant:"outlined",density:"compact","hide-details":"",rules:[h,k]},null,8,["modelValue","rules"]),t(z,{modelValue:y.value,"onUpdate:modelValue":b[1]||(b[1]=r=>y.value=r),items:T,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:a(({item:r})=>[j(N(i(e)(`automatisations.fréquence.unités.${r.raw}`)),1)]),item:a(({item:r,props:$})=>[t(E,F($,{title:i(e)(`automatisations.fréquence.unités.${r.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):S("",!0)]),_:1})]),key:"0"}:void 0]),1032,["modelValue","class"]),i(l)?S("",!0):(p(),q(be,{key:0},{default:a(()=>[c.value==="fixe"?(p(),U("div",Le,[t(ae,{modelValue:m.value,"onUpdate:modelValue":b[3]||(b[3]=r=>m.value=r),variant:"outlined",density:"compact","hide-details":"",rules:[h,k]},null,8,["modelValue","rules"]),t(z,{modelValue:y.value,"onUpdate:modelValue":b[4]||(b[4]=r=>y.value=r),items:T,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:a(({item:r})=>[j(N(i(e)(`automatisations.fréquence.unités.${r.raw}`)),1)]),item:a(({item:r,props:$})=>[t(E,F($,{title:i(e)(`automatisations.fréquence.unités.${r.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):S("",!0)]),_:1}))],64))}}),He=O({__name:"CarteAutomatisationExportation",props:{spécification:{},objetModifiable:{type:Boolean}},setup(w){const{மொழியாக்கம்_பயன்படுத்து:v}=A(),{$மொ:l}=v(),{mdAndUp:n}=B(),e=w,s=I(),o=x(!1),c=Ae(s.obtIdDispositif),m=x();Z(()=>{switch(e.spécification.typeObjet){case"tableau":D(s.tableaux.suivreNomsTableau({idTableau:e.spécification.idObjet,f:V=>m.value=V}));break;case"projet":D(s.projets.suivreNomsProjet({idProjet:e.spécification.idObjet,f:V=>m.value=V}));break;case"bd":D(s.bds.suivreNomsBd({idBd:e.spécification.idObjet,f:V=>m.value=V}));break;case"nuée":D(s.nuées.suivreNomsNuée({idNuée:e.spécification.idObjet,f:V=>m.value=V}));break;default:throw new Error(JSON.stringify(e.spécification))}});const _=ee(s.automatisations.suivreÉtatAutomatisations),y=C(()=>_.value?.[e.spécification.id]),T=x(e.spécification.langues),h=x(e.spécification.dossier),d=x(e.spécification.fréquence),k=x(e.spécification.formatDoc),u=x(e.spécification.inclureDocuments),b=x(e.spécification.copies),r=x(e.spécification.dispositifs),$=C(()=>({id:e.spécification.id,type:"exportation",fréquence:d.value,idObjet:e.spécification.idObjet,typeObjet:e.spécification.typeObjet,formatDoc:k.value,dossier:h.value,langues:T.value,dispositifs:r.value,inclureDocuments:u.value,copies:b.value})),re=async()=>{const V=await ge();V&&(h.value=V)},se=C(()=>!Ve($.value,e.spécification)),ce=async()=>{se.value&&await s.automatisations.modifierAutomatisation({id:e.spécification.id,automatisation:$.value})};return(V,f)=>(p(),q(R,{modelValue:o.value,"onUpdate:modelValue":f[9]||(f[9]=g=>o.value=g)},{activator:a(({props:g})=>[W(V.$slots,"activator",Y(K({props:g})))]),default:a(()=>[t(H,{class:"mx-auto","max-width":i(n)?500:300},{default:a(()=>[t(X,null,{default:a(()=>[t(G,{class:"d-flex"},{default:a(()=>[j(N(i(l)("automatisations.exportation.titreCarte"))+" ",1),t(oe),t(M,{icon:"mdi-close",size:"small",variant:"flat",onClick:f[0]||(f[0]=g=>o.value=!1)})]),_:1})]),_:1}),t(Q,{style:{"overflow-y":"scroll"}},{default:a(()=>[t(P,{titre:i(l)("automatisations.exportation.sousSections.statut"),"en-attente":!1},null,8,["titre"]),y.value?(p(),q(Ie,{key:0,statut:y.value,spécification:V.spécification},null,8,["statut","spécification"])):S("",!0),i(c)&&V.spécification.dispositifs.includes(i(c))?(p(),q(te,{key:1,class:"my-2",spécification:V.spécification,onClick:f[1]||(f[1]=()=>re())},null,8,["spécification"])):S("",!0),t(P,{titre:i(l)("automatisations.exportation.sousSections.format"),"en-attente":!1},null,8,["titre"]),t(Te,{modelValue:k.value,"onUpdate:modelValue":f[2]||(f[2]=g=>k.value=g)},null,8,["modelValue"]),t(he,{modelValue:T.value,"onUpdate:modelValue":f[3]||(f[3]=g=>T.value=g)},null,8,["modelValue"]),t(De,{modelValue:u.value,"onUpdate:modelValue":f[4]||(f[4]=g=>u.value=g)},null,8,["modelValue"]),t(P,{titre:i(l)("automatisations.exportation.sousSections.fréquence"),"en-attente":!1},null,8,["titre"]),t(Re,{modelValue:d.value,"onUpdate:modelValue":f[5]||(f[5]=g=>d.value=g)},null,8,["modelValue"]),t(Se,{modelValue:b.value,"onUpdate:modelValue":f[6]||(f[6]=g=>b.value=g)},null,8,["modelValue"])]),_:1}),t(le),t(xe,null,{default:a(()=>[t(M,{variant:"outlined",onClick:f[7]||(f[7]=g=>o.value=!1)},{default:a(()=>[j(N(i(l)("communs.annuler")),1)]),_:1}),t(M,{disabled:!se.value,color:"primary",variant:"outlined",onClick:f[8]||(f[8]=()=>ce())},{default:a(()=>[j(N(i(l)("communs.sauvegarder")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Xe=O({__name:"CarteAutomatisationImportation",props:{specification:{}},setup(w){const{மொழியாக்கம்_பயன்படுத்து:v}=A(),{$மொ:l}=v(),{mdAndUp:n}=B(),e=w,s=I(),o=x(!1),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:c}=je(),m=x();Z(()=>{if(e.specification.type==="importation")D(s.tableaux.suivreNomsTableau({idTableau:e.specification.idTableau,f:d=>m.value=d}));else switch(e.specification.typeObjet){case"tableau":D(s.tableaux.suivreNomsTableau({idTableau:e.specification.idObjet,f:d=>m.value=d}));break;case"projet":D(s.projets.suivreNomsProjet({idProjet:e.specification.idObjet,f:d=>m.value=d}));break;case"bd":D(s.bds.suivreNomsBd({idBd:e.specification.idObjet,f:d=>m.value=d}));break;case"nuée":D(s.nuées.suivreNomsNuée({idNuée:e.specification.idObjet,f:d=>m.value=d}));break;default:throw new Error(JSON.stringify(e.specification))}});const _=c(m),y=ee(s.automatisations.suivreÉtatAutomatisations),T=C(()=>y.value?.[e.specification.id]),h=async()=>{};return(d,k)=>(p(),q(R,{modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=u=>o.value=u)},{activator:a(({props:u})=>[W(d.$slots,"activator",Y(K({props:u})))]),default:a(()=>[t(H,{class:"mx-auto","max-width":i(n)?500:300},{default:a(()=>[t(X,null,{default:a(()=>[t(G,null,{default:a(()=>[j(N(i(_)),1)]),_:1})]),_:1}),t(Q,null,{default:a(()=>[t(P,{titre:i(l)("automatisations.statut"),"en-attente":!1},null,8,["titre"]),T.value?(p(),q(Fe,{key:0,statut:T.value},null,8,["statut"])):S("",!0),d.specification.type==="importation"?(p(),q(Ue,{key:1,spécification:d.specification},null,8,["spécification"])):(p(),q(te,{key:2,class:"my-2",spécification:d.specification,onClick:k[0]||(k[0]=()=>h())},null,8,["spécification"]))]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ge={key:0},Qe={class:"my-6 text-center text-h5 text-disabled"},ut=O({__name:"PageAutomatisations",setup(w){const v=I(),{மொழியாக்கம்_பயன்படுத்து:l}=A(),{$மொ:n}=l(),{obtImageDéco:e}=ke(),s=e("automatisation"),o=ee(v.automatisations.suivreAutomatisations);return(c,m)=>(p(),q(qe,{class:"text-center"},{default:a(()=>[t(Ee,{titre:i(n)("pages.automatisations.titre"),image:i(s),"sous-titre":i(n)("pages.automatisations.sousTitre")},null,8,["titre","image","sous-titre"]),t(ne,{class:"text-start"},{default:a(()=>[t(Me,{automatiser:""},{activator:a(({props:_})=>[t(E,F(_,{"prepend-icon":"mdi-plus",title:i(n)("pages.automatisations.ajouterNouvelle.titre"),subtitle:i(n)("pages.automatisations.ajouterNouvelle.sousTitre")}),null,16,["title","subtitle"])]),_:1}),t(le),i(o)?.length?S("",!0):(p(),U("div",Ge,[we("p",Qe,N(i(n)("pages.automatisations.aucune")),1)])),(p(!0),U(L,null,$e(i(o),_=>(p(),U(L,{key:_.id},[_.type==="exportation"?(p(),q(He,{key:0,spécification:_,"objet-modifiable":""},{activator:a(({props:y})=>[t(ie,F({ref_for:!0},y,{spécification:_}),null,16,["spécification"])]),_:2},1032,["spécification"])):(p(),q(Xe,{key:1,specification:_,"objet-modifiable":""},{activator:a(({props:y})=>[t(ie,F({ref_for:!0},y,{spécification:_}),null,16,["spécification"])]),_:2},1032,["specification"]))],64))),128))]),_:1})]),_:1}))}});export{ut as default};
//# sourceMappingURL=PageAutomatisations-DAYmab-H.js.map

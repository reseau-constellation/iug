import{d as M,p as Q,ம as Z,n as G,r as o,q as d,c as N,a as g,x as X,w as l,b as a,V as Y,h as i,i as ee,e as ae,z as D,t as m,at as te,f as w,m as le,T as ie,W as f,aZ as se,ej as ne,M as U,K as $,ek as re,am as ue,e1 as A,a1 as oe,A as q,F as ce,cg as ve,au as de,Q as me,N as fe,j as be,ao as pe,bs as ge,y as _e,bt as Ve,H as xe,I as Ce,J as we,ch as ye,eg as Ne}from"./index-BRylzrLF.js";const je={key:0,class:"my-2 text-center text-disabled"},ke={class:"text-center"},De=M({__name:"NouvelleVariable",emits:["nouvelle"],setup(Te,{emit:B}){const I=B,b=Q(),{$மொ:s}=Z(),{mdAndUp:L}=G(),y=o(!1),r=o(0),u=["catégorie","noms","descriptions","unités","règles","confirmation"],R=d(()=>{switch(u[r.value]){case"catégorie":return"variables.nouvelle.titreCatégorie";case"noms":return"variables.nouvelle.titreNoms";case"descriptions":return"variables.nouvelle.titreDescriptions";case"unités":return"variables.nouvelle.titreUnités";case"règles":return"variables.nouvelle.titreRègles";case"confirmation":return"variables.nouvelle.titreConfirmation";default:return""}}),S=d(()=>{switch(u[r.value]){case"catégorie":return"variables.nouvelle.sousTitreCatégorie";case"noms":return"variables.nouvelle.sousTitreNoms";case"descriptions":return"variables.nouvelle.sousTitreDescriptions";case"unités":return"variables.nouvelle.sousTitreUnités";case"règles":return"variables.nouvelle.sousTitreRègles";case"confirmation":return"variables.nouvelle.sousTitreConfirmation";default:return""}}),h=()=>{switch(u[r.value]){case"règles":r.value=u.indexOf(O.value?"unités":"descriptions");break;default:r.value--;break}},E=()=>{switch(u[r.value]){case"descriptions":r.value=u.indexOf(O.value?"unités":"règles");break;default:r.value++;break}},j=d(()=>{switch(u[r.value]){case"catégorie":return{actif:!!c.value,visible:!0};case"noms":return{actif:!!Object.keys(p.value).length,visible:!0};case"confirmation":return{actif:!1,visible:!1};default:return{actif:!0,visible:!0}}}),k=d(()=>{switch(u[r.value]){case"catégorie":return{actif:!1,visible:!1};case"confirmation":return{actif:!C.value,visible:!0};default:return{actif:!0,visible:!0}}}),_=o(!1),c=o(),T=d(()=>{if(c.value)return{type:_.value?"liste":"simple",catégorie:c.value}}),p=o({}),P=t=>{p.value=t},V=o({}),F=t=>{V.value=t},x=o(),O=d(()=>c.value==="numérique"),v=o([]),W=t=>{v.value=[...v.value,{règle:t,id:ye()}]},z=t=>{v.value=v.value.filter(n=>n.id!==t)},C=o(!1),H=async()=>{if(C.value=!0,!T.value)return;const t=await b.variables.créerVariable({catégorie:T.value}),n=[b.variables.sauvegarderNomsVariable({idVariable:t,noms:Object.fromEntries(Object.entries(p.value))}),b.variables.sauvegarderDescriptionsVariable({idVariable:t,descriptions:Object.fromEntries(Object.entries(V.value))}),...v.value.map(e=>b.variables.ajouterRègleVariable({idVariable:t,règle:e.règle}))];x.value&&n.push(b.variables.sauvegarderUnitésVariable({idVariable:t,idUnité:x.value})),I("nouvelle",t),J()},J=()=>{c.value=void 0,_.value=!1,p.value={},V.value={},r.value=0,C.value=!1,y.value=!1};return(t,n)=>(g(),N(X,{modelValue:y.value,"onUpdate:modelValue":n[6]||(n[6]=e=>y.value=e)},{activator:l(({props:e})=>[xe(t.$slots,"activator",Ce(we({props:e})))]),default:l(()=>[a(Y,{class:"mx-auto","min-width":i(L)?500:300},{default:l(()=>[a(ee,null,{default:l(()=>[a(ae,{class:"text-h5 justify-space-between"},{default:l(()=>[D("span",null,m(i(s)(R.value)),1)]),_:1}),a(te,null,{default:l(()=>[w(m(i(s)(S.value)),1)]),_:1})]),_:1}),a(le,null,{default:l(()=>[a(ie,{modelValue:r.value,"onUpdate:modelValue":n[5]||(n[5]=e=>r.value=e),style:{"overflow-y":"scroll"}},{default:l(()=>[a(f,{value:0},{default:l(()=>[a(se,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),class:"mt-2",items:i(ne),label:i(s)("variables.nouvelle.catégorie"),variant:"outlined"},{item:l(({item:e,props:K})=>[a(U,$(K,{title:i(s)(`variables.catégories.${e.raw}`),subtitle:i(s)(`variables.indicesCatégories.${e.raw}`),"prepend-icon":i(re)({type:"simple",catégorie:e.raw})||"mdi-variable"}),null,16,["title","subtitle","prepend-icon"])]),selection:l(({item:e})=>[w(m(i(s)(`variables.catégories.${e.raw}`)),1)]),_:1},8,["modelValue","items","label"]),a(ue,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=e=>_.value=e),label:i(s)("variables.nouvelle.typeListe"),color:"primary","append-icon":"mdi-format-list-bulleted"},null,8,["modelValue","label"])]),_:1}),a(f,{value:1},{default:l(()=>[a(A,{"texte-aucun-nom":i(s)("communs.texteAucunNom"),"indice-langue":i(s)("communs.indiceLangue"),"etiquette-nom":i(s)("communs.étiquetteNom"),"indice-nom":i(s)("variables.nouvelle.texteIndiceNom"),"noms-initiaux":p.value,"autorisation-modification":!0,onAjusterNoms:P},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1}),a(f,{value:u.indexOf("descriptions")},{default:l(()=>[a(A,{"texte-aucun-nom":i(s)("variables.nouvelle.texteAucuneDescription"),"indice-langue":i(s)("communs.indiceLangue"),"etiquette-nom":i(s)("variables.nouvelle.texteÉtiquetteDescription"),"indice-nom":i(s)("variables.nouvelle.texteIndiceDescription"),"noms-initiaux":V.value,"autorisation-modification":!0,longue:"",onAjusterNoms:F},null,8,["texte-aucun-nom","indice-langue","etiquette-nom","indice-nom","noms-initiaux"])]),_:1},8,["value"]),a(f,{value:u.indexOf("unités")},{default:l(()=>[a(oe,{modelValue:x.value,"onUpdate:modelValue":n[2]||(n[2]=e=>x.value=e),variant:"outlined"},null,8,["modelValue"])]),_:1},8,["value"]),a(f,{value:u.indexOf("règles")},{default:l(()=>[a(ve,{source:{type:"variable"},"categorie-variable":c.value,onSauvegarder:n[3]||(n[3]=e=>W(e))},{activator:l(({props:e})=>[a(U,$(e,{"prepend-icon":"mdi-plus"}),{default:l(()=>[a(de,null,{default:l(()=>[w(m(i(s)("variables.règles.nouvelle")),1)]),_:1})]),_:2},1040)]),_:1},8,["categorie-variable"]),(g(!0),q(me,null,fe(v.value,e=>(g(),N(Ne,{key:e.id,regle:e,effacable:"","autorisation-modifier":"",onEffacer:()=>z(e.id)},null,8,["regle","onEffacer"]))),128)),v.value.length?ce("",!0):(g(),q("p",je,m(i(s)("variables.règles.aucune")),1))]),_:1},8,["value"]),(g(),N(f,{key:u.indexOf("confirmation")},{default:l(()=>[D("div",ke,[a(be,{class:"mt-3",variant:"outlined",loading:C.value,onClick:n[4]||(n[4]=()=>H())},{default:l(()=>[w(m(i(s)("variables.nouvelle.texteBtnCréation")),1)]),_:1},8,["loading"])])]),_:1}))]),_:1},8,["modelValue"])]),_:1}),a(pe,null,{default:l(()=>[a(ge,{visible:k.value.visible,actif:k.value.actif,onRetour:h},null,8,["visible","actif"]),a(_e),a(Ve,{visible:j.value.visible,actif:j.value.actif,onSuivant:E},null,8,["visible","actif"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}});export{De as _};
//# sourceMappingURL=NouvelleVariable.vue_vue_type_script_setup_true_lang-ilDle8hv.js.map

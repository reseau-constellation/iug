{"version":3,"file":"CarteProjet.vue_vue_type_script_setup_true_lang-Cakrio1a.js","sources":["../../src/components/épingles/ÉpinglerProjet.vue","../../src/components/projets/CarteProjet.vue"],"sourcesContent":["<template>\n  <v-dialog\n    v-model=\"dialogue\"\n    :max-width=\"mdAndUp ? 500 : 300\"\n  >\n    <template #activator=\"{props: propsActivateur}\">\n      <slot\n        name=\"activateur\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <v-card>\n      <v-card-item>\n        <v-card-title class=\"d-flex align-center\">\n          {{ t('épingler.titre') }}\n          <v-spacer />\n          <v-btn\n            icon=\"mdi-close\"\n            size=\"small\"\n            variant=\"flat\"\n            @click=\"fermer\"\n          >\n          </v-btn>\n        </v-card-title>\n      </v-card-item>\n      <v-divider />\n      <v-card-text style=\"overflow-y: scroll\">\n        <v-icon start>mdi-pin-outline</v-icon>\n        <span class=\"font-weight-bold\">{{ t('épingler.dispositifsÉpingle') }}</span>\n        <selection-dispositifs\n          v-model:selection=\"sélectionBase\"\n          v-model:specifiques=\"spécifiquesBase\"\n          class=\"ms-4\"\n        />\n\n        <v-expand-transition>\n          <div v-show=\"sélectionBase !== 'AUCUN'\">\n            <p class=\"mb-2\">\n              <span>{{ t('épingler.optionsAvancées') }}</span>\n              <v-btn\n                :icon=\"optionsAvancées ? 'mdi-chevron-up' : 'mdi-chevron-down'\"\n                size=\"xsmall\"\n                variant=\"flat\"\n                @click=\"() => (optionsAvancées = !optionsAvancées)\"\n              ></v-btn>\n            </p>\n\n            <v-expand-transition>\n              <div v-show=\"optionsAvancées\">\n                <v-divider class=\"mb-2\" />\n                <p>\n                  <v-icon start>mdi-database</v-icon>\n                  <span class=\"font-weight-bold\">{{ t('épingler.dispositifsÉpingleBds') }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionBds\"\n                  v-model:specifiques=\"spécifiquesBds\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-table-multiple</v-icon>\n                  <span class=\"font-weight-bold\">{{\n                    t('épingler.dispositifsÉpingleDonnées')\n                  }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionTableaux\"\n                  v-model:specifiques=\"spécifiquesTableaux\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-image-multiple-outline</v-icon>\n                  <span class=\"font-weight-bold\">{{\n                    t('épingler.dispositifsÉpingleDocuments')\n                  }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionFichiersTableaux\"\n                  v-model:specifiques=\"spécifiquesFichiersTableaux\"\n                  class=\"ms-4\"\n                />\n              </div>\n            </v-expand-transition>\n          </div>\n        </v-expand-transition>\n      </v-card-text>\n      <v-divider />\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <btn-annuler @click=\"fermer\" />\n        <btn-sauvegarder\n          :actif=\"prêtÀÉpingler && valeursChangées\"\n          :en-attente=\"enProgrès\"\n          @click=\"() => épingler()\"\n        />\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script setup lang=\"ts\">\nimport {type favoris} from '@constl/ipa';\n\nimport {suivre} from '@constl/vue';\nimport {computed, ref} from 'vue';\nimport {useDisplay} from 'vuetify';\n\nimport {மொழியாக்கத்தைப்_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport SelectionDispositifs from './SélectionDispositifs.vue';\nimport {optionsDispositifs} from './utils';\nimport {utiliserConstellation} from '/@/components/utils';\n\nimport BtnAnnuler from '/@/components/communs/BtnAnnuler.vue';\nimport BtnSauvegarder from '/@/components/communs/BtnSauvegarder.vue';\n\nconst props = defineProps<{idProjet: string}>();\n\nconst constl = utiliserConstellation();\n\nconst {mdAndUp} = useDisplay();\n\nconst {$மொ: t} = மொழியாக்கத்தைப்_பயன்படுத்து();\n\n// Navigation\nconst dialogue = ref(false);\nconst optionsAvancées = ref(false);\n\n// Épingle actuelle\nconst épingle = suivre(constl.projets.suivreÉpingleProjet, {\n  idProjet: computed(() => props.idProjet),\n});\n\n// Options\nconst {\n  sélection: sélectionBase,\n  dispositifs: dispositifsBase,\n  spécifiques: spécifiquesBase,\n  valide: baseValide,\n  modifié: baseModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionBds,\n  dispositifs: dispositifsBds,\n  spécifiques: spécifiquesBds,\n  valide: bdsValide,\n  modifié: bdsModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionTableaux,\n  dispositifs: dispositifsTableaux,\n  spécifiques: spécifiquesTableaux,\n  valide: tableauxValide,\n  modifié: tableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.données.tableaux),\n  'INSTALLÉ',\n);\nconst {\n  sélection: sélectionFichiersTableaux,\n  dispositifs: dispositifsFichiersTableaux,\n  spécifiques: spécifiquesFichiersTableaux,\n  valide: fichiersTableauxValide,\n  modifié: fichiersTableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.données.fichiers),\n  'INSTALLÉ',\n);\n\n// Sauvegarder\nconst prêtÀÉpingler = computed(() => {\n  return baseValide && bdsValide && tableauxValide && fichiersTableauxValide;\n});\n\nconst valeursChangées = computed(() => {\n  return (\n    baseModifié.value || bdsModifié.value || tableauxModifié.value || fichiersTableauxModifié.value\n  );\n});\n\nconst enProgrès = ref(false);\nconst épingler = async () => {\n  enProgrès.value = true;\n\n  if (dispositifsBase.value !== 'AUCUN') {\n    const épingle: favoris.ÉpingleProjet = {\n      type: 'projet',\n      base: dispositifsBase.value,\n      bds: {\n        type: 'bd',\n        base: dispositifsBds.value,\n        données: {\n          tableaux: dispositifsTableaux.value,\n          fichiers: dispositifsFichiersTableaux.value,\n        },\n      },\n    };\n    await constl.projets.épinglerProjet({\n      idProjet: props.idProjet,\n      options: épingle,\n    });\n  } else {\n    await désépingler();\n  }\n  fermer();\n};\nconst désépingler = async () => {\n  await constl.favoris.désépinglerFavori({idObjet: props.idProjet});\n};\n\n// Fermer\nconst fermer = () => {\n  dialogue.value = false;\n  enProgrès.value = false;\n};\n</script>\n","<template>\n  <base-carte-objet\n    :id=\"id\"\n    :noms=\"noms\"\n    :descriptions=\"descriptions\"\n    :auteurs=\"auteurs\"\n    :fichiers-epinglables=\"true\"\n    @ajuster-noms=\"ajusterNoms\"\n    @ajuster-descriptions=\"ajusterDescriptions\"\n    @effacer=\"effacerProjet\"\n  >\n    <template #activateur=\"{props: propsActivateur}\">\n      <slot\n        name=\"activateur\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <template #epingler=\"{activateur, epingle}\">\n      <epingler-projet :id-projet=\"id\">\n        <template #activateur=\"{props: propsActivateur}\">\n          <component\n            :is=\"activateur\"\n            v-bind=\"propsActivateur\"\n            :id=\"id\"\n            :epingle=\"epingle\"\n          />\n        </template>\n      </epingler-projet>\n    </template>\n  </base-carte-objet>\n</template>\n<script setup lang=\"ts\">\nimport {suivre} from '@constl/vue';\n\nimport {computed} from 'vue';\nimport BaseCarteObjet from '../communs/BaseCarteObjet.vue';\nimport {utiliserConstellation} from '/@/components/utils';\nimport EpinglerProjet from '/@/components/épingles/ÉpinglerProjet.vue';\nimport {ajusterTexteTraductible} from '/@/utils';\n\nconst props = defineProps<{id: string}>();\n\nconst constl = utiliserConstellation();\n\n// Nom projet\nconst noms = suivre(constl.projets.suivreNomsProjet, {idProjet: computed(() => props.id)}, {});\nconst ajusterNoms = async (nms: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({anciennes: noms.value, nouvelles: nms});\n  for (const langue of àEffacer) {\n    await constl.projets.effacerNomProjet({idProjet: props.id, langue});\n  }\n  await constl.projets.sauvegarderNomsProjet({\n    idProjet: props.id,\n    noms: àAjouter,\n  });\n};\n\n// Descriptions projet\nconst descriptions = suivre(\n  constl.projets.suivreDescriptionsProjet,\n  {idProjet: computed(() => props.id)},\n  {},\n);\n\nconst ajusterDescriptions = async (descrs: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({\n    anciennes: descriptions.value,\n    nouvelles: descrs,\n  });\n  for (const langue of àEffacer) {\n    await constl.projets.effacerDescriptionProjet({idProjet: props.id, langue});\n  }\n  await constl.projets.sauvegarderDescriptionsProjet({\n    idProjet: props.id,\n    descriptions: àAjouter,\n  });\n};\n\n// Auteurs\nconst auteurs = suivre(constl.réseau.suivreAuteursProjet, {idProjet: computed(() => props.id)});\n\n// Effacer\nconst effacerProjet = async () => {\n  await constl.projets.effacerProjet({idProjet: props.id});\n};\n</script>\n"],"names":["props","__props","constl","utiliserConstellation","mdAndUp","useDisplay","t","மொழியாக்கத்தைப்_பயன்படுத்து","dialogue","ref","optionsAvancées","épingle","suivre","computed","sélectionBase","dispositifsBase","spécifiquesBase","baseValide","baseModifié","optionsDispositifs","sélectionBds","dispositifsBds","spécifiquesBds","bdsValide","bdsModifié","sélectionTableaux","dispositifsTableaux","spécifiquesTableaux","tableauxValide","tableauxModifié","sélectionFichiersTableaux","dispositifsFichiersTableaux","spécifiquesFichiersTableaux","fichiersTableauxValide","fichiersTableauxModifié","prêtÀÉpingler","valeursChangées","enProgrès","épingler","désépingler","fermer","_createBlock","_component_v_dialog","$event","_unref","_withCtx","propsActivateur","_renderSlot","_ctx","_createVNode","_component_v_card","_component_v_card_item","_component_v_card_title","_createTextVNode","_toDisplayString","_component_v_spacer","_component_v_btn","_component_v_divider","_component_v_card_text","_component_v_icon","_cache","_createElementVNode","_hoisted_1","SelectionDispositifs","_component_v_expand_transition","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_component_v_card_actions","BtnAnnuler","BtnSauvegarder","noms","ajusterNoms","nms","àEffacer","àAjouter","ajusterTexteTraductible","langue","descriptions","ajusterDescriptions","descrs","auteurs","effacerProjet","BaseCarteObjet","id","activateur","epingle","EpinglerProjet","_openBlock","_resolveDynamicComponent","_mergeProps"],"mappings":"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"}
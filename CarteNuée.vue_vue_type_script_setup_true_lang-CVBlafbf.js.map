{"version":3,"file":"CarteNuée.vue_vue_type_script_setup_true_lang-CVBlafbf.js","sources":["../../src/components/épingles/ÉpinglerNuée.vue","../../src/components/nuées/CarteNuée.vue"],"sourcesContent":["<template>\n  <v-dialog\n    v-model=\"dialogue\"\n    :max-width=\"mdAndUp ? 500 : 300\"\n  >\n    <template #activator=\"{props: propsActivateur}\">\n      <slot\n        name=\"activator\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <v-card>\n      <v-card-item>\n        <v-card-title class=\"d-flex align-center\">\n          {{ t('épingler.titre') }}\n          <v-spacer />\n          <v-btn\n            icon=\"mdi-close\"\n            size=\"small\"\n            variant=\"flat\"\n            @click=\"fermer\"\n          >\n          </v-btn>\n        </v-card-title>\n      </v-card-item>\n      <v-divider />\n      <v-card-text style=\"overflow-y: scroll\">\n        <v-icon start>mdi-pin-outline</v-icon>\n        <span class=\"font-weight-bold\">{{ t('épingler.dispositifsÉpingle') }}</span>\n        <selection-dispositifs\n          v-model:selection=\"sélectionBase\"\n          v-model:specifiques=\"spécifiquesBase\"\n          class=\"ms-4\"\n        />\n\n        <v-expand-transition>\n          <div v-show=\"sélectionBase !== 'AUCUN'\">\n            <p class=\"mb-2\">\n              <span>{{ t('épingler.optionsAvancées') }}</span>\n              <v-btn\n                :icon=\"optionsAvancées ? 'mdi-chevron-up' : 'mdi-chevron-down'\"\n                size=\"xsmall\"\n                variant=\"flat\"\n                @click=\"() => (optionsAvancées = !optionsAvancées)\"\n              ></v-btn>\n            </p>\n\n            <v-expand-transition>\n              <div v-show=\"optionsAvancées\">\n                <v-divider class=\"mb-2\" />\n                <p>\n                  <v-icon start>mdi-databasee</v-icon>\n                  <span class=\"font-weight-bold\"> {{ t('épingler.dispositifsÉpingleBds') }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionBds\"\n                  v-model:specifiques=\"spécifiquesBds\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-table-multiple</v-icon>\n                  <span class=\"font-weight-bold\">\n                    {{ t('épingler.dispositifsÉpingleDonnées') }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionTableaux\"\n                  v-model:specifiques=\"spécifiquesTableaux\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-image-multiple-outline</v-icon>\n                  <span class=\"font-weight-bold\">\n                    {{ t('épingler.dispositifsÉpingleDocuments') }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionFichiersTableaux\"\n                  v-model:specifiques=\"spécifiquesFichiersTableaux\"\n                  class=\"ms-4\"\n                />\n              </div>\n            </v-expand-transition>\n          </div>\n        </v-expand-transition>\n      </v-card-text>\n      <v-divider />\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <btn-annuler @click=\"fermer\" />\n        <btn-sauvegarder\n          :actif=\"prêtÀÉpingler && valeursChangées\"\n          :en-attent=\"enProgrès\"\n          @click=\"() => épingler()\"\n        />\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script setup lang=\"ts\">\nimport {type favoris} from '@constl/ipa';\n\nimport {suivre} from '@constl/vue';\nimport {computed, ref} from 'vue';\nimport {useDisplay} from 'vuetify';\n\nimport {மொழியாக்கத்தைப்_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport SelectionDispositifs from './SélectionDispositifs.vue';\nimport {optionsDispositifs} from './utils';\nimport {utiliserConstellation} from '/@/components/utils';\n\nimport BtnAnnuler from '/@/components/communs/BtnAnnuler.vue';\nimport BtnSauvegarder from '/@/components/communs/BtnSauvegarder.vue';\n\nconst props = defineProps<{idNuee: string}>();\n\nconst constl = utiliserConstellation();\n\nconst {mdAndUp} = useDisplay();\n\nconst {$மொ: t} = மொழியாக்கத்தைப்_பயன்படுத்து();\n\n// Navigation\nconst dialogue = ref(false);\nconst optionsAvancées = ref(false);\n\n// Épingle actuelle\nconst épingle = suivre(constl.nuées.suivreÉpingleNuée, {idNuée: computed(() => props.idNuee)});\n\n// Options\nconst {\n  sélection: sélectionBase,\n  dispositifs: dispositifsBase,\n  spécifiques: spécifiquesBase,\n  valide: baseValide,\n  modifié: baseModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionBds,\n  dispositifs: dispositifsBds,\n  spécifiques: spécifiquesBds,\n  valide: bdsValide,\n  modifié: bdsModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.données.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionTableaux,\n  dispositifs: dispositifsTableaux,\n  spécifiques: spécifiquesTableaux,\n  valide: tableauxValide,\n  modifié: tableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.données.données.tableaux),\n  'INSTALLÉ',\n);\nconst {\n  sélection: sélectionFichiersTableaux,\n  dispositifs: dispositifsFichiersTableaux,\n  spécifiques: spécifiquesFichiersTableaux,\n  valide: fichiersTableauxValide,\n  modifié: fichiersTableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.données.données.fichiers),\n  'INSTALLÉ',\n);\n\n// Sauvegarder\nconst prêtÀÉpingler = computed(() => {\n  return baseValide && bdsValide && tableauxValide && fichiersTableauxValide;\n});\n\nconst valeursChangées = computed(() => {\n  return (\n    baseModifié.value || bdsModifié.value || tableauxModifié.value || fichiersTableauxModifié.value\n  );\n});\n\nconst enProgrès = ref(false);\nconst épingler = async () => {\n  enProgrès.value = true;\n\n  if (dispositifsBase.value !== 'AUCUN') {\n    const épingle: favoris.ÉpingleNuée = {\n      type: 'nuée',\n      base: dispositifsBase.value,\n      données: {\n        type: 'bd',\n        base: dispositifsBds.value,\n        données: {\n          tableaux: dispositifsTableaux.value,\n          fichiers: dispositifsFichiersTableaux.value,\n        },\n      },\n    };\n    await constl.nuées.épinglerNuée({\n      idNuée: props.idNuee,\n      options: épingle,\n    });\n  } else {\n    await désépingler();\n  }\n  fermer();\n};\nconst désépingler = async () => {\n  await constl.favoris.désépinglerFavori({idObjet: props.idNuee});\n};\n\n// Fermer\nconst fermer = () => {\n  dialogue.value = false;\n  enProgrès.value = false;\n};\n</script>\n","<template>\n  <base-carte-objet\n    :id=\"id\"\n    :noms=\"noms\"\n    :descriptions=\"descriptions\"\n    :auteurs=\"auteurs\"\n    :fichiers-epinglables=\"true\"\n    @ajuster-noms=\"nms => ajusterNoms(nms)\"\n    @ajuster-descriptions=\"descrs => ajusterDescriptions(descrs)\"\n    @effacer=\"() => effacerNuée()\"\n  >\n    <template #activator=\"{props: propsActivateur}\">\n      <slot\n        name=\"activator\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <template #epingler=\"{activateur, epingle}\">\n      <epingler-nuee :id-nuee=\"id\">\n        <template #activator=\"{props: propsActivateur}\">\n          <component\n            :is=\"activateur\"\n            v-bind=\"propsActivateur\"\n            :id=\"id\"\n            :epingle=\"epingle\"\n          />\n        </template>\n      </epingler-nuee>\n    </template>\n\n    <v-divider class=\"mb-2\" />\n    <div class=\"text-center\">\n      <v-btn\n        variant=\"outlined\"\n        append-icon=\"mdi-open-in-new\"\n        @click=\"$router.push(encodeURI(`/données/nuée/${encodeURIComponent(id)}`))\"\n      >\n        {{ t('nuées.carteNuée.ouvrirNuée') }}\n      </v-btn>\n    </div>\n  </base-carte-objet>\n</template>\n<script setup lang=\"ts\">\nimport {suivre} from '@constl/vue';\nimport {மொழியாக்கத்தைப்_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport {utiliserConstellation} from '/@/components/utils';\n\nimport {computed} from 'vue';\nimport BaseCarteObjet from '/@/components/communs/BaseCarteObjet.vue';\nimport EpinglerNuee from '/@/components/épingles/ÉpinglerNuée.vue';\nimport {ajusterTexteTraductible} from '/@/utils';\n\nconst props = defineProps<{id: string}>();\n\nconst constl = utiliserConstellation();\n\nconst {$மொ: t} = மொழியாக்கத்தைப்_பயன்படுத்து();\n\n// Nom de la nuée\nconst noms = suivre(constl.nuées.suivreNomsNuée, {idNuée: computed(() => props.id)}, {});\n\nconst ajusterNoms = async (nms: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({anciennes: noms.value, nouvelles: nms});\n  for (const langue of àEffacer) {\n    await constl.nuées.effacerNomNuée({idNuée: props.id, langue});\n  }\n  await constl.nuées.sauvegarderNomsNuée({\n    idNuée: props.id,\n    noms: àAjouter,\n  });\n};\n\n// Descriptions nuée\nconst descriptions = suivre(\n  constl.nuées.suivreDescriptionsNuée,\n  {idNuée: computed(() => props.id)},\n  {},\n);\n\nconst ajusterDescriptions = async (descrs: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({\n    anciennes: descriptions.value,\n    nouvelles: descrs,\n  });\n  for (const langue of àEffacer) {\n    await constl.nuées.effacerDescriptionNuée({idNuée: props.id, langue});\n  }\n  await constl.nuées.sauvegarderDescriptionsNuée({\n    idNuée: props.id,\n    descriptions: àAjouter,\n  });\n};\n\n// Auteurs\nconst auteurs = suivre(constl.réseau.suivreAuteursBd, {idBd: computed(() => props.id)});\n\n// Effacer\nconst effacerNuée = async () => {\n  await constl.nuées.effacerNuée({idNuée: props.id});\n};\n</script>\n"],"names":["props","__props","constl","utiliserConstellation","mdAndUp","useDisplay","t","மொழியாக்கத்தைப்_பயன்படுத்து","dialogue","ref","optionsAvancées","épingle","suivre","computed","sélectionBase","dispositifsBase","spécifiquesBase","baseValide","baseModifié","optionsDispositifs","sélectionBds","dispositifsBds","spécifiquesBds","bdsValide","bdsModifié","sélectionTableaux","dispositifsTableaux","spécifiquesTableaux","tableauxValide","tableauxModifié","sélectionFichiersTableaux","dispositifsFichiersTableaux","spécifiquesFichiersTableaux","fichiersTableauxValide","fichiersTableauxModifié","prêtÀÉpingler","valeursChangées","enProgrès","épingler","désépingler","fermer","noms","ajusterNoms","nms","àEffacer","àAjouter","ajusterTexteTraductible","langue","descriptions","ajusterDescriptions","descrs","auteurs","effacerNuée"],"mappings":"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"}
import{q as $,h as i,d as M,p as B,க as E,r as x,o as ue,cp as le,c as w,a as v,M as T,w as t,F,b as e,j as N,f as g,t as C,G as te,dr as re,n as P,ct as ce,v as me,A,aW as z,a8 as de,bH as pe,ds as fe,a1 as ee,K as U,dt as O,au as ve,Q as R,s as L,du as _e,x as G,i as H,e as J,y as se,m as X,aM as I,R as ae,ao as ye,V as K,H as Q,I as W,J as Y,c3 as Ve,bR as xe,X as ie,aC as ge,aG as be,z as qe,N as $e}from"./index-DawdXn0w.js";import{o as we}from"./action-CQtJGdH7.js";import{g as ne,_ as ke,a as Ce,b as je,h as De,i as Fe,j as Se,c as Ue,d as he,f as Ae,e as Te}from"./NouvelleImportation.vue_vue_type_script_setup_true_lang-CSAdPnZA.js";import{a as Me}from"./index-CPq-XPYv.js";import{_ as Ee}from"./TitrePage.vue_vue_type_script_setup_true_lang-DKOHNFOD.js";import"./SélecteurNuée.vue_vue_type_script_setup_true_lang-DVanH00p.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-BJYPmQYN.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-C709jdKo.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-CMspVejb.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-APcxl9oW.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-3P36EM7C.js";const Ne=()=>{const b=Me();return p=>{const l=i(p),o=$(()=>l?b.value.getTime()-l:void 0);return $(()=>{if(o.value!==void 0){const s=Math.abs(o.value),n=o.value<0?-1:1;return s<1e3?{unité:"millisecondes",n:s*n}:s<1e3*60?{unité:"secondes",n:Math.floor(s/1e3)*n}:s<1e3*60*60?{unité:"minutes",n:Math.floor(s/(1e3*60))*n}:s<1e3*60*60*24?{unité:"heures",n:Math.floor(s/(1e3*60*60))*n}:s<1e3*60*60*24*7?{unité:"jours",n:Math.floor(s/(1e3*60*60*24))*n}:s<1e3*60*60*24*30?{unité:"semaines",n:Math.floor(s/(1e3*60*60*24*7))*n}:s<1e3*60*60*24*365.25?{unité:"mois",n:Math.floor(s/(1e3*60*60*24*30))*n}:{unité:"années",n:Math.floor(s/(1e3*60*60*24*365.25))*n}}})}},Ie=({t:b,clefs:p={dans:{millisecondes:"communs.temps.dans.ms",secondes:"communs.temps.dans.secondes",minutes:"communs.temps.dans.minutes",heures:"communs.temps.dans.heures",jours:"communs.temps.dans.jours",semaines:"communs.temps.dans.semaines",mois:"communs.temps.dans.mois",années:"communs.temps.dans.années"},depuis:{millisecondes:"communs.temps.depuis.ms",secondes:"communs.temps.depuis.secondes",minutes:"communs.temps.depuis.minutes",heures:"communs.temps.depuis.heures",jours:"communs.temps.depuis.jours",semaines:"communs.temps.depuis.semaines",mois:"communs.temps.depuis.mois",années:"communs.temps.depuis.années"}}})=>{const l=Ne();return o=>{const a=l(o);return $(()=>{if(a.value)return b(p[a.value.n<0?"dans":"depuis"][a.value.unité],{n:Math.abs(a.value.n)})})}},Be=M({__name:"ItemStatutAutomatisation",props:{statut:{},spécification:{}},setup(b){const p=B(),{மொழியாக்கம்_பயன்படுத்து:l}=E(),{$மொ:o}=l(),a=Ie({t:o}),s=b,n=$(()=>{switch(s.statut.type){case"erreur":return{icône:"mdi-alert",couleur:"error"};case"programmée":return{icône:"mdi-check",couleur:"success"};case"sync":return{icône:"mdi-sync",couleur:"primary"};case"écoute":return{icône:"",couleur:"success"};default:throw new Error(JSON.stringify(s.statut))}}),r=x(new Date().getTime());let _;ue(()=>{_=window.setInterval(()=>r.value=new Date().getTime(),1e3)}),le(()=>{_&&clearInterval(_)});const c=async()=>{},f=a($(()=>s.statut.type==="programmée"?s.statut.à:s.statut.type==="erreur"?s.statut.prochaineProgramméeÀ:void 0)),j=a($(()=>s.statut.type==="sync"?s.statut.depuis:void 0)),q=$(()=>{switch(s.statut.type){case"écoute":return"automatisations.jetonStatut.écoute";case"sync":return o("automatisations.jetonStatut.sync",{depuis:j.value});case"programmée":return o("automatisations.jetonStatut.programmée",{dans:f.value});case"erreur":return s.statut.prochaineProgramméeÀ?o("automatisations.jetonStatut.erreurRéssayer",{dans:f.value}):"automatisations.jetonStatut.erreur";default:throw new Error(s.statut)}}),h=async()=>await p.automatisations.lancerManuellement({id:s.spécification.id});return(D,m)=>(v(),w(T,{title:"Ce dispositif"},{prepend:t(()=>[e(te,{start:"",color:n.value.couleur},{default:t(()=>[g(C(n.value.icône),1)]),_:1},8,["color"])]),subtitle:t(()=>[g(C(i(o)(q.value)),1)]),default:t(()=>[D.spécification?.type==="exportation"?(v(),w(ne,{key:0,class:"my-2",spécification:D.spécification,onClick:m[0]||(m[0]=()=>c())},null,8,["spécification"])):F("",!0),e(N,{class:"my-2",size:"small",variant:"outlined","append-icon":"mdi-refresh",onClick:h},{default:t(()=>m[1]||(m[1]=[g(' "Relancer" ')])),_:1})]),_:1}))}}),Pe={key:0},ze={key:0,class:"d-flex"},Oe={key:0,class:"d-flex mb-4"},Re=M({__name:"OptionsFréquenceExportation",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(b){const p=re(b,"modelValue"),{mdAndUp:l}=P(),{மொழியாக்கம்_பயன்படுத்து:o}=E(),{$மொ:a}=o(),s=ce(),n=[{value:"manuelle",title:"automatisations.fréquence.manuelle",sélection:"automatisations.exportation.fréquence.sélection.manuelle"},{value:"dynamique",title:"automatisations.fréquence.dynamique",sélection:"automatisations.exportation.fréquence.sélection.dynamique"},{value:"fixe",title:"automatisations.fréquence.fixe",sélection:"automatisations.exportation.fréquence.sélection.fixe"}],r=x(O?"manuelle":"fixe"),_=x(p.value?.type==="fixe"?p.value.détails.n.toString():"1"),c=$(()=>s.எண்ணுக்கு({உரை:_.value})),f=x("jours"),j=["années","mois","semaines","jours","heures","minutes","secondes","millisecondes"],q=m=>{try{return s.எண்ணுக்கு({உரை:m}),!0}catch{return a("règles.numérique")}},h=m=>(m|0)===m,D=()=>c.value!==void 0&&c.value>0&&h(c.value)?!0:a("règles.nombreEntierPositif");return me(()=>{switch(r.value){case"manuelle":{const m={type:"manuelle"};p.value=m;break}case"dynamique":{const m={type:"dynamique"};p.value=m;break}case"fixe":{const m={type:"fixe",détails:{unités:f.value,n:c.value}};p.value=m;break}}}),(m,V)=>(v(),A(R,null,[e(z,{modelValue:r.value,"onUpdate:modelValue":V[2]||(V[2]=u=>r.value=u),class:de(i(l)?["mb-4"]:["mb-2"]),items:n,variant:"outlined",density:"compact","hide-details":""},pe({item:t(({props:u,item:k})=>[e(T,U({...u,title:i(a)(k.title)},{disabled:i(O)&&(k.value==="manuelle"||k.value==="dynamique")}),{default:t(()=>[i(O)&&(k.value==="manuelle"||k.value==="dynamique")?(v(),A("span",Pe,[e(te,{size:"small",start:""},{default:t(()=>V[5]||(V[5]=[g(" mdi-alert-outline ")])),_:1}),g(" "+C(i(a)("automatisations.fréquence.pasSurNavig")),1)])):F("",!0)]),_:2},1040,["disabled"])]),selection:t(({item:u})=>[g(C(i(a)(u.raw.sélection)),1)]),_:2},[i(l)?{name:"append",fn:t(()=>[e(fe,null,{default:t(()=>[r.value==="fixe"?(v(),A("div",ze,[e(ee,{modelValue:_.value,"onUpdate:modelValue":V[0]||(V[0]=u=>_.value=u),variant:"outlined",density:"compact","hide-details":"",rules:[q,D]},null,8,["modelValue","rules"]),e(z,{modelValue:f.value,"onUpdate:modelValue":V[1]||(V[1]=u=>f.value=u),items:j,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:u})=>[g(C(i(a)(`automatisations.fréquence.unités.${u.raw}`)),1)]),item:t(({item:u,props:k})=>[e(T,U(k,{title:i(a)(`automatisations.fréquence.unités.${u.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):F("",!0)]),_:1})]),key:"0"}:void 0]),1032,["modelValue","class"]),i(l)?F("",!0):(v(),w(ve,{key:0},{default:t(()=>[r.value==="fixe"?(v(),A("div",Oe,[e(ee,{modelValue:_.value,"onUpdate:modelValue":V[3]||(V[3]=u=>_.value=u),variant:"outlined",density:"compact","hide-details":"",rules:[q,D]},null,8,["modelValue","rules"]),e(z,{modelValue:f.value,"onUpdate:modelValue":V[4]||(V[4]=u=>f.value=u),items:j,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:u})=>[g(C(i(a)(`automatisations.fréquence.unités.${u.raw}`)),1)]),item:t(({item:u,props:k})=>[e(T,U(k,{title:i(a)(`automatisations.fréquence.unités.${u.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):F("",!0)]),_:1}))],64))}}),Le=M({__name:"CarteAutomatisationExportation",props:{spécification:{},objetModifiable:{type:Boolean}},setup(b){const{மொழியாக்கம்_பயன்படுத்து:p}=E(),{$மொ:l}=p(),{mdAndUp:o}=P(),a=b,s=B(),n=x(!1),r=we(s.obtIdDispositif),_=L(s.automatisations.suivreÉtatAutomatisations),c=$(()=>_.value?.[a.spécification.id]),f=x(a.spécification.langues),j=x(a.spécification.dossier),q=x(a.spécification.fréquence),h=x(a.spécification.formatDoc),D=x(a.spécification.inclureDocuments),m=x(a.spécification.copies),V=x(a.spécification.dispositifs),u=$(()=>({id:a.spécification.id,type:"exportation",fréquence:q.value,idObjet:a.spécification.idObjet,typeObjet:a.spécification.typeObjet,formatDoc:h.value,dossier:j.value,langues:f.value,dispositifs:V.value,inclureDocuments:D.value,copies:m.value})),k=async()=>{const S=await Ve();S&&(j.value=S)},Z=$(()=>!_e(u.value,a.spécification)),oe=async()=>{Z.value&&await s.automatisations.modifierAutomatisation({id:a.spécification.id,automatisation:u.value})};return(S,d)=>(v(),w(G,{modelValue:n.value,"onUpdate:modelValue":d[9]||(d[9]=y=>n.value=y)},{activator:t(({props:y})=>[Q(S.$slots,"activator",W(Y({props:y})))]),default:t(()=>[e(K,{class:"mx-auto","max-width":i(o)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,{class:"d-flex"},{default:t(()=>[g(C(i(l)("automatisations.exportation.titreCarte"))+" ",1),e(se),e(N,{icon:"mdi-close",size:"small",variant:"flat",onClick:d[0]||(d[0]=y=>n.value=!1)})]),_:1})]),_:1}),e(X,{style:{"overflow-y":"scroll"}},{default:t(()=>[e(I,{titre:i(l)("automatisations.exportation.sousSections.statut"),"en-attente":!1},null,8,["titre"]),c.value?(v(),w(Be,{key:0,statut:c.value,spécification:S.spécification},null,8,["statut","spécification"])):F("",!0),i(r)&&S.spécification.dispositifs.includes(i(r))?(v(),w(ne,{key:1,class:"my-2",spécification:S.spécification,onClick:d[1]||(d[1]=()=>k())},null,8,["spécification"])):F("",!0),e(I,{titre:i(l)("automatisations.exportation.sousSections.format"),"en-attente":!1},null,8,["titre"]),e(ke,{modelValue:h.value,"onUpdate:modelValue":d[2]||(d[2]=y=>h.value=y)},null,8,["modelValue"]),e(Ce,{modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=y=>f.value=y)},null,8,["modelValue"]),e(je,{modelValue:D.value,"onUpdate:modelValue":d[4]||(d[4]=y=>D.value=y)},null,8,["modelValue"]),e(I,{titre:i(l)("automatisations.exportation.sousSections.fréquence"),"en-attente":!1},null,8,["titre"]),e(Re,{modelValue:q.value,"onUpdate:modelValue":d[5]||(d[5]=y=>q.value=y)},null,8,["modelValue"]),e(De,{modelValue:m.value,"onUpdate:modelValue":d[6]||(d[6]=y=>m.value=y)},null,8,["modelValue"])]),_:1}),e(ae),e(ye,null,{default:t(()=>[e(N,{variant:"outlined",onClick:d[7]||(d[7]=y=>n.value=!1)},{default:t(()=>[g(C(i(l)("communs.annuler")),1)]),_:1}),e(N,{disabled:!Z.value,color:"primary",variant:"outlined",onClick:d[8]||(d[8]=()=>oe())},{default:t(()=>[g(C(i(l)("communs.sauvegarder")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ge=M({__name:"CarteAutomatisationImportation",props:{specification:{}},setup(b){const{மொழியாக்கம்_பயன்படுத்து:p}=E(),{$மொ:l}=p(),{mdAndUp:o}=P(),a=b,s=B(),n=x(!1),r=L(s.automatisations.suivreÉtatAutomatisations),_=$(()=>r.value?.[a.specification.id]);return(c,f)=>{const j=xe("nom-tableau");return v(),w(G,{modelValue:n.value,"onUpdate:modelValue":f[0]||(f[0]=q=>n.value=q)},{activator:t(({props:q})=>[Q(c.$slots,"activator",W(Y({props:q})))]),default:t(()=>[e(K,{class:"mx-auto","max-width":i(o)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,null,{default:t(()=>[e(j,{"id-tableau":c.specification.idTableau},null,8,["id-tableau"])]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(I,{titre:i(l)("automatisations.statut"),"en-attente":!1},null,8,["titre"]),_.value?(v(),w(Fe,{key:0,statut:_.value},null,8,["statut"])):F("",!0),e(Se,{spécification:c.specification},null,8,["spécification"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"])}}}),He=M({__name:"NouvelleAutomatisation",setup(b){const{மொழியாக்கம்_பயன்படுத்து:p}=E(),{$மொ:l}=p(),{mdAndUp:o}=P(),a=x(!1);return(s,n)=>(v(),w(G,{modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=r=>a.value=r)},{activator:t(({props:r})=>[Q(s.$slots,"activator",W(Y({props:r})))]),default:t(()=>[e(K,{class:"mx-auto","max-width":i(o)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,{class:"d-flex"},{default:t(()=>[g(C(i(l)(""))+" Ajout d'automatisation ",1),e(se),e(N,{icon:"mdi-close",size:"small",variant:"flat",onClick:n[0]||(n[0]=r=>a.value=!1)})]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(ie,null,{default:t(()=>[e(Ue,null,{activator:t(({props:r})=>[e(T,U({"prepend-icon":"mdi-import"},r),{default:t(()=>n[2]||(n[2]=[g(" Importer ")])),_:2},1040)]),_:1}),e(he,null,{activator:t(({props:r})=>[e(T,U({"prepend-icon":"mdi-export"},r),{default:t(()=>n[3]||(n[3]=[g(" Exporter ")])),_:2},1040)]),_:1})]),_:1})]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Je={key:0},Xe={class:"my-6 text-center text-h5 text-disabled"},ot=M({__name:"PageAutomatisations",setup(b){const p=B(),{மொழியாக்கம்_பயன்படுத்து:l}=E(),{$மொ:o}=l(),{obtImageDéco:a}=ge(),s=a("automatisation"),n=L(p.automatisations.suivreAutomatisations);return(r,_)=>(v(),w(be,{class:"text-center"},{default:t(()=>[e(Ee,{titre:i(o)("pages.automatisations.titre"),image:i(s),"sous-titre":i(o)("pages.automatisations.sousTitre")},null,8,["titre","image","sous-titre"]),e(ie,{class:"text-start"},{default:t(()=>[e(He,{automatiser:""},{activator:t(({props:c})=>[e(T,U(c,{"prepend-icon":"mdi-plus",title:i(o)("pages.automatisations.ajouterNouvelle.titre"),subtitle:i(o)("pages.automatisations.ajouterNouvelle.sousTitre")}),null,16,["title","subtitle"])]),_:1}),e(ae),i(n)?.length?F("",!0):(v(),A("div",Je,[qe("p",Xe,C(i(o)("pages.automatisations.aucune")),1)])),(v(!0),A(R,null,$e(i(n),c=>(v(),A(R,{key:c.id},[c.type==="exportation"?(v(),w(Le,{key:0,spécification:c,"objet-modifiable":""},{activator:t(({props:f})=>[e(Ae,U({ref_for:!0},f,{specification:c}),null,16,["specification"])]),_:2},1032,["spécification"])):(v(),w(Ge,{key:1,specification:c,"objet-modifiable":""},{activator:t(({props:f})=>[e(Te,U({ref_for:!0},f,{specification:c}),null,16,["specification"])]),_:2},1032,["specification"]))],64))),128))]),_:1})]),_:1}))}});export{ot as default};
//# sourceMappingURL=PageAutomatisations-B0rwl7VG.js.map

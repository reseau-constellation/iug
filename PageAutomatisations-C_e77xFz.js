import{q,h as i,d as T,p as N,ம as M,r as y,o as oe,cU as ue,c as $,a as f,M as A,w as t,F as C,b as e,j as O,f as b,t as D,G as ee,dU as le,n as I,cY as re,v as ce,A as h,aX as B,a8 as me,c8 as de,dV as pe,a1 as Z,K as F,dW as P,as as fe,Q as z,s as R,dX as ve,x as X,i as L,e as G,y as te,m as J,aM as E,R as se,aj as _e,ak as Ve,al as ye,V as Y,H,I as K,J as Q,cB as xe,dY as ge,X as ae,aC as be,aG as qe,z as $e,N as we}from"./index-DmhVm2_I.js";import{o as ke}from"./action-RGdhEoBZ.js";import{h as ie,d as je,e as Ce,f as De,i as Ue,j as Fe,k as Se,_ as he,a as Ae,c as Te,b as Me}from"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-DFNMzfzQ.js";import{u as Ee}from"./index-CSNeZlHD.js";import{_ as Ne}from"./TitrePage.vue_vue_type_script_setup_true_lang-C9_SU_nk.js";import"./SélecteurNuée.vue_vue_type_script_setup_true_lang-D4ouBfl-.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-Y01fFULe.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-BvhOG62x.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-CuMCRq-i.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-CzcSnYmM.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-BUkzT0nZ.js";const Ie=()=>{const x=Ee();return r=>{const u=i(r),s=q(()=>u?x.value.getTime()-u:void 0);return q(()=>{if(s.value!==void 0){const a=Math.abs(s.value),o=s.value<0?-1:1;return a<1e3?{unité:"millisecondes",n:a*o}:a<1e3*60?{unité:"secondes",n:Math.floor(a/1e3)*o}:a<1e3*60*60?{unité:"minutes",n:Math.floor(a/(1e3*60))*o}:a<1e3*60*60*24?{unité:"heures",n:Math.floor(a/(1e3*60*60))*o}:a<1e3*60*60*24*7?{unité:"jours",n:Math.floor(a/(1e3*60*60*24))*o}:a<1e3*60*60*24*30?{unité:"semaines",n:Math.floor(a/(1e3*60*60*24*7))*o}:a<1e3*60*60*24*365.25?{unité:"mois",n:Math.floor(a/(1e3*60*60*24*30))*o}:{unité:"années",n:Math.floor(a/(1e3*60*60*24*365.25))*o}}})}},Be=({t:x,clefs:r={dans:{millisecondes:"communs.temps.dans.ms",secondes:"communs.temps.dans.secondes",minutes:"communs.temps.dans.minutes",heures:"communs.temps.dans.heures",jours:"communs.temps.dans.jours",semaines:"communs.temps.dans.semaines",mois:"communs.temps.dans.mois",années:"communs.temps.dans.années"},depuis:{millisecondes:"communs.temps.depuis.ms",secondes:"communs.temps.depuis.secondes",minutes:"communs.temps.depuis.minutes",heures:"communs.temps.depuis.heures",jours:"communs.temps.depuis.jours",semaines:"communs.temps.depuis.semaines",mois:"communs.temps.depuis.mois",années:"communs.temps.depuis.années"}}})=>{const u=Ie();return s=>{const n=u(s);return q(()=>{if(n.value)return x(r[n.value.n<0?"dans":"depuis"][n.value.unité],{n:Math.abs(n.value.n)})})}},Pe=T({__name:"ItemStatutAutomatisation",props:{statut:{},spécification:{}},setup(x){const r=N(),{$மொ:u}=M(),s=Be({t:u}),n=x,a=q(()=>{switch(n.statut.type){case"erreur":return{icône:"mdi-alert",couleur:"error"};case"programmée":return{icône:"mdi-check",couleur:"success"};case"sync":return{icône:"mdi-sync",couleur:"primary"};case"écoute":return{icône:"",couleur:"success"};default:throw new Error(JSON.stringify(n.statut))}}),o=y(new Date().getTime());let v;oe(()=>{v=window.setInterval(()=>o.value=new Date().getTime(),1e3)}),ue(()=>{v&&clearInterval(v)});const c=async()=>{},p=s(q(()=>n.statut.type==="programmée"?n.statut.à:n.statut.type==="erreur"?n.statut.prochaineProgramméeÀ:void 0)),k=s(q(()=>n.statut.type==="sync"?n.statut.depuis:void 0)),g=q(()=>{switch(n.statut.type){case"écoute":return"automatisations.jetonStatut.écoute";case"sync":return u("automatisations.jetonStatut.sync",{depuis:k.value});case"programmée":return u("automatisations.jetonStatut.programmée",{dans:p.value});case"erreur":return n.statut.prochaineProgramméeÀ?u("automatisations.jetonStatut.erreurRéssayer",{dans:p.value}):"automatisations.jetonStatut.erreur";default:throw new Error(n.statut)}}),S=async()=>await r.automatisations.lancerManuellement({id:n.spécification.id});return(j,m)=>(f(),$(A,{title:"Ce dispositif"},{prepend:t(()=>[e(ee,{start:"",color:a.value.couleur},{default:t(()=>[b(D(a.value.icône),1)]),_:1},8,["color"])]),subtitle:t(()=>[b(D(i(u)(g.value)),1)]),default:t(()=>[j.spécification?.type==="exportation"?(f(),$(ie,{key:0,class:"my-2",spécification:j.spécification,onClick:m[0]||(m[0]=()=>c())},null,8,["spécification"])):C("",!0),e(O,{class:"my-2",size:"small",variant:"outlined","append-icon":"mdi-refresh",onClick:S},{default:t(()=>m[1]||(m[1]=[b(' "Relancer" ',-1)])),_:1,__:[1]})]),_:1}))}}),ze={key:0},Oe={key:0,class:"d-flex"},Re={key:0,class:"d-flex mb-4"},Xe=T({__name:"OptionsFréquenceExportation",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const r=le(x,"modelValue"),{mdAndUp:u}=I(),{$மொ:s}=M(),n=re(),a=[{value:"manuelle",title:"automatisations.fréquence.manuelle",sélection:"automatisations.exportation.fréquence.sélection.manuelle"},{value:"dynamique",title:"automatisations.fréquence.dynamique",sélection:"automatisations.exportation.fréquence.sélection.dynamique"},{value:"fixe",title:"automatisations.fréquence.fixe",sélection:"automatisations.exportation.fréquence.sélection.fixe"}],o=y(P?"manuelle":"fixe"),v=y(r.value?.type==="fixe"?r.value.détails.n.toString():"1"),c=q(()=>n.எண்ணுக்கு({உரை:v.value})),p=y("jours"),k=["années","mois","semaines","jours","heures","minutes","secondes","millisecondes"],g=m=>{try{return n.எண்ணுக்கு({உரை:m}),!0}catch{return s("règles.numérique")}},S=m=>(m|0)===m,j=()=>c.value!==void 0&&c.value>0&&S(c.value)?!0:s("règles.nombreEntierPositif");return ce(()=>{switch(o.value){case"manuelle":{const m={type:"manuelle"};r.value=m;break}case"dynamique":{const m={type:"dynamique"};r.value=m;break}case"fixe":{const m={type:"fixe",détails:{unités:p.value,n:c.value}};r.value=m;break}}}),(m,V)=>(f(),h(z,null,[e(B,{modelValue:o.value,"onUpdate:modelValue":V[2]||(V[2]=l=>o.value=l),class:me(i(u)?["mb-4"]:["mb-2"]),items:a,variant:"outlined",density:"compact","hide-details":""},de({item:t(({props:l,item:w})=>[e(A,F({...l,title:i(s)(w.title)},{disabled:i(P)&&(w.value==="manuelle"||w.value==="dynamique")}),{default:t(()=>[i(P)&&(w.value==="manuelle"||w.value==="dynamique")?(f(),h("span",ze,[e(ee,{size:"small",start:""},{default:t(()=>V[5]||(V[5]=[b(" mdi-alert-outline ",-1)])),_:1,__:[5]}),b(" "+D(i(s)("automatisations.fréquence.pasSurNavig")),1)])):C("",!0)]),_:2},1040,["disabled"])]),selection:t(({item:l})=>[b(D(i(s)(l.raw.sélection)),1)]),_:2},[i(u)?{name:"append",fn:t(()=>[e(pe,null,{default:t(()=>[o.value==="fixe"?(f(),h("div",Oe,[e(Z,{modelValue:v.value,"onUpdate:modelValue":V[0]||(V[0]=l=>v.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,j]},null,8,["modelValue","rules"]),e(B,{modelValue:p.value,"onUpdate:modelValue":V[1]||(V[1]=l=>p.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(D(i(s)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(A,F(w,{title:i(s)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):C("",!0)]),_:1})]),key:"0"}:void 0]),1032,["modelValue","class"]),i(u)?C("",!0):(f(),$(fe,{key:0},{default:t(()=>[o.value==="fixe"?(f(),h("div",Re,[e(Z,{modelValue:v.value,"onUpdate:modelValue":V[3]||(V[3]=l=>v.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,j]},null,8,["modelValue","rules"]),e(B,{modelValue:p.value,"onUpdate:modelValue":V[4]||(V[4]=l=>p.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(D(i(s)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(A,F(w,{title:i(s)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):C("",!0)]),_:1}))],64))}}),Le=T({__name:"CarteAutomatisationExportation",props:{spécification:{},objetModifiable:{type:Boolean}},setup(x){const{$மொ:r}=M(),{mdAndUp:u}=I(),s=x,n=N(),a=y(!1),o=ke(n.obtIdDispositif),v=R(n.automatisations.suivreÉtatAutomatisations),c=q(()=>v.value?.[s.spécification.id]),p=y(s.spécification.langues),k=y(s.spécification.dossier),g=y(s.spécification.fréquence),S=y(s.spécification.formatDoc),j=y(s.spécification.inclureDocuments),m=y(s.spécification.copies),V=y(s.spécification.dispositifs),l=q(()=>({id:s.spécification.id,type:"exportation",fréquence:g.value,idObjet:s.spécification.idObjet,typeObjet:s.spécification.typeObjet,formatDoc:S.value,dossier:k.value,langues:p.value,dispositifs:V.value,inclureDocuments:j.value,copies:m.value})),w=async()=>{const U=await xe();U&&(k.value=U)},W=q(()=>!ve(l.value,s.spécification)),ne=async()=>{W.value&&await n.automatisations.modifierAutomatisation({id:s.spécification.id,automatisation:l.value})};return(U,d)=>(f(),$(X,{modelValue:a.value,"onUpdate:modelValue":d[9]||(d[9]=_=>a.value=_)},{activator:t(({props:_})=>[H(U.$slots,"activateur",K(Q({props:_})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,{class:"d-flex align-center"},{default:t(()=>[b(D(i(r)("automatisations.exportation.titreCarte"))+" ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:d[0]||(d[0]=_=>a.value=!1)})]),_:1})]),_:1}),e(J,{style:{"overflow-y":"scroll"}},{default:t(()=>[e(E,{titre:i(r)("automatisations.exportation.sousSections.statut")},null,8,["titre"]),c.value?(f(),$(Pe,{key:0,statut:c.value,spécification:U.spécification},null,8,["statut","spécification"])):C("",!0),i(o)&&U.spécification.dispositifs.includes(i(o))?(f(),$(ie,{key:1,class:"my-2",spécification:U.spécification,onClick:d[1]||(d[1]=()=>w())},null,8,["spécification"])):C("",!0),e(E,{titre:i(r)("automatisations.exportation.sousSections.format")},null,8,["titre"]),e(je,{modelValue:S.value,"onUpdate:modelValue":d[2]||(d[2]=_=>S.value=_)},null,8,["modelValue"]),e(Ce,{modelValue:p.value,"onUpdate:modelValue":d[3]||(d[3]=_=>p.value=_)},null,8,["modelValue"]),e(De,{modelValue:j.value,"onUpdate:modelValue":d[4]||(d[4]=_=>j.value=_)},null,8,["modelValue"]),e(E,{titre:i(r)("automatisations.exportation.sousSections.fréquence")},null,8,["titre"]),e(Xe,{modelValue:g.value,"onUpdate:modelValue":d[5]||(d[5]=_=>g.value=_)},null,8,["modelValue"]),e(Ue,{modelValue:m.value,"onUpdate:modelValue":d[6]||(d[6]=_=>m.value=_)},null,8,["modelValue"])]),_:1}),e(se),e(_e,null,{default:t(()=>[e(Ve,{onClick:d[7]||(d[7]=_=>a.value=!1)}),e(ye,{actif:W.value,onClick:d[8]||(d[8]=()=>ne())},null,8,["actif"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ge=T({__name:"CarteAutomatisationImportation",props:{specification:{}},setup(x){const{$மொ:r}=M(),{mdAndUp:u}=I(),s=x,n=N(),a=y(!1),o=R(n.automatisations.suivreÉtatAutomatisations),v=q(()=>o.value?.[s.specification.id]);return(c,p)=>{const k=ge("nom-tableau");return f(),$(X,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=g=>a.value=g)},{activator:t(({props:g})=>[H(c.$slots,"activateur",K(Q({props:g})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,null,{default:t(()=>[e(k,{"id-tableau":c.specification.idTableau},null,8,["id-tableau"])]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(E,{titre:i(r)("automatisations.statut")},null,8,["titre"]),v.value?(f(),$(Fe,{key:0,statut:v.value},null,8,["statut"])):C("",!0),e(Se,{spécification:c.specification},null,8,["spécification"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"])}}}),Je=T({__name:"NouvelleAutomatisation",setup(x){const{$மொ:r}=M(),{mdAndUp:u}=I(),s=y(!1);return(n,a)=>(f(),$(X,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=o=>s.value=o)},{activator:t(({props:o})=>[H(n.$slots,"activateur",K(Q({props:o})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,{class:"d-flex align-center"},{default:t(()=>[b(D(i(r)(""))+" Ajout d'automatisation ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:a[0]||(a[0]=o=>s.value=!1)})]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(ae,null,{default:t(()=>[e(he,null,{activateur:t(({props:o})=>[e(A,F({"prepend-icon":"mdi-import"},o),{default:t(()=>a[2]||(a[2]=[b(" Importer ",-1)])),_:2,__:[2]},1040)]),_:1}),e(Ae,null,{activateur:t(({props:o})=>[e(A,F({"prepend-icon":"mdi-export"},o),{default:t(()=>a[3]||(a[3]=[b(" Exporter ",-1)])),_:2,__:[3]},1040)]),_:1})]),_:1})]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ye={key:0},He={class:"my-6 text-center text-h5 text-disabled"},ut=T({__name:"PageAutomatisations",setup(x){const r=N(),{$மொ:u}=M(),{obtImageDéco:s}=be(),n=s("automatisation"),a=R(r.automatisations.suivreAutomatisations);return(o,v)=>(f(),$(qe,{class:"text-center"},{default:t(()=>[e(Ne,{titre:i(u)("pages.automatisations.titre"),image:i(n),"sous-titre":i(u)("pages.automatisations.sousTitre")},null,8,["titre","image","sous-titre"]),e(ae,{class:"text-start"},{default:t(()=>[e(Je,{automatiser:""},{activateur:t(({props:c})=>[e(A,F(c,{"prepend-icon":"mdi-plus",title:i(u)("pages.automatisations.ajouterNouvelle.titre"),subtitle:i(u)("pages.automatisations.ajouterNouvelle.sousTitre")}),null,16,["title","subtitle"])]),_:1}),e(se),i(a)?.length?C("",!0):(f(),h("div",Ye,[$e("p",He,D(i(u)("pages.automatisations.aucune")),1)])),(f(!0),h(z,null,we(i(a),c=>(f(),h(z,{key:c.id},[c.type==="exportation"?(f(),$(Le,{key:0,spécification:c,"objet-modifiable":""},{activateur:t(({props:p})=>[e(Te,F({ref_for:!0},p,{specification:c}),null,16,["specification"])]),_:2},1032,["spécification"])):(f(),$(Ge,{key:1,specification:c,"objet-modifiable":""},{activateur:t(({props:p})=>[e(Me,F({ref_for:!0},p,{specification:c}),null,16,["specification"])]),_:2},1032,["specification"]))],64))),128))]),_:1})]),_:1}))}});export{ut as default};
//# sourceMappingURL=PageAutomatisations-C_e77xFz.js.map

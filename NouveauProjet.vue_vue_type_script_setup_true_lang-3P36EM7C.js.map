{"version":3,"file":"NouveauProjet.vue_vue_type_script_setup_true_lang-3P36EM7C.js","sources":["../../src/components/projets/NouveauProjet.vue"],"sourcesContent":["<template>\n  <v-dialog v-model=\"dialogue\">\n    <template #activator=\"{props}\">\n      <slot\n        name=\"activator\"\n        v-bind=\"{props}\"\n      ></slot>\n    </template>\n    <v-card\n      class=\"mx-auto\"\n      :min-width=\"mdAndUp ? 750 : 300\"\n    >\n      <v-card-item>\n        <v-card-title class=\"text-h5 justify-space-between\">\n          <span>{{ t(titreCarte) }}</span>\n        </v-card-title>\n        <v-card-subtitle> {{ t(sousTitreCarte) }} </v-card-subtitle>\n      </v-card-item>\n      <v-card-text>\n        <v-window\n          v-model=\"étape\"\n          style=\"overflow-y: scroll\"\n        >\n          <v-window-item :value=\"0\">\n            <liste-noms\n              :texte-aucun-nom=\"t('communs.texteAucunNom')\"\n              :indice-langue=\"t('communs.indiceLangue')\"\n              :etiquette-nom=\"t('communs.étiquetteNom')\"\n              :indice-nom=\"t('projets.nouveau.texteIndiceNom')\"\n              :noms-initiaux=\"noms\"\n              :autorisation-modification=\"true\"\n              @ajuster-noms=\"ajusterNoms\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"1\">\n            <liste-noms\n              :texte-aucun-nom=\"t('projets.nouveau.texteAucuneDescription')\"\n              :indice-langue=\"t('communs.indiceLangue')\"\n              :etiquette-nom=\"t('projets.nouveau.texteÉtiquetteDescription')\"\n              :indice-nom=\"t('projets.nouveau.texteIndiceDescription')\"\n              :noms-initiaux=\"descriptions\"\n              :autorisation-modification=\"true\"\n              @ajuster-noms=\"ajusterDescriptions\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"2\">\n            <selecteur-mot-clef\n              multiples\n              :originaux=\"motsClefs\"\n              @selectionnee=\"ids => (motsClefs = ids)\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"3\">\n            <selecteur-bd\n              :multiples=\"false\"\n              :originales=\"bds\"\n              @selectionnee=\"ids => (bds = ids)\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"4\">\n            <div class=\"text-center\">\n              <h3 class=\"text-h6 font-weight-light mb-2\">\n                {{ t('projets.nouveau.texteCréer') }}\n              </h3>\n              <p>\n                <v-btn\n                  class=\"mt-3\"\n                  variant=\"outlined\"\n                  :loading=\"enCréation\"\n                  @click=\"() => créerProjet()\"\n                >\n                  {{ t('projets.nouveau.texteBtnCréation') }}\n                </v-btn>\n              </p>\n              <v-checkbox v-model=\"ouvrirAprèsCréation\">\n                {{ t('projets.nouveau.ouvrirAprèsCréation') }}\n              </v-checkbox>\n            </div>\n          </v-window-item>\n        </v-window>\n      </v-card-text>\n      <v-divider></v-divider>\n\n      <v-card-actions>\n        <btn-retour\n          :visible=\"retourActif.visible\"\n          :actif=\"retourActif.actif\"\n          @retour=\"retour\"\n        />\n        <v-spacer></v-spacer>\n        <btn-suivant\n          :visible=\"suivantActif.visible\"\n          :actif=\"suivantActif.actif\"\n          @suivant=\"suivant\"\n        />\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script setup lang=\"ts\">\nimport {computed, ref} from 'vue';\nimport {useDisplay} from 'vuetify';\n\nimport {கிளிமூக்கை_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport {useRouter} from 'vue-router';\nimport {utiliserConstellation} from '../utils';\nimport SelecteurBd from '/@/components/bds/SélecteurBd.vue';\nimport BtnRetour from '/@/components/communs/BtnRetour.vue';\nimport BtnSuivant from '/@/components/communs/BtnSuivant.vue';\nimport ListeNoms from '/@/components/communs/listeNoms/ListeNoms.vue';\nimport SelecteurMotClef from '/@/components/motsClefs/SélecteurMotClef.vue';\n\nconst émettre = defineEmits<{(é: 'nouveau', id: string): void}>();\n\nconst constl = utiliserConstellation();\n\nconst {மொழியாக்கம்_பயன்படுத்து} = கிளிமூக்கை_பயன்படுத்து();\nconst {$மொ: t} = மொழியாக்கம்_பயன்படுத்து();\nconst {mdAndUp} = useDisplay();\nconst router = useRouter();\n\n// Navigation\nconst dialogue = ref(false);\n\nconst étape = ref(0);\nconst listeÉtapes = ['noms', 'descriptions', 'motsClefs', 'ajouterBds', 'confirmation'] as const;\n\nconst titreCarte = computed(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return 'projet.nouveau.titreNoms';\n    case 'descriptions':\n      return 'projet.nouveau.titreDescriptions';\n    case 'motsClefs':\n      return 'projet.nouveau.titreMotsClefs';\n    case 'ajouterBds':\n      return 'projet.nouveau.titreAjouterBds';\n    case 'confirmation':\n      return 'projet.nouveau.titreConfirmation';\n    default:\n      return '';\n  }\n});\n\nconst sousTitreCarte = computed(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return 'projet.nouveau.sousTitreNoms';\n    case 'descriptions':\n      return 'projet.nouveau.sousTitreDescriptions';\n    case 'motsClefs':\n      return 'projet.nouveau.sousTitreMotsClefs';\n    case 'ajouterBds':\n      return 'projet.nouveau.sousTitreAjouterBds';\n    case 'confirmation':\n      return 'projet.nouveau.sousTitreConfirmation';\n    default:\n      return '';\n  }\n});\n\nconst suivant = () => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    default:\n      étape.value++;\n      break;\n  }\n};\n\nconst retour = () => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    default:\n      étape.value--;\n      break;\n  }\n};\n\nconst suivantActif = computed<{actif: boolean; visible: boolean}>(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return {actif: Object.keys(noms.value).length > 0, visible: true};\n    case 'confirmation':\n      return {actif: false, visible: false};\n    default:\n      return {actif: true, visible: true};\n  }\n});\n\nconst retourActif = computed<{actif: boolean; visible: boolean}>(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return {actif: false, visible: false};\n    case 'confirmation':\n      return {actif: !enCréation.value, visible: true};\n    default:\n      return {actif: true, visible: true};\n  }\n});\n\n// Noms\nconst noms = ref<{[lng: string]: string}>({});\nconst ajusterNoms = (nms: {[lng: string]: string}) => {\n  noms.value = nms;\n};\n\n// Descriptions\nconst descriptions = ref<{[lng: string]: string}>({});\nconst ajusterDescriptions = (desrc: {[lng: string]: string}) => {\n  descriptions.value = desrc;\n};\n\n// Mots-clefs\nconst motsClefs = ref<string[]>([]);\n\n// Bds\nconst bds = ref<string[]>([]);\n\n// Création\nconst ouvrirAprèsCréation = ref(false);\n\nconst enCréation = ref(false);\n\nconst créerProjet = async () => {\n  enCréation.value = true;\n\n  const idProjet = await constl.projets.créerProjet();\n  if (!idProjet) throw new Error('Projet non créé.');\n\n  await constl.projets.sauvegarderNomsProjet({\n    idProjet,\n    noms: Object.fromEntries(Object.entries(noms.value)),\n  });\n  await constl.projets.sauvegarderDescriptionsProjet({\n    idProjet,\n    descriptions: Object.fromEntries(Object.entries(descriptions.value)),\n  });\n  await constl.projets.ajouterMotsClefsProjet({idProjet, idsMotsClefs: motsClefs.value});\n  await Promise.all(\n    bds.value.map(async idBd => await constl.projets.ajouterBdProjet({idProjet, idBd})),\n  );\n\n  émettre('nouveau', idProjet);\n\n  fermer();\n  if (ouvrirAprèsCréation.value)\n    router.push(encodeURI(`/données/projet/${encodeURIComponent(idProjet)}`));\n};\n\n// Fermer\nconst fermer = () => {\n  noms.value = {};\n  descriptions.value = {};\n  motsClefs.value = [];\n  bds.value = [];\n\n  étape.value = 0;\n  enCréation.value = false;\n  dialogue.value = false;\n};\n</script>\n"],"names":["émettre","__emit","constl","utiliserConstellation","மொழியாக்கம்_பயன்படுத்து","கிளிமூக்கை_பயன்படுத்து","t","mdAndUp","useDisplay","router","useRouter","dialogue","ref","étape","listeÉtapes","titreCarte","computed","sousTitreCarte","suivant","é","retour","suivantActif","noms","retourActif","enCréation","ajusterNoms","nms","descriptions","ajusterDescriptions","desrc","motsClefs","bds","ouvrirAprèsCréation","créerProjet","idProjet","idBd","fermer"],"mappings":"ybAgHA,MAAMA,EAAUC,EAEVC,EAASC,EAAsB,EAE/B,CAAC,wBAAAC,CAAuB,EAAIC,EAAuB,EACnD,CAAC,IAAKC,CAAC,EAAIF,EAAwB,EACnC,CAAC,QAAAG,CAAO,EAAIC,EAAW,EACvBC,EAASC,EAAU,EAGnBC,EAAWC,EAAI,EAAK,EAEpBC,EAAQD,EAAI,CAAC,EACbE,EAAc,CAAC,OAAQ,eAAgB,YAAa,aAAc,cAAc,EAEhFC,EAAaC,EAAS,IAAM,CAEhC,OADUF,EAAYD,EAAM,KAAK,EACtB,CACT,IAAK,OACI,MAAA,2BACT,IAAK,eACI,MAAA,mCACT,IAAK,YACI,MAAA,gCACT,IAAK,aACI,MAAA,iCACT,IAAK,eACI,MAAA,mCACT,QACS,MAAA,EAAA,CACX,CACD,EAEKI,EAAiBD,EAAS,IAAM,CAEpC,OADUF,EAAYD,EAAM,KAAK,EACtB,CACT,IAAK,OACI,MAAA,+BACT,IAAK,eACI,MAAA,uCACT,IAAK,YACI,MAAA,oCACT,IAAK,aACI,MAAA,qCACT,IAAK,eACI,MAAA,uCACT,QACS,MAAA,EAAA,CACX,CACD,EAEKK,EAAU,IAAM,CACd,MAAAC,EAAIL,EAAYD,EAAM,KAAK,EAGvBA,EAAA,OAGZ,EAEMO,EAAS,IAAM,CACb,MAAAD,EAAIL,EAAYD,EAAM,KAAK,EAGvBA,EAAA,OAGZ,EAEMQ,EAAeL,EAA6C,IAAM,CAEtE,OADUF,EAAYD,EAAM,KAAK,EACtB,CACT,IAAK,OACI,MAAA,CAAC,MAAO,OAAO,KAAKS,EAAK,KAAK,EAAE,OAAS,EAAG,QAAS,EAAI,EAClE,IAAK,eACH,MAAO,CAAC,MAAO,GAAO,QAAS,EAAK,EACtC,QACE,MAAO,CAAC,MAAO,GAAM,QAAS,EAAI,CAAA,CACtC,CACD,EAEKC,EAAcP,EAA6C,IAAM,CAErE,OADUF,EAAYD,EAAM,KAAK,EACtB,CACT,IAAK,OACH,MAAO,CAAC,MAAO,GAAO,QAAS,EAAK,EACtC,IAAK,eACH,MAAO,CAAC,MAAO,CAACW,EAAW,MAAO,QAAS,EAAI,EACjD,QACE,MAAO,CAAC,MAAO,GAAM,QAAS,EAAI,CAAA,CACtC,CACD,EAGKF,EAAOV,EAA6B,EAAE,EACtCa,EAAeC,GAAiC,CACpDJ,EAAK,MAAQI,CACf,EAGMC,EAAef,EAA6B,EAAE,EAC9CgB,EAAuBC,GAAmC,CAC9DF,EAAa,MAAQE,CACvB,EAGMC,EAAYlB,EAAc,EAAE,EAG5BmB,EAAMnB,EAAc,EAAE,EAGtBoB,EAAsBpB,EAAI,EAAK,EAE/BY,EAAaZ,EAAI,EAAK,EAEtBqB,EAAc,SAAY,CAC9BT,EAAW,MAAQ,GAEnB,MAAMU,EAAW,MAAMhC,EAAO,QAAQ,YAAY,EAClD,GAAI,CAACgC,EAAgB,MAAA,IAAI,MAAM,kBAAkB,EAE3C,MAAAhC,EAAO,QAAQ,sBAAsB,CACzC,SAAAgC,EACA,KAAM,OAAO,YAAY,OAAO,QAAQZ,EAAK,KAAK,CAAC,CAAA,CACpD,EACK,MAAApB,EAAO,QAAQ,8BAA8B,CACjD,SAAAgC,EACA,aAAc,OAAO,YAAY,OAAO,QAAQP,EAAa,KAAK,CAAC,CAAA,CACpE,EACK,MAAAzB,EAAO,QAAQ,uBAAuB,CAAC,SAAAgC,EAAU,aAAcJ,EAAU,MAAM,EACrF,MAAM,QAAQ,IACZC,EAAI,MAAM,IAAI,MAAMI,GAAQ,MAAMjC,EAAO,QAAQ,gBAAgB,CAAC,SAAAgC,EAAU,KAAAC,CAAA,CAAK,CAAC,CACpF,EAEAnC,EAAQ,UAAWkC,CAAQ,EAEpBE,EAAA,EACHJ,EAAoB,OACtBvB,EAAO,KAAK,UAAU,mBAAmB,mBAAmByB,CAAQ,CAAC,EAAE,CAAC,CAC5E,EAGME,EAAS,IAAM,CACnBd,EAAK,MAAQ,CAAC,EACdK,EAAa,MAAQ,CAAC,EACtBG,EAAU,MAAQ,CAAC,EACnBC,EAAI,MAAQ,CAAC,EAEblB,EAAM,MAAQ,EACdW,EAAW,MAAQ,GACnBb,EAAS,MAAQ,EACnB"}
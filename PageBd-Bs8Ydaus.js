import{d as K,ம as se,p as de,s as C,q as v,c as p,a as u,w as t,f as A,b as e,t as T,h as a,R as ae,X as Be,A as F,F as $,M as Q,K as g,N as te,Q as pe,au as De,H as Ve,I as ve,J as be,n as Ee,r as I,x as Ce,V as G,i as Te,e as ke,y as W,j as V,m as _e,Z as fe,B as ee,bE as ne,bF as qe,G as J,v as Ie,bG as Je,ao as Ae,ap as Ke,aq as Xe,bH as ze,bI as Ze,bJ as Ye,aR as ea,bK as aa,am as Se,z as P,S as ta,an as oe,bL as Fe,u as ia,aD as la,o as na,aF as oa,bM as sa,aJ as da,bN as ua,a$ as ra,b0 as ca,b1 as Ne,b2 as ma,bw as Le,bx as fa,bO as pa,bP as Pe,bQ as va,bR as ba,bS as _a,a8 as ya,bT as xa,bU as ga,by as Oe,bz as Ba,bV as Ca,O as $e,a2 as Ta,b3 as ka,aI as Va,T as wa,b4 as Re,W as ja}from"./index-BRylzrLF.js";import{u as $a}from"./historiqueDocuments-R_1rErG7.js";import{_ as Ge,a as ha,t as Aa,V as Da,E as Ea,b as Ia,c as Qe,d as Sa,e as Na,f as La,g as Pa,h as Oa,i as Ra,j as Ua,k as Ue}from"./VBreadcrumbs-BnXx_V6o.js";import{_ as Ma,a as qa,b as za,c as Fa}from"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-CJelUsji.js";import{_ as Ga}from"./ChoisirStatut.vue_vue_type_script_setup_true_lang-WEtC4pXJ.js";import{a as Qa,b as he}from"./SélecteurNuée.vue_vue_type_script_setup_true_lang-DM3ruw2h.js";import{V as Ha}from"./VSwitch-Dmjl910A.js";import{V as Wa,a as Ja}from"./VTabs-DP448gb_.js";import{V as Me}from"./VSlideGroupItem-v-bmPAIh.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-C01sYIw9.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-CwJZeEUF.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-CNm-dbRr.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-DhcbDnQc.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-CVBlafbf.js";const Ka={key:0,class:"text-disabled text-h6 text-center"},Xa={key:0,class:"text-disabled text-h6 text-center"},Za=K({__name:"CarteAutomatisationsBd",props:{idBd:{}},setup(N){const s=N,{$மொ:n}=se(),f=de(),B=C(f.automatisations.suivreAutomatisations),d=C(f.bds.suivreTableauxBd,{idBd:v(()=>s.idBd)}),b=v(()=>{const w=(d.value||[]).filter(x=>x.id).map(x=>x.id);return B.value?.filter(x=>w.includes(x.type==="exportation"?x.idObjet:x.idTableau))}),E=v(()=>b.value?.filter(w=>w.type==="importation")||[]),R=v(()=>b.value?.filter(w=>w.type==="exportation")||[]);return(w,x)=>(u(),p(Ge,{"type-objet":"bd","id-objet":w.idBd},{activator:t(({props:_})=>[Ve(w.$slots,"activator",ve(be({props:_})))]),default:t(()=>[A(" "+T(a(n)("automatisations.carte.importations"))+" ",1),e(ae),e(Be,null,{default:t(()=>[e(Ma,{"id-bd":w.idBd},{activator:t(({props:_})=>[e(Q,g(_,{"prepend-icon":"mdi-upload-outline",title:a(n)("automatisations.carte.bds.ajouterImportationTableau")}),null,16,["title"])]),_:1},8,["id-bd"]),(u(!0),F(pe,null,te(E.value,_=>(u(),p(za,{key:_.id,specification:_},null,8,["specification"]))),128)),E.value.length?$("",!0):(u(),F("p",Ka,T(a(n)("automatisations.carte.bds.aucuneImportationTableau")),1))]),_:1}),A(" "+T(a(n)("automatisations.carte.bds.exportationsTableaux"))+" ",1),e(ae),e(Be,null,{default:t(()=>[e(qa,{"id-bd":w.idBd},{activator:t(({props:_})=>[e(Q,g({"prepend-icon":"mdi-download-outline"},_),{default:t(()=>[e(De,null,{default:t(()=>[A(T(a(n)("automatisations.carte.bds.ajouterExportationTableau")),1)]),_:1})]),_:2},1040)]),_:1},8,["id-bd"]),(u(!0),F(pe,null,te(R.value,_=>(u(),p(Fa,{key:_.id,specification:_},null,8,["specification"]))),128)),R.value.length?$("",!0):(u(),F("p",Xa,T(a(n)("automatisations.carte.bds.aucuneExportationTableau")),1))]),_:1})]),_:3},8,["id-objet"]))}}),Ya=K({__name:"CarteCodeBd",props:{id:{}},setup(N){const s=N,n=v(()=>({ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.bds.suivreDonnéesExportation({
  idBd: "${s.id}",
  f: monAnalyse
})
`,py:`from constellationPy import Serveur, ClientSync
    
with Serveur():
    client = ClientSync()

    données = client.bds.suivreDonnéesExportation(
      idBd="${s.id}"
    )
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "bds.suivreDonnéesExportation", 
        Dict([("idBd","${s.id}")])
    ) do résultat
        print(résultat)
    end
  end
end
`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "bds.suivreDonnéesExportation", 
      list(idBd="${s.id}")
    )
  }
)
`}));return(f,B)=>(u(),p(ha,{codes:n.value},{activator:t(({props:d})=>[Ve(f.$slots,"activator",ve(be({props:d})))]),_:3},8,["codes"]))}}),et=K({__name:"CarteQualitéBd",props:{idBd:{}},setup(N){const{mdAndUp:s}=Ee(),{$மொ:n}=se(),f=N,B=de(),d=I(!1),b=C(B.bds.suivreQualitéBd,{idBd:v(()=>f.idBd)}),E=C(B.bds.suivreLicenceBd,{idBd:v(()=>f.idBd)}),R=C(B.bds.suivreLicenceContenuBd,{idBd:v(()=>f.idBd)}),w=C(B.suivrePermission,{idObjet:v(()=>f.idBd)});return(x,_)=>(u(),p(Ce,{modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=h=>d.value=h),"max-width":a(s)?500:300},{activator:t(({props:h})=>[Ve(x.$slots,"activator",ve(be({props:h})))]),default:t(()=>[e(G,null,{default:t(()=>[e(Te,null,{default:t(()=>[e(ke,{class:"d-flex align-center"},{default:t(()=>[A(T(a(n)("bds.qualité.titre"))+" ",1),e(W),e(V,{icon:"mdi-close",size:"small",variant:"flat",onClick:_[0]||(_[0]=h=>d.value=!1)})]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Be,null,{default:t(()=>[e(Q,null,{prepend:t(()=>[e(fe,null,{default:t(()=>[e(ee,{"model-value":(a(b)?.total||0)*100,width:5,indeterminate:a(b)?.total===void 0,color:a(ne)(a(b)?.total).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>_[2]||(_[2]=[A("Score total")])),_:1}),e(ae),e(Q,null,{prepend:t(()=>[e(fe,null,{default:t(()=>[e(ee,{"model-value":(a(b)?.accès||0)*100,width:5,indeterminate:a(b)?.accès===void 0,color:a(ne)(a(b)?.accès).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>_[3]||(_[3]=[A("Accessibilité")])),_:1}),e(qe,{licence:a(E),"licence-contenu":a(R),"permission-modifier":!!a(w)},{activator:t(({props:h})=>[e(Q,ve(be(h)),{prepend:t(()=>[e(fe,null,{default:t(()=>[a(b)?.licence===void 0?(u(),p(ee,{key:0,width:5,indeterminate:"",color:a(ne)(a(b)?.licence).couleur},null,8,["color"])):$("",!0),e(J,{icon:a(b)?.licence?"mdi-check":"mdi-alert-circle-outline",color:a(ne)(a(b)?.licence).couleur},null,8,["icon","color"])]),_:1})]),title:t(()=>[A(T(a(b)?.licence===void 0?a(n)("bds.qualité.rechercheLicence"):a(b).licence?a(n)("bds.qualité.licenceOuverte"):a(n)("bds.qualité.licenceNonReconnue")),1)]),_:2},1040)]),_:1},8,["licence","licence-contenu","permission-modifier"]),e(Q,null,{prepend:t(()=>[e(fe,null,{default:t(()=>[e(ee,{"model-value":(a(b)?.valide||0)*100,width:5,indeterminate:a(b)?.valide===void 0,color:a(ne)(a(b)?.valide).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>_[4]||(_[4]=[A("Validation données")])),_:1}),e(Q,null,{prepend:t(()=>[e(fe,null,{default:t(()=>[e(ee,{"model-value":(a(b)?.couverture||0)*100,width:5,indeterminate:a(b)?.couverture===void 0,color:a(ne)(a(b)?.couverture).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>_[5]||(_[5]=[A("Couverture tests")])),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue","max-width"]))}}),at=K({__name:"CarteStatutBd",props:{idBd:{}},setup(N){const s=N,{$மொ:n}=se(),{mdAndUp:f}=Ee(),B=de(),d=I(!1),b=C(B.bds.suivreStatutBd,{idBd:v(()=>s.idBd)}),E=I();Ie(()=>{E.value=b.value});const R=v(()=>b.value?.statut!==E.value?.statut||b.value?.idNouvelle!==E.value?.idNouvelle),w=I(!1),x=async()=>{w.value=!0,E.value&&await B.bds.changerStatutBd({idBd:s.idBd,statut:ze(E.value)}),w.value=!1,d.value=!1};return(_,h)=>(u(),p(Ce,{modelValue:d.value,"onUpdate:modelValue":h[3]||(h[3]=L=>d.value=L)},{activator:t(({props:L})=>[Ve(_.$slots,"activator",ve(be({props:L})))]),default:t(()=>[e(G,{class:"mx-auto","min-width":a(f)?500:300},{default:t(()=>[e(Te,null,{default:t(()=>[e(ke,null,{default:t(()=>[A(T(a(n)("données.statut.carte.titre")),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Ga,{initial:E.value,onChoisir:h[0]||(h[0]=L=>E.value=L)},{sélecteur:t(({choisirNouvelle:L})=>[e(Je,{multiples:!1,onSelectionnee:H=>L(H[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e(Ae,null,{default:t(()=>[e(W),e(Ke,{onClick:h[1]||(h[1]=L=>d.value=!1)}),e(Xe,{actif:R.value,"en-attente":w.value,onClick:h[2]||(h[2]=()=>x())},null,8,["actif","en-attente"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),tt=K({__name:"ItemQualitéBd",props:{id:{}},setup(N){return(s,n)=>(u(),p(Q,null,{prepend:t(()=>[e(Ye,{id:s.id},null,8,["id"])]),default:t(()=>[e(De,null,{default:t(()=>[e(Ze,{id:s.id},null,8,["id"])]),_:1})]),_:1}))}}),it=K({__name:"ItemLicence",props:{licence:{}},setup(N){const s=de(),{$மொ:n}=se(),f=N,B=C(s.licences.suivreLicences),d=v(()=>!!(f.licence&&B.value&&Object.keys(B.value).includes(f.licence)));return(b,E)=>(u(),p(Q,null,{prepend:t(()=>[e(J,{start:"",color:d.value?"primary":"error"},{default:t(()=>[A(T(d.value?"mdi-scale-balance":"mdi-alert"),1)]),_:1},8,["color"])]),default:t(()=>[e(De,null,{default:t(()=>[A(T(d.value?a(n)(`licences.info.${b.licence}.abr`):b.licence),1)]),_:1})]),_:1}))}}),lt={class:"my-4 text-h6 text-disabled"},nt=K({__name:"TableauBd",props:{idTableau:{},idBd:{}},setup(N){const{$மொ:s}=se(),n=de(),f=N,B=C(n.suivrePermission,{idObjet:v(()=>f.idTableau)}),d=C(n.tableaux.suivreNomsTableau,{idTableau:v(()=>f.idTableau)}),b=C(n.tableaux.suivreVariables,{idTableau:v(()=>f.idTableau)}),E=C(n.tableaux.suivreColonnesTableau,{idTableau:v(()=>f.idTableau)}),R=C(n.tableaux.suivreColonnesEtCatégoriesTableau,{idTableau:v(()=>f.idTableau)}),w=v(()=>(E.value||[]).map(r=>{const o=R.value?.find(l=>l.id===r.id)?.catégorie;return{key:r.id,sortable:o===void 0||(o?.type==="simple"?Aa(o.catégorie):!1),info:{index:r.index,catégorie:o,variable:r.variable}}})),x=v(()=>{const r={key:"actions",sortable:!1,info:{}};return[...w.value,r]}),_=async({idVariable:r,idColonne:o,index:l,règles:m})=>{o=await n.tableaux.ajouterColonneTableau({idTableau:f.idTableau,idVariable:r,idColonne:o}),l&&await n.tableaux.changerColIndex({idTableau:f.idTableau,idColonne:o,val:!0});for(const j of m)await n.tableaux.ajouterRègleTableau({idTableau:f.idTableau,idColonne:o,règle:j})},h=async({idColonne:r,index:o,règles:l})=>{await n.tableaux.changerColIndex({idTableau:f.idTableau,idColonne:r,val:o});for(const m of l.nouvelles)await n.tableaux.ajouterRègleTableau({idTableau:f.idTableau,idColonne:r,règle:m});for(const m of l.àEffacer)await n.tableaux.effacerRègleTableau({idTableau:f.idTableau,idRègle:m})},L=async({idColonne:r})=>{await n.tableaux.effacerColonneTableau({idTableau:f.idTableau,idColonne:r})},H=C(n.tableaux.suivreDonnées,{idTableau:v(()=>f.idTableau)}),ye=v(()=>{const r=H.value?.toSorted((l,m)=>ue.value&&ue.value.map(j=>l.données[j.key]===void 0?m.données[j.key]===void 0?0:j.order==="asc"?1:-1:m.données[j.key]===void 0?l.données[j.key]===void 0?0:j.order==="asc"?-1:1:l.données[j.key]>m.données[j.key]?j.order==="asc"?1:-1:l.données[j.key]<m.données[j.key]?j.order==="asc"?-1:1:0).find(j=>j!==0)||0),o={id:"-1",données:{}};return X.value&&r?[o,...r]:r}),ue=I(),U=I([]),we=C(n.tableaux.suivreRègles,{idTableau:v(()=>f.idTableau)}),X=I(!1),ie=I(!1),Z=I(),M=v(()=>{const r=[];for(const[o,l]of Object.entries(Z.value||{})){const m=H.value?.find(j=>j.id===o);m&&q({modifs:l,original:m.données})&&r.push({idÉlément:o,vals:l})}return r}),re=v(()=>M.value.length+(Object.keys(D.value).length?1:0)),q=({modifs:r,original:o})=>Object.keys(r).some(l=>o[l]!==r[l]),D=I({});Ie(()=>{X.value||(D.value={})});const O=v(()=>Object.keys(D.value).length>0),ce=({val:r,idCol:o,idÉlément:l})=>{if(l==="-1")r!==void 0?D.value[o]=r:delete D.value[o];else{const m=Z.value||{};m[l]||(m[l]={}),m[l][o]=r,Z.value=m}},me=async({vals:r})=>Object.fromEntries(await Promise.all(Object.entries(r).map(async([o,l])=>{if(l instanceof File){const m=await n.ajouterÀSFIP({contenu:new Uint8Array(await l.arrayBuffer()),nomFichier:l.name});return[o,m]}else return[o,l]}))),xe=async()=>{ie.value=!0;for(const{idÉlément:r,vals:o}of M.value)await n.tableaux.modifierÉlément({idTableau:f.idTableau,idÉlément:r,vals:await me({vals:o})});O.value&&await ge(),Z.value=void 0,ie.value=!1},ge=async()=>{await n.tableaux.ajouterÉlément({idTableau:f.idTableau,vals:await me({vals:D.value})}),D.value={}},le=I(!1),Y=I(!1),z=I(!1),c=I(!1),y=I(!1);ea([c,y],()=>{le.value=Y.value});const S=async({idÉlément:r})=>{z.value=!0,await n.tableaux.effacerÉlément({idTableau:f.idTableau,idÉlément:r}),z.value=!1},i=async()=>{z.value=!0,await Promise.all(U.value.map(r=>S({idÉlément:r}))),U.value=[],z.value=!1},k=async()=>{await n.bds.effacerTableauBd({idBd:f.idBd,idTableau:f.idTableau})};return(r,o)=>(u(),p(Da,{modelValue:U.value,"onUpdate:modelValue":o[13]||(o[13]=l=>U.value=l),headers:x.value,items:ye.value,"show-select":!!a(B),"multi-sort":"","onUpdate:sortBy":o[14]||(o[14]=l=>ue.value=l)},aa({top:t(()=>[e(Sa,{flat:"",density:"compact"},{default:t(()=>[e(W),a(B)?(u(),p(V,{key:0,icon:"",disabled:!re.value,onClick:o[0]||(o[0]=()=>xe())},{default:t(()=>[re.value?(u(),p(ta,{key:0,color:"success",content:re.value},{default:t(()=>[e(J,{color:"primary",icon:"mdi-content-save-outline"})]),_:1},8,["content"])):(u(),p(J,{key:1,color:"primary",icon:"mdi-content-save-check-outline"}))]),_:1},8,["disabled"])):$("",!0),a(B)?(u(),p(Ha,{key:1,modelValue:X.value,"onUpdate:modelValue":o[1]||(o[1]=l=>X.value=l),class:"me-4",density:"compact",color:"primary","true-icon":"mdi-pencil-outline","false-icon":"mdi-pencil-off-outline","hide-details":""},null,8,["modelValue"])):$("",!0),a(B)?(u(),p(Qa,{key:2,"id-tableau":r.idTableau,"variables-interdites":a(b),onNouvelle:o[2]||(o[2]=l=>_(l))},{activator:t(({props:l})=>[e(V,g(l,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):$("",!0),e(Ge,{"id-objet":r.idTableau,"type-objet":"tableau"},{activator:t(({props:l})=>[e(oe,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(V,g({...l,...m},{icon:"mdi-sync"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(Qe,{"id-objet":r.idTableau,"noms-objet":a(d),"type-objet":"tableau"},{activator:t(({props:l})=>[e(oe,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(V,g({...l,...m},{icon:"mdi-download"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),a(B)?(u(),p(Fe,{key:3,onEffacer:o[3]||(o[3]=()=>k())},{activator:t(({props:l})=>[e(V,g(l,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):$("",!0)]),_:1})]),"no-data":t(()=>[P("p",lt,T(a(s)("tableaux.aucuneDonnée")),1),$("",!0)]),"item.actions":t(({item:l})=>[l.id==="-1"?(u(),p(V,{key:0,disabled:!O.value,icon:"mdi-content-save-outline",size:"small",variant:"flat",onClick:o[9]||(o[9]=()=>ge())},null,8,["disabled"])):le.value&&a(B)?(u(),p(V,{key:1,size:"small",icon:"mdi-delete",variant:"flat",loading:z.value,onClick:()=>S({idÉlément:l.id})},null,8,["loading","onClick"])):a(B)?(u(),p(Ce,{key:2,modelValue:c.value,"onUpdate:modelValue":o[12]||(o[12]=m=>c.value=m)},{activator:t(({props:m})=>[e(V,g(m,{variant:"flat",icon:"mdi-delete",size:"small",loading:z.value}),null,16,["loading"])]),default:t(()=>[e(G,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Te,null,{default:t(()=>[e(ke,null,{default:t(()=>[A(T(a(s)("tableaux.données.titreEffacer")),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Se,{modelValue:Y.value,"onUpdate:modelValue":o[10]||(o[10]=m=>Y.value=m),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(Ae,null,{default:t(()=>[e(W),e(V,{variant:"text",text:a(s)("communs.oui"),onClick:()=>{S({idÉlément:l.id}),c.value=!1}},null,8,["text","onClick"]),e(V,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:o[11]||(o[11]=m=>c.value=!1)},null,8,["text"]),e(W)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])):$("",!0)]),_:2},[te(w.value||[],l=>({name:`header.${l.key}`,fn:t(({column:m,isSorted:j,getSortIcon:He,toggleSort:We})=>[e(Ea,{"id-colonne":l.key,"id-variable":l.info.variable,"id-tableau":r.idTableau,index:!!l.info.index,regles:a(we)?.filter(je=>je.colonne===l.key),"permission-modifier":!!a(B),ordonnable:m.sortable,"est-ordonnee":j(m),"icone-ordonner":He(m),onBasculerOrdonner:()=>We(m),onSauvegarder:je=>h({idColonne:l.key,...je}),onEffacer:()=>L({idColonne:l.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),a(B)?{name:"header.actions",fn:t(()=>[le.value?(u(),p(V,{key:0,icon:"mdi-delete",variant:"flat",size:"small",loading:z.value,readonly:!U.value.length,onClick:o[4]||(o[4]=()=>i())},null,8,["loading","readonly"])):(u(),p(Ce,{key:1,modelValue:y.value,"onUpdate:modelValue":o[8]||(o[8]=l=>y.value=l)},{activator:t(({props:l})=>[e(V,g(l,{icon:"",variant:"flat",size:"small",readonly:!U.value.length,loading:z.value}),{default:t(()=>[e(J,{icon:"mdi-delete",color:U.value.length?void 0:"disabled"},null,8,["color"])]),_:2},1040,["readonly","loading"])]),default:t(()=>[e(G,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Te,null,{default:t(()=>[e(ke,null,{default:t(()=>[A(T(a(s)("tableaux.données.titreEffacerSélectionnées",U.value.length)),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Se,{modelValue:Y.value,"onUpdate:modelValue":o[5]||(o[5]=l=>Y.value=l),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(Ae,null,{default:t(()=>[e(W),e(V,{variant:"text",text:a(s)("communs.oui"),onClick:o[6]||(o[6]=()=>{i(),y.value=!1})},null,8,["text"]),e(V,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:o[7]||(o[7]=l=>y.value=!1)},null,8,["text"]),e(W)]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),key:"0"}:void 0,te(w.value,l=>({name:`item.${l.key}`,fn:t(({item:m})=>[e(Ia,{categorie:l.info.catégorie?.catégorie,val:m.données[l.key],editable:!!a(B)&&X.value,onModifiee:({val:j})=>ce({idCol:l.key,idÉlément:m.id,val:j})},null,8,["categorie","val","editable","onModifiee"])])}))]),1032,["modelValue","headers","items","show-select"]))}}),ot={class:"text-center"},st={class:"text-center"},dt={key:0,class:"text-disabled"},ut={class:"text-center"},rt={class:"mt-6 text-h5"},ct={class:"d-flex flex-wrap"},mt={class:"mt-6 text-h5"},ft={key:0,class:"text-disabled"},pt={class:"mt-6 text-h5"},vt={key:2,class:"text-center"},bt={class:"text-h5 mt-5"},Dt=K({__name:"PageBd",props:{id:{}},setup(N){const s=N,n=de(),{mdAndUp:f}=Ee(),{isRtl:B}=ia(),{$மொ:d}=se(),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:b}=la(),{obtImageDéco:E}=oa(),R=$a();na(()=>{R.documentOuvert({id:s.id,à:Date.now()})});const w=E("vide"),x=C(n.suivrePermission,{idObjet:v(()=>s.id)}),_=C(n.bds.suivreNomsBd,{idBd:v(()=>s.id)}),h=b(_),L=async c=>{const{àEffacer:y,àAjouter:S}=Re({anciennes:_.value,nouvelles:c});for(const i of y)await n.bds.effacerNomBd({idBd:s.id,langue:i});await n.bds.sauvegarderNomsBd({idBd:s.id,noms:S})},H=C(n.bds.suivreDescriptionsBd,{idBd:v(()=>s.id)}),ye=b(H),ue=async c=>{const{àEffacer:y,àAjouter:S}=Re({anciennes:H.value,nouvelles:c});for(const i of y)await n.bds.effacerDescriptionBd({idBd:s.id,langue:i});await n.bds.sauvegarderDescriptionsBd({idBd:s.id,descriptions:S})},U=sa(C(n.bds.suivreImage,{idBd:v(()=>s.id)})),we=E("logoBD"),X=async c=>{c?await n.bds.sauvegarderImage({idBd:s.id,image:{contenu:new Uint8Array(c.contenu),nomFichier:c.fichier}}):await n.bds.effacerImage({idBd:s.id})},ie=C(n.bds.suivreStatutBd,{idBd:v(()=>s.id)}),Z=C(n.bds.suivreVariablesBd,{idBd:v(()=>s.id)}),M=C(n.bds.suivreMotsClefsBd,{idBd:v(()=>s.id)}),re=async c=>{const y=c.filter(i=>!M.value?.includes(i)),S=M.value?.filter(i=>!c.includes(i))||[];await n.bds.ajouterMotsClefsBd({idBd:s.id,idsMotsClefs:y}),await Promise.all(S.map(i=>n.bds.effacerMotClefBd({idBd:s.id,idMotClef:i})))},q=C(n.bds.suivreTableauxBd,{idBd:v(()=>s.id)}),D=I();Ie(()=>{!D.value&&q.value?.length&&(D.value=q.value[0].clef),D.value&&!q.value?.map(c=>c.clef).includes(D.value)&&(D.value=void 0)});const O=I(!1),ce=async({noms:c,cols:y})=>{O.value=!0;try{const S=await n.bds.ajouterTableauBd({idBd:s.id});await n.tableaux.sauvegarderNomsTableau({idTableau:S,noms:ze(c)}),await Promise.all(y.map(async i=>{await n.tableaux.ajouterColonneTableau({idTableau:S,idColonne:i.info.id,idVariable:i.info.variable}),i.info.index&&await n.tableaux.changerColIndex({idTableau:S,idColonne:i.info.id,val:!0}),await Promise.all(i.règles.map(async k=>await n.tableaux.ajouterRègleTableau({idTableau:S,idColonne:i.info.id,règle:k})))}))}finally{O.value=!1}},me=C(n.réseau.suivreAuteursBd,{idBd:v(()=>s.id)}),xe=C(n.bds.suivreLicenceBd,{idBd:v(()=>s.id)}),ge=C(n.bds.suivreLicenceContenuBd,{idBd:v(()=>s.id)}),le=async({licence:c,licenceContenu:y})=>{await n.bds.changerLicenceBd({idBd:s.id,licence:c}),y&&await n.bds.changerLicenceContenuBd({idBd:s.id,licenceContenu:y})},Y=v(()=>[{title:d("navigation.données"),href:encodeURI("/données/")},{title:h.value||d("bds.sansNom"),disabled:!0}]),z=async()=>{await n.bds.effacerBd({idBd:s.id})};return(c,y)=>{const S=ga("carte-replications-objet");return u(),p(da,null,{default:t(()=>[P("div",null,[a(f)?(u(),p(Na,{key:0,items:Y.value,class:"pa-0"},{divider:t(()=>[e(J,null,{default:t(()=>[A(T(a(B)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:t(({item:i})=>[e(La,{disabled:i.disabled,onClick:k=>i.href&&c.$router.push(i.href)},{default:t(()=>[e(ua,{texte:i.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(u(),p(V,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:y[0]||(y[0]=()=>c.$router.push(encodeURI("/données/")))}))]),e(ca,{"src-image":a(U),"img-defaut":a(we),editable:!!a(x),"taille-avatar":a(f)?275:175,"max-taille-image":a(ra),onImageChangee:y[1]||(y[1]=i=>X(i))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),P("div",ot,[e(Ne,{"etiquette-nom":a(d)("objet.étiquetteNom"),"indice-nom":a(d)("objet.indiceNom"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucunNom"),"noms-initiaux":a(_),titre:a(d)("objet.titreDialogueNoms"),"sous-titre":a(d)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!a(x),onAjusterNoms:L},{activator:t(({props:i})=>[P("span",g(i,{class:"text-h4"}),[A(T(a(h)||a(d)("bds.sansNom"))+" ",1),e(V,{icon:a(x)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(ma,{id:c.id},null,8,["id"]),e(W)]),P("div",st,[e(Pe,{"n-max":5,items:a(M)},{jeton:t(({id:i})=>[e(Le,{id:i},{activator:t(({props:k})=>[e(pa,g(k,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Le,{id:i},{activator:t(({props:k})=>[e(fa,g(k,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(M)&&!a(M).length?(u(),F("span",dt,T(a(d)("bds.aucunMotClef")),1)):$("",!0),a(x)&&a(M)?(u(),p(va,{key:1,originaux:a(M),onSauvegarder:y[2]||(y[2]=i=>re(i))},null,8,["originaux"])):$("",!0)]),P("div",ut,[e(_a,{"id-bd":c.id},{activator:t(({props:i})=>[e(oe,{"open-delay":"200",location:"bottom",text:a(d)("épingler.épingler")},{activator:t(({props:k})=>[e(V,g({...i,...k},{icon:"",variant:"flat"}),{default:t(()=>[e(ba,{id:c.id},null,8,["id"])]),_:2},1040)]),_:2},1032,["text"])]),_:1},8,["id-bd"]),e(Qe,{"id-objet":c.id,"noms-objet":a(_),"type-objet":"bd"},{activator:t(({props:i})=>[e(oe,{text:a(d)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:k})=>[e(V,g({...i,...k},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),e(Ya,{id:c.id},{activator:t(({props:i})=>[e(oe,{text:a(d)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:k})=>[e(V,g({...i,...k},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),$("",!0),a(x)?(u(),p(Fe,{key:1,onEffacer:z},{activator:t(({props:i})=>[e(oe,{"open-delay":"200",location:"bottom",text:a(d)("effacer.indice")},{activator:t(({props:k})=>[e(V,g({...i,...k},{variant:"flat",icon:""}),{default:t(()=>[e(J,{color:"error"},{default:t(()=>y[7]||(y[7]=[A("mdi-delete")])),_:1})]),_:2},1040)]),_:2},1032,["text"])]),_:1})):$("",!0)]),e(ae),e(_e,null,{default:t(()=>[e(Ne,{"etiquette-nom":a(d)("objet.étiquetteDescription"),"indice-nom":a(d)("objet.indiceDescription"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucuneDescription"),"noms-initiaux":a(H),titre:a(d)("objet.titreDialogueDescriptions"),"sous-titre":a(d)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!a(x),longue:"",onAjusterNoms:ue},{activator:t(({props:i})=>[P("span",{class:ya({"text-disabled":!a(ye)})},T(a(ye)||a(d)("communs.baseCarteObjet.sansDescription")),3),e(V,g(i,{icon:a(x)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),P("p",rt,T(a(d)("bds.info")),1),e(ae,{class:"mb-2"}),P("div",ct,[a(ie)&&(a(ie).statut!=="active"||a(x))?(u(),p(G,{key:0,flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(at,{"id-bd":c.id},{activator:t(({props:i})=>[e(Pa,g(i,{"type-objet":"bd",statut:a(ie)}),null,16,["statut"])]),_:1},8,["id-bd"])]),_:1})):$("",!0),e(G,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(et,{"id-bd":c.id},{activator:t(({props:i})=>[e(tt,g(i,{id:c.id}),null,16,["id"])]),_:1},8,["id-bd"])]),_:1}),e(G,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(xa,{id:c.id,auteurs:a(me),"permission-moderateur":a(x)==="MODÉRATEUR"},{activator:t(({props:i})=>[e(Oa,g(i,{auteurs:a(me)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(G,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(qe,{licence:a(xe),"licence-contenu":a(ge),"permission-modifier":a(x)==="MODÉRATEUR",onChangerLicence:le},{activator:t(({props:i})=>[e(it,g(i,{licence:a(xe),onChangerLicence:le}),null,16,["licence"])]),_:1},8,["licence","licence-contenu","permission-modifier"])]),_:1}),e(G,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(S,{id:c.id},{activator:t(({props:i})=>[e(Ra,g(i,{id:c.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(G,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Za,{"id-bd":c.id,permission:a(x),"type-objet":"bd"},{activator:t(({props:i})=>[e(Ua,g(i,{"id-objet":c.id}),null,16,["id-objet"])]),_:1},8,["id-bd","permission"])]),_:1})]),P("p",mt,T(a(d)("bds.variables")),1),e(ae,{class:"mb-2"}),e(Pe,{"n-max":5,items:a(Z)},{jeton:t(({id:i})=>[e(Oe,{id:i},{activator:t(({props:k})=>[e(Ca,g(k,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Oe,{id:i},{activator:t(({props:k})=>[e(Ba,g(k,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(Z)?.length?$("",!0):(u(),F("p",ft,T(a(d)("bds.aucuneVariable")),1)),e(Be,null,{default:t(()=>[P("p",pt,T(a(d)("bds.tableaux")),1),e(ae),a(f)?(u(),p(Wa,{key:0,modelValue:D.value,"onUpdate:modelValue":y[4]||(y[4]=i=>D.value=i),class:"mt-2"},{default:t(()=>[(u(!0),F(pe,null,te(a(q),i=>(u(),p(Ja,{key:i.clef,value:i.clef,color:"primary",size:"small",density:"compact"},{default:t(()=>[e(Ue,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["value"]))),128)),e(he,{onSauvegarder:ce},{activator:t(({props:i})=>[a(x)?(u(),p($e,g({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",disabled:O.value,variant:"text",class:"mx-1 my-auto",size:"x-large",label:"",onClick:y[3]||(y[3]=Ta(()=>{},["stop"]))}),{default:t(()=>[A(T(a(d)("tableaux.nouveau"))+" ",1),O.value?(u(),p(ee,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1},8,["modelValue"])):(u(),p(ka,{key:1,modelValue:D.value,"onUpdate:modelValue":y[5]||(y[5]=i=>D.value=i),class:"mt-4","show-arrows":"","center-active":""},{default:t(()=>[(u(!0),F(pe,null,te(a(q),i=>(u(),p(Me,{key:i.clef,value:i.clef},{default:t(({isSelected:k,toggle:r})=>[e($e,{class:"mx-1",variant:"tonal",label:"",active:!1,color:k?"primary":"",onClick:r},{default:t(()=>[e(Ue,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(Me,{key:"nouveau",value:"nouveau"},{default:t(()=>[e(he,{onSauvegarder:ce},{activator:t(({props:i})=>[a(x)?(u(),p($e,g({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:O.value}),{default:t(()=>[A(T(a(d)("tableaux.nouveau"))+" ",1),O.value?(u(),p(ee,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):$("",!0)]),_:2},1040,["append-icon","disabled"])):$("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),a(q)&&!a(q).length?(u(),F("div",vt,[P("p",bt,T(a(d)("tableaux.aucun")),1),e(Va,{src:a(w),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e(he,{onSauvegarder:ce},{activator:t(({props:i})=>[a(x)?(u(),p(V,g({key:0},i,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:t(()=>[e(J,{icon:"mdi-table",start:""})]),default:t(()=>[A(" "+T(a(d)("tableaux.nouveau")),1)]),_:2},1040)):$("",!0)]),_:1})])):$("",!0)]),_:1}),e(wa,{modelValue:D.value,"onUpdate:modelValue":y[6]||(y[6]=i=>D.value=i)},{default:t(()=>[(u(!0),F(pe,null,te(a(q),i=>(u(),p(ja,{key:i.clef,value:i.clef},{default:t(()=>[e(nt,{"id-tableau":i.id,"id-bd":c.id},null,8,["id-tableau","id-bd"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Dt as default};
//# sourceMappingURL=PageBd-Bs8Ydaus.js.map

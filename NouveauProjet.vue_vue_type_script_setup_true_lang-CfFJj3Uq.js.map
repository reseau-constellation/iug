{"version":3,"file":"NouveauProjet.vue_vue_type_script_setup_true_lang-CfFJj3Uq.js","sources":["../../src/components/projets/NouveauProjet.vue"],"sourcesContent":["<template>\n  <v-dialog v-model=\"dialogue\">\n    <template #activator=\"{props}\">\n      <slot\n        name=\"activateur\"\n        v-bind=\"{props}\"\n      ></slot>\n    </template>\n    <v-card\n      class=\"mx-auto\"\n      :min-width=\"mdAndUp ? 750 : 300\"\n    >\n      <v-card-item>\n        <v-card-title class=\"text-h5 justify-space-between\">\n          <span>{{ t(titreCarte) }}</span>\n        </v-card-title>\n        <v-card-subtitle> {{ t(sousTitreCarte) }} </v-card-subtitle>\n      </v-card-item>\n      <v-card-text>\n        <v-window\n          v-model=\"étape\"\n          style=\"overflow-y: scroll\"\n        >\n          <v-window-item :value=\"0\">\n            <liste-noms\n              :texte-aucun-nom=\"t('communs.texteAucunNom')\"\n              :indice-langue=\"t('communs.indiceLangue')\"\n              :etiquette-nom=\"t('communs.étiquetteNom')\"\n              :indice-nom=\"t('projets.nouveau.texteIndiceNom')\"\n              :noms-initiaux=\"noms\"\n              :autorisation-modification=\"true\"\n              @ajuster-noms=\"ajusterNoms\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"1\">\n            <liste-noms\n              :texte-aucun-nom=\"t('projets.nouveau.texteAucuneDescription')\"\n              :indice-langue=\"t('communs.indiceLangue')\"\n              :etiquette-nom=\"t('projets.nouveau.texteÉtiquetteDescription')\"\n              :indice-nom=\"t('projets.nouveau.texteIndiceDescription')\"\n              :noms-initiaux=\"descriptions\"\n              :autorisation-modification=\"true\"\n              @ajuster-noms=\"ajusterDescriptions\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"2\">\n            <selecteur-mot-clef\n              multiples\n              :originaux=\"motsClefs\"\n              @selectionnee=\"ids => (motsClefs = ids)\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"3\">\n            <selecteur-bd\n              :multiples=\"false\"\n              :originales=\"bds\"\n              @selectionnee=\"ids => (bds = ids)\"\n            />\n          </v-window-item>\n          <v-window-item :value=\"4\">\n            <div class=\"text-center\">\n              <h3 class=\"text-h6 font-weight-light mb-2\">\n                {{ t('projets.nouveau.texteCréer') }}\n              </h3>\n              <p>\n                <v-btn\n                  class=\"mt-3\"\n                  variant=\"outlined\"\n                  :loading=\"enCréation\"\n                  @click=\"() => créerProjet()\"\n                >\n                  {{ t('projets.nouveau.texteBtnCréation') }}\n                </v-btn>\n              </p>\n              <v-checkbox v-model=\"ouvrirAprèsCréation\">\n                {{ t('projets.nouveau.ouvrirAprèsCréation') }}\n              </v-checkbox>\n            </div>\n          </v-window-item>\n        </v-window>\n      </v-card-text>\n      <v-divider></v-divider>\n\n      <v-card-actions>\n        <btn-retour\n          :visible=\"retourActif.visible\"\n          :actif=\"retourActif.actif\"\n          @retour=\"retour\"\n        />\n        <v-spacer></v-spacer>\n        <btn-suivant\n          :visible=\"suivantActif.visible\"\n          :actif=\"suivantActif.actif\"\n          @suivant=\"suivant\"\n        />\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script setup lang=\"ts\">\nimport {computed, ref} from 'vue';\nimport {useDisplay} from 'vuetify';\n\nimport {மொழியாக்கத்தைப்_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport {useRouter} from 'vue-router';\nimport {utiliserConstellation} from '../utils';\nimport SelecteurBd from '/@/components/bds/SélecteurBd.vue';\nimport BtnRetour from '/@/components/communs/BtnRetour.vue';\nimport BtnSuivant from '/@/components/communs/BtnSuivant.vue';\nimport ListeNoms from '/@/components/communs/listeNoms/ListeNoms.vue';\nimport SelecteurMotClef from '/@/components/motsClefs/SélecteurMotClef.vue';\n\nconst émettre = defineEmits<{(é: 'nouveau', id: string): void}>();\n\nconst constl = utiliserConstellation();\n\nconst {$மொ: t} = மொழியாக்கத்தைப்_பயன்படுத்து();\nconst {mdAndUp} = useDisplay();\nconst router = useRouter();\n\n// Navigation\nconst dialogue = ref(false);\n\nconst étape = ref(0);\nconst listeÉtapes = ['noms', 'descriptions', 'motsClefs', 'ajouterBds', 'confirmation'] as const;\n\nconst titreCarte = computed(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return 'projet.nouveau.titreNoms';\n    case 'descriptions':\n      return 'projet.nouveau.titreDescriptions';\n    case 'motsClefs':\n      return 'projet.nouveau.titreMotsClefs';\n    case 'ajouterBds':\n      return 'projet.nouveau.titreAjouterBds';\n    case 'confirmation':\n      return 'projet.nouveau.titreConfirmation';\n    default:\n      return '';\n  }\n});\n\nconst sousTitreCarte = computed(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return 'projet.nouveau.sousTitreNoms';\n    case 'descriptions':\n      return 'projet.nouveau.sousTitreDescriptions';\n    case 'motsClefs':\n      return 'projet.nouveau.sousTitreMotsClefs';\n    case 'ajouterBds':\n      return 'projet.nouveau.sousTitreAjouterBds';\n    case 'confirmation':\n      return 'projet.nouveau.sousTitreConfirmation';\n    default:\n      return '';\n  }\n});\n\nconst suivant = () => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    default:\n      étape.value++;\n      break;\n  }\n};\n\nconst retour = () => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    default:\n      étape.value--;\n      break;\n  }\n};\n\nconst suivantActif = computed<{actif: boolean; visible: boolean}>(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return {actif: Object.keys(noms.value).length > 0, visible: true};\n    case 'confirmation':\n      return {actif: false, visible: false};\n    default:\n      return {actif: true, visible: true};\n  }\n});\n\nconst retourActif = computed<{actif: boolean; visible: boolean}>(() => {\n  const é = listeÉtapes[étape.value];\n  switch (é) {\n    case 'noms':\n      return {actif: false, visible: false};\n    case 'confirmation':\n      return {actif: !enCréation.value, visible: true};\n    default:\n      return {actif: true, visible: true};\n  }\n});\n\n// Noms\nconst noms = ref<{[lng: string]: string}>({});\nconst ajusterNoms = (nms: {[lng: string]: string}) => {\n  noms.value = nms;\n};\n\n// Descriptions\nconst descriptions = ref<{[lng: string]: string}>({});\nconst ajusterDescriptions = (desrc: {[lng: string]: string}) => {\n  descriptions.value = desrc;\n};\n\n// Mots-clefs\nconst motsClefs = ref<string[]>([]);\n\n// Bds\nconst bds = ref<string[]>([]);\n\n// Création\nconst ouvrirAprèsCréation = ref(false);\n\nconst enCréation = ref(false);\n\nconst créerProjet = async () => {\n  enCréation.value = true;\n\n  const idProjet = await constl.projets.créerProjet();\n  if (!idProjet) throw new Error('Projet non créé.');\n\n  await constl.projets.sauvegarderNomsProjet({\n    idProjet,\n    noms: Object.fromEntries(Object.entries(noms.value)),\n  });\n  await constl.projets.sauvegarderDescriptionsProjet({\n    idProjet,\n    descriptions: Object.fromEntries(Object.entries(descriptions.value)),\n  });\n  await constl.projets.ajouterMotsClefsProjet({idProjet, idsMotsClefs: motsClefs.value});\n  await Promise.all(\n    bds.value.map(async idBd => await constl.projets.ajouterBdProjet({idProjet, idBd})),\n  );\n\n  émettre('nouveau', idProjet);\n\n  fermer();\n  if (ouvrirAprèsCréation.value)\n    router.push(encodeURI(`/données/projet/${encodeURIComponent(idProjet)}`));\n};\n\n// Fermer\nconst fermer = () => {\n  noms.value = {};\n  descriptions.value = {};\n  motsClefs.value = [];\n  bds.value = [];\n\n  étape.value = 0;\n  enCréation.value = false;\n  dialogue.value = false;\n};\n</script>\n"],"names":["émettre","__emit","constl","utiliserConstellation","t","மொழியாக்கத்தைப்_பயன்படுத்து","mdAndUp","useDisplay","router","useRouter","dialogue","ref","étape","listeÉtapes","titreCarte","computed","sousTitreCarte","suivant","é","retour","suivantActif","noms","retourActif","enCréation","ajusterNoms","nms","descriptions","ajusterDescriptions","desrc","motsClefs","bds","ouvrirAprèsCréation","créerProjet","idProjet","idBd","fermer","_createBlock","_component_v_dialog","$event","_withCtx","props","_renderSlot","_ctx","_createVNode","_component_v_card","_unref","_component_v_card_item","_component_v_card_title","_createElementVNode","_toDisplayString","_component_v_card_subtitle","_createTextVNode","_component_v_card_text","_component_v_window","_component_v_window_item","ListeNoms","SelecteurMotClef","_cache","ids","SelecteurBd","_hoisted_1","_hoisted_2","_component_v_btn","_component_v_checkbox","_component_v_divider","_component_v_card_actions","BtnRetour","_component_v_spacer","BtnSuivant"],"mappings":"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"}
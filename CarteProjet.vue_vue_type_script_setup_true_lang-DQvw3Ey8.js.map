{"version":3,"file":"CarteProjet.vue_vue_type_script_setup_true_lang-DQvw3Ey8.js","sources":["../../src/components/épingles/ÉpinglerProjet.vue","../../src/components/projets/CarteProjet.vue"],"sourcesContent":["<template>\n  <v-dialog\n    v-model=\"dialogue\"\n    :max-width=\"mdAndUp ? 500 : 300\"\n  >\n    <template #activator=\"{props: propsActivateur}\">\n      <slot\n        name=\"activator\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <v-card>\n      <v-card-item>\n        <v-card-title class=\"d-flex\">\n          {{ t('épingler.titre') }}\n          <v-spacer />\n          <v-btn\n            icon=\"mdi-close\"\n            size=\"small\"\n            variant=\"flat\"\n            @click=\"fermer\"\n          >\n          </v-btn>\n        </v-card-title>\n      </v-card-item>\n      <v-divider />\n      <v-card-text style=\"overflow-y: scroll\">\n        <v-icon start>mdi-pin-outline</v-icon>\n        <span class=\"font-weight-bold\">{{ t('épingler.dispositifsÉpingle') }}</span>\n        <selection-dispositifs\n          v-model:selection=\"sélectionBase\"\n          v-model:specifiques=\"spécifiquesBase\"\n          class=\"ms-4\"\n        />\n\n        <v-expand-transition>\n          <div v-show=\"sélectionBase !== 'AUCUN'\">\n            <p class=\"mb-2\">\n              <span>{{ t('épingler.optionsAvancées') }}</span>\n              <v-btn\n                :icon=\"optionsAvancées ? 'mdi-chevron-up' : 'mdi-chevron-down'\"\n                size=\"xsmall\"\n                variant=\"flat\"\n                @click=\"() => (optionsAvancées = !optionsAvancées)\"\n              ></v-btn>\n            </p>\n\n            <v-expand-transition>\n              <div v-show=\"optionsAvancées\">\n                <v-divider class=\"mb-2\" />\n                <p>\n                  <v-icon start>mdi-database</v-icon>\n                  <span class=\"font-weight-bold\">{{ t('épingler.dispositifsÉpingleBds') }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionBds\"\n                  v-model:specifiques=\"spécifiquesBds\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-table-multiple</v-icon>\n                  <span class=\"font-weight-bold\">{{\n                    t('épingler.dispositifsÉpingleDonnées')\n                  }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionTableaux\"\n                  v-model:specifiques=\"spécifiquesTableaux\"\n                  class=\"ms-4\"\n                />\n                <p>\n                  <v-icon start>mdi-image-multiple-outline</v-icon>\n                  <span class=\"font-weight-bold\">{{\n                    t('épingler.dispositifsÉpingleDocuments')\n                  }}</span>\n                </p>\n                <selection-dispositifs\n                  v-model:selection=\"sélectionFichiersTableaux\"\n                  v-model:specifiques=\"spécifiquesFichiersTableaux\"\n                  class=\"ms-4\"\n                />\n              </div>\n            </v-expand-transition>\n          </div>\n        </v-expand-transition>\n      </v-card-text>\n      <v-divider />\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn\n          variant=\"outlined\"\n          @click=\"fermer\"\n        >\n          {{ t('communs.fermer') }}\n          <v-icon\n            icon=\"mdi-close\"\n            end\n          />\n        </v-btn>\n        <v-btn\n          color=\"primary\"\n          variant=\"outlined\"\n          :loading=\"enProgrès\"\n          :disabled=\"!prêtÀÉpingler || !valeursChangées\"\n          @click=\"() => épingler()\"\n        >\n          {{ t('communs.sauvegarder') }}\n          <v-icon\n            icon=\"mdi-check\"\n            end\n          />\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script setup lang=\"ts\">\nimport {type favoris} from '@constl/ipa';\n\nimport {suivre} from '@constl/vue';\nimport {computed, ref} from 'vue';\nimport {useDisplay} from 'vuetify';\n\nimport {கிளிமூக்கை_பயன்படுத்து} from '@lassi-js/kilimukku-vue';\nimport SelectionDispositifs from './SélectionDispositifs.vue';\nimport {optionsDispositifs} from './utils';\nimport {utiliserConstellation} from '/@/components/utils';\n\nconst props = defineProps<{idProjet: string}>();\n\nconst constl = utiliserConstellation();\n\nconst {mdAndUp} = useDisplay();\nconst {மொழியாக்கம்_பயன்படுத்து} = கிளிமூக்கை_பயன்படுத்து();\nconst {$மொ: t} = மொழியாக்கம்_பயன்படுத்து();\n\n// Navigation\nconst dialogue = ref(false);\nconst optionsAvancées = ref(false);\n\n// Épingle actuelle\nconst épingle = suivre(constl.projets.suivreÉpingleProjet, {idProjet: props.idProjet});\n\n// Options\nconst {\n  sélection: sélectionBase,\n  dispositifs: dispositifsBase,\n  spécifiques: spécifiquesBase,\n  valide: baseValide,\n  modifié: baseModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionBds,\n  dispositifs: dispositifsBds,\n  spécifiques: spécifiquesBds,\n  valide: bdsValide,\n  modifié: bdsModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.base),\n  'TOUS',\n);\nconst {\n  sélection: sélectionTableaux,\n  dispositifs: dispositifsTableaux,\n  spécifiques: spécifiquesTableaux,\n  valide: tableauxValide,\n  modifié: tableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.données.tableaux),\n  'INSTALLÉ',\n);\nconst {\n  sélection: sélectionFichiersTableaux,\n  dispositifs: dispositifsFichiersTableaux,\n  spécifiques: spécifiquesFichiersTableaux,\n  valide: fichiersTableauxValide,\n  modifié: fichiersTableauxModifié,\n} = optionsDispositifs(\n  computed(() => épingle.value?.bds.données.fichiers),\n  'INSTALLÉ',\n);\n\n// Sauvegarder\nconst prêtÀÉpingler = computed(() => {\n  return baseValide && bdsValide && tableauxValide && fichiersTableauxValide;\n});\n\nconst valeursChangées = computed(() => {\n  return (\n    baseModifié.value || bdsModifié.value || tableauxModifié.value || fichiersTableauxModifié.value\n  );\n});\n\nconst enProgrès = ref(false);\nconst épingler = async () => {\n  enProgrès.value = true;\n\n  if (dispositifsBase.value !== 'AUCUN') {\n    const épingle: favoris.ÉpingleProjet = {\n      type: 'projet',\n      base: dispositifsBase.value,\n      bds: {\n        type: 'bd',\n        base: dispositifsBds.value,\n        données: {\n          tableaux: dispositifsTableaux.value,\n          fichiers: dispositifsFichiersTableaux.value,\n        },\n      },\n    };\n    await constl.projets.épinglerProjet({\n      idProjet: props.idProjet,\n      options: épingle,\n    });\n  } else {\n    await désépingler();\n  }\n  fermer();\n};\nconst désépingler = async () => {\n  await constl.favoris.désépinglerFavori({idObjet: props.idProjet});\n};\n\n// Fermer\nconst fermer = () => {\n  dialogue.value = false;\n  enProgrès.value = false;\n};\n</script>\n","<template>\n  <base-carte-objet\n    :id=\"id\"\n    :noms=\"noms\"\n    :descriptions=\"descriptions\"\n    :auteurs=\"auteurs\"\n    :fichiers-epinglables=\"true\"\n    @ajuster-noms=\"ajusterNoms\"\n    @ajuster-descriptions=\"ajusterDescriptions\"\n    @effacer=\"effacerProjet\"\n  >\n    <template #activator=\"{props: propsActivateur}\">\n      <slot\n        name=\"activator\"\n        v-bind=\"{props: propsActivateur}\"\n      ></slot>\n    </template>\n    <template #epingler=\"{activateur, epingle}\">\n      <epingler-projet :id-projet=\"id\">\n        <template #activator=\"{props: propsActivateur}\">\n          <component\n            :is=\"activateur\"\n            v-bind=\"propsActivateur\"\n            :id=\"id\"\n            :epingle=\"epingle\"\n          />\n        </template>\n      </epingler-projet>\n    </template>\n  </base-carte-objet>\n</template>\n<script setup lang=\"ts\">\nimport {suivre} from '@constl/vue';\n\nimport BaseCarteObjet from '../communs/BaseCarteObjet.vue';\nimport {utiliserConstellation} from '/@/components/utils';\nimport {ajusterTexteTraductible} from '/@/utils';\nimport EpinglerProjet from '/@/components/épingles/ÉpinglerProjet.vue';\n\nconst props = defineProps<{id: string}>();\n\nconst constl = utiliserConstellation();\n\n// Nom projet\nconst noms = suivre(constl.projets.suivreNomsProjet, {idProjet: props.id}, {});\nconst ajusterNoms = async (nms: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({anciennes: noms.value, nouvelles: nms});\n  for (const langue of àEffacer) {\n    await constl.projets.effacerNomProjet({idProjet: props.id, langue});\n  }\n  await constl.projets.sauvegarderNomsProjet({\n    idProjet: props.id,\n    noms: àAjouter,\n  });\n};\n\n// Descriptions projet\nconst descriptions = suivre(constl.projets.suivreDescriptionsProjet, {idProjet: props.id}, {});\n\nconst ajusterDescriptions = async (descrs: {[langue: string]: string}) => {\n  const {àEffacer, àAjouter} = ajusterTexteTraductible({\n    anciennes: descriptions.value,\n    nouvelles: descrs,\n  });\n  for (const langue of àEffacer) {\n    await constl.projets.effacerDescriptionProjet({idProjet: props.id, langue});\n  }\n  await constl.projets.sauvegarderDescriptionsProjet({\n    idProjet: props.id,\n    descriptions: àAjouter,\n  });\n};\n\n// Auteurs\nconst auteurs = suivre(constl.réseau.suivreAuteursProjet, {idProjet: props.id});\n\n// Effacer\nconst effacerProjet = async () => {\n  await constl.projets.effacerProjet({idProjet: props.id});\n};\n</script>\n"],"names":["props","__props","constl","utiliserConstellation","mdAndUp","useDisplay","மொழியாக்கம்_பயன்படுத்து","கிளிமூக்கை_பயன்படுத்து","t","dialogue","ref","optionsAvancées","épingle","suivre","sélectionBase","dispositifsBase","spécifiquesBase","baseValide","baseModifié","optionsDispositifs","computed","sélectionBds","dispositifsBds","spécifiquesBds","bdsValide","bdsModifié","sélectionTableaux","dispositifsTableaux","spécifiquesTableaux","tableauxValide","tableauxModifié","sélectionFichiersTableaux","dispositifsFichiersTableaux","spécifiquesFichiersTableaux","fichiersTableauxValide","fichiersTableauxModifié","prêtÀÉpingler","valeursChangées","enProgrès","épingler","désépingler","fermer","noms","ajusterNoms","nms","àEffacer","àAjouter","ajusterTexteTraductible","langue","descriptions","ajusterDescriptions","descrs","auteurs","effacerProjet"],"mappings":"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"}
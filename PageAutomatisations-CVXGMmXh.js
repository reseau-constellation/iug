import{q,h as i,d as A,p as N,ம as T,r as x,o as oe,cU as ue,c as $,a as v,M as h,w as t,F as j,b as e,j as O,f as b,t as C,G as ee,dV as le,n as I,cY as re,v as ce,A as S,aX as B,a8 as me,c8 as de,dW as pe,a1 as Z,K as D,dX as P,as as fe,Q as z,s as R,dY as ve,x as X,i as L,e as G,y as te,m as J,aM as E,R as ae,aj as _e,ak as Ve,al as ye,V as Y,H,I as K,J as Q,cB as xe,dZ as ge,X as se,aC as be,aG as qe,z as $e,N as we}from"./index-C97eiRJz.js";import{o as ke}from"./action-DeUQrhMC.js";import{h as ie,d as je,e as Ce,f as De,i as Ue,j as Fe,k as Se,_ as he,a as Ae,c as Te,b as Me}from"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-Bkg9B4QD.js";import{u as Ee}from"./index-C5WGkYz5.js";import{_ as Ne}from"./TitrePage.vue_vue_type_script_setup_true_lang-DiKmJwbB.js";import"./SélecteurNuée.vue_vue_type_script_setup_true_lang-ns4ZTDg7.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-Dz3aEtAt.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-BoiwQHXI.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-C_KFK-Vq.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-CBh_nOk8.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-BW5nPNrT.js";const Ie=()=>{const c=Ee();return r=>{const u=i(r),a=q(()=>u?c.value.getTime()-u:void 0);return q(()=>{if(a.value!==void 0){const s=Math.abs(a.value),o=a.value<0?-1:1;return s<1e3?{unité:"millisecondes",n:s*o}:s<1e3*60?{unité:"secondes",n:Math.floor(s/1e3)*o}:s<1e3*60*60?{unité:"minutes",n:Math.floor(s/(1e3*60))*o}:s<1e3*60*60*24?{unité:"heures",n:Math.floor(s/(1e3*60*60))*o}:s<1e3*60*60*24*7?{unité:"jours",n:Math.floor(s/(1e3*60*60*24))*o}:s<1e3*60*60*24*30?{unité:"semaines",n:Math.floor(s/(1e3*60*60*24*7))*o}:s<1e3*60*60*24*365.25?{unité:"mois",n:Math.floor(s/(1e3*60*60*24*30))*o}:{unité:"années",n:Math.floor(s/(1e3*60*60*24*365.25))*o}}})}},Be=({t:c,clefs:r={dans:{millisecondes:"communs.temps.dans.ms",secondes:"communs.temps.dans.secondes",minutes:"communs.temps.dans.minutes",heures:"communs.temps.dans.heures",jours:"communs.temps.dans.jours",semaines:"communs.temps.dans.semaines",mois:"communs.temps.dans.mois",années:"communs.temps.dans.années"},depuis:{millisecondes:"communs.temps.depuis.ms",secondes:"communs.temps.depuis.secondes",minutes:"communs.temps.depuis.minutes",heures:"communs.temps.depuis.heures",jours:"communs.temps.depuis.jours",semaines:"communs.temps.depuis.semaines",mois:"communs.temps.depuis.mois",années:"communs.temps.depuis.années"}}})=>{const u=Ie();return a=>{const n=u(a);return q(()=>{if(n.value)return c(r[n.value.n<0?"dans":"depuis"][n.value.unité],{n:Math.abs(n.value.n)})})}},Pe=A({__name:"ItemStatutAutomatisation",props:{statut:{},spécification:{}},setup(c){const r=N(),{$மொ:u}=T(),a=Be({t:u}),n=c,s=q(()=>{switch(n.statut.type){case"erreur":return{icône:"mdi-alert",couleur:"error"};case"programmée":return{icône:"mdi-check",couleur:"success"};case"sync":return{icône:"mdi-sync",couleur:"primary"};case"écoute":return{icône:"",couleur:"success"};default:throw new Error(JSON.stringify(n.statut))}}),o=x(new Date().getTime());let _;oe(()=>{_=window.setInterval(()=>o.value=new Date().getTime(),1e3)}),ue(()=>{_&&clearInterval(_)});const m=async()=>{},f=a(q(()=>n.statut.type==="programmée"?n.statut.à:n.statut.type==="erreur"?n.statut.prochaineProgramméeÀ:void 0)),k=a(q(()=>n.statut.type==="sync"?n.statut.depuis:void 0)),g=q(()=>{switch(n.statut.type){case"écoute":return"automatisations.jetonStatut.écoute";case"sync":return u("automatisations.jetonStatut.sync",{depuis:k.value});case"programmée":return u("automatisations.jetonStatut.programmée",{dans:f.value});case"erreur":return n.statut.prochaineProgramméeÀ?u("automatisations.jetonStatut.erreurRéssayer",{dans:f.value}):"automatisations.jetonStatut.erreur";default:throw new Error(n.statut)}}),U=async()=>await r.automatisations.lancerManuellement({id:n.spécification.id});return(F,d)=>(v(),$(h,{title:"Ce dispositif"},{prepend:t(()=>[e(ee,{start:"",color:s.value.couleur},{default:t(()=>[b(C(s.value.icône),1)]),_:1},8,["color"])]),subtitle:t(()=>[b(C(i(u)(g.value)),1)]),default:t(()=>[c.spécification?.type==="exportation"?(v(),$(ie,{key:0,class:"my-2",spécification:c.spécification,onClick:d[0]||(d[0]=()=>m())},null,8,["spécification"])):j("",!0),e(O,{class:"my-2",size:"small",variant:"outlined","append-icon":"mdi-refresh",onClick:U},{default:t(()=>[...d[1]||(d[1]=[b(' "Relancer" ',-1)])]),_:1})]),_:1}))}}),ze={key:0},Oe={key:0,class:"d-flex"},Re={key:0,class:"d-flex mb-4"},Xe=A({__name:"OptionsFréquenceExportation",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(c){const r=le(c,"modelValue"),{mdAndUp:u}=I(),{$மொ:a}=T(),n=re(),s=[{value:"manuelle",title:"automatisations.fréquence.manuelle",sélection:"automatisations.exportation.fréquence.sélection.manuelle"},{value:"dynamique",title:"automatisations.fréquence.dynamique",sélection:"automatisations.exportation.fréquence.sélection.dynamique"},{value:"fixe",title:"automatisations.fréquence.fixe",sélection:"automatisations.exportation.fréquence.sélection.fixe"}],o=x(P?"manuelle":"fixe"),_=x(r.value?.type==="fixe"?r.value.détails.n.toString():"1"),m=q(()=>n.எண்ணுக்கு({உரை:_.value})),f=x("jours"),k=["années","mois","semaines","jours","heures","minutes","secondes","millisecondes"],g=d=>{try{return n.எண்ணுக்கு({உரை:d}),!0}catch{return a("règles.numérique")}},U=d=>(d|0)===d,F=()=>m.value!==void 0&&m.value>0&&U(m.value)?!0:a("règles.nombreEntierPositif");return ce(()=>{switch(o.value){case"manuelle":{const d={type:"manuelle"};r.value=d;break}case"dynamique":{const d={type:"dynamique"};r.value=d;break}case"fixe":{const d={type:"fixe",détails:{unités:f.value,n:m.value}};r.value=d;break}}}),(d,y)=>(v(),S(z,null,[e(B,{modelValue:o.value,"onUpdate:modelValue":y[2]||(y[2]=l=>o.value=l),class:me(i(u)?["mb-4"]:["mb-2"]),items:s,variant:"outlined",density:"compact","hide-details":""},de({item:t(({props:l,item:w})=>[e(h,D({...l,title:i(a)(w.title)},{disabled:i(P)&&(w.value==="manuelle"||w.value==="dynamique")}),{default:t(()=>[i(P)&&(w.value==="manuelle"||w.value==="dynamique")?(v(),S("span",ze,[e(ee,{size:"small",start:""},{default:t(()=>[...y[5]||(y[5]=[b(" mdi-alert-outline ",-1)])]),_:1}),b(" "+C(i(a)("automatisations.fréquence.pasSurNavig")),1)])):j("",!0)]),_:2},1040,["disabled"])]),selection:t(({item:l})=>[b(C(i(a)(l.raw.sélection)),1)]),_:2},[i(u)?{name:"append",fn:t(()=>[e(pe,null,{default:t(()=>[o.value==="fixe"?(v(),S("div",Oe,[e(Z,{modelValue:_.value,"onUpdate:modelValue":y[0]||(y[0]=l=>_.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,F]},null,8,["modelValue","rules"]),e(B,{modelValue:f.value,"onUpdate:modelValue":y[1]||(y[1]=l=>f.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(C(i(a)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(h,D(w,{title:i(a)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):j("",!0)]),_:1})]),key:"0"}:void 0]),1032,["modelValue","class"]),i(u)?j("",!0):(v(),$(fe,{key:0},{default:t(()=>[o.value==="fixe"?(v(),S("div",Re,[e(Z,{modelValue:_.value,"onUpdate:modelValue":y[3]||(y[3]=l=>_.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,F]},null,8,["modelValue","rules"]),e(B,{modelValue:f.value,"onUpdate:modelValue":y[4]||(y[4]=l=>f.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(C(i(a)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(h,D(w,{title:i(a)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):j("",!0)]),_:1}))],64))}}),Le=A({__name:"CarteAutomatisationExportation",props:{spécification:{},objetModifiable:{type:Boolean}},setup(c){const{$மொ:r}=T(),{mdAndUp:u}=I(),a=c,n=N(),s=x(!1),o=ke(n.obtIdDispositif),_=R(n.automatisations.suivreÉtatAutomatisations),m=q(()=>_.value?.[a.spécification.id]),f=x(a.spécification.langues),k=x(a.spécification.dossier),g=x(a.spécification.fréquence),U=x(a.spécification.formatDoc),F=x(a.spécification.inclureDocuments),d=x(a.spécification.copies),y=x(a.spécification.dispositifs),l=q(()=>({id:a.spécification.id,type:"exportation",fréquence:g.value,idObjet:a.spécification.idObjet,typeObjet:a.spécification.typeObjet,formatDoc:U.value,dossier:k.value,langues:f.value,dispositifs:y.value,inclureDocuments:F.value,copies:d.value})),w=async()=>{const M=await xe();M&&(k.value=M)},W=q(()=>!ve(l.value,a.spécification)),ne=async()=>{W.value&&await n.automatisations.modifierAutomatisation({id:a.spécification.id,automatisation:l.value})};return(M,p)=>(v(),$(X,{modelValue:s.value,"onUpdate:modelValue":p[9]||(p[9]=V=>s.value=V)},{activator:t(({props:V})=>[H(M.$slots,"activateur",K(Q({props:V})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,{class:"d-flex align-center"},{default:t(()=>[b(C(i(r)("automatisations.exportation.titreCarte"))+" ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:p[0]||(p[0]=V=>s.value=!1)})]),_:1})]),_:1}),e(J,{style:{"overflow-y":"scroll"}},{default:t(()=>[e(E,{titre:i(r)("automatisations.exportation.sousSections.statut")},null,8,["titre"]),m.value?(v(),$(Pe,{key:0,statut:m.value,spécification:c.spécification},null,8,["statut","spécification"])):j("",!0),i(o)&&c.spécification.dispositifs.includes(i(o))?(v(),$(ie,{key:1,class:"my-2",spécification:c.spécification,onClick:p[1]||(p[1]=()=>w())},null,8,["spécification"])):j("",!0),e(E,{titre:i(r)("automatisations.exportation.sousSections.format")},null,8,["titre"]),e(je,{modelValue:U.value,"onUpdate:modelValue":p[2]||(p[2]=V=>U.value=V)},null,8,["modelValue"]),e(Ce,{modelValue:f.value,"onUpdate:modelValue":p[3]||(p[3]=V=>f.value=V)},null,8,["modelValue"]),e(De,{modelValue:F.value,"onUpdate:modelValue":p[4]||(p[4]=V=>F.value=V)},null,8,["modelValue"]),e(E,{titre:i(r)("automatisations.exportation.sousSections.fréquence")},null,8,["titre"]),e(Xe,{modelValue:g.value,"onUpdate:modelValue":p[5]||(p[5]=V=>g.value=V)},null,8,["modelValue"]),e(Ue,{modelValue:d.value,"onUpdate:modelValue":p[6]||(p[6]=V=>d.value=V)},null,8,["modelValue"])]),_:1}),e(ae),e(_e,null,{default:t(()=>[e(Ve,{onClick:p[7]||(p[7]=V=>s.value=!1)}),e(ye,{actif:W.value,onClick:p[8]||(p[8]=()=>ne())},null,8,["actif"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ge=A({__name:"CarteAutomatisationImportation",props:{specification:{}},setup(c){const{$மொ:r}=T(),{mdAndUp:u}=I(),a=c,n=N(),s=x(!1),o=R(n.automatisations.suivreÉtatAutomatisations),_=q(()=>o.value?.[a.specification.id]);return(m,f)=>{const k=ge("nom-tableau");return v(),$(X,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g)},{activator:t(({props:g})=>[H(m.$slots,"activateur",K(Q({props:g})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,null,{default:t(()=>[e(k,{"id-tableau":c.specification.idTableau},null,8,["id-tableau"])]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(E,{titre:i(r)("automatisations.statut")},null,8,["titre"]),_.value?(v(),$(Fe,{key:0,statut:_.value},null,8,["statut"])):j("",!0),e(Se,{spécification:c.specification},null,8,["spécification"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"])}}}),Je=A({__name:"NouvelleAutomatisation",setup(c){const{$மொ:r}=T(),{mdAndUp:u}=I(),a=x(!1);return(n,s)=>(v(),$(X,{modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=o=>a.value=o)},{activator:t(({props:o})=>[H(n.$slots,"activateur",K(Q({props:o})))]),default:t(()=>[e(Y,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(L,null,{default:t(()=>[e(G,{class:"d-flex align-center"},{default:t(()=>[b(C(i(r)(""))+" Ajout d'automatisation ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:s[0]||(s[0]=o=>a.value=!1)})]),_:1})]),_:1}),e(J,null,{default:t(()=>[e(se,null,{default:t(()=>[e(he,null,{activateur:t(({props:o})=>[e(h,D({"prepend-icon":"mdi-import"},o),{default:t(()=>[...s[2]||(s[2]=[b(" Importer ",-1)])]),_:1},16)]),_:1}),e(Ae,null,{activateur:t(({props:o})=>[e(h,D({"prepend-icon":"mdi-export"},o),{default:t(()=>[...s[3]||(s[3]=[b(" Exporter ",-1)])]),_:1},16)]),_:1})]),_:1})]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ye={key:0},He={class:"my-6 text-center text-h5 text-disabled"},ut=A({__name:"PageAutomatisations",setup(c){const r=N(),{$மொ:u}=T(),{obtImageDéco:a}=be(),n=a("automatisation"),s=R(r.automatisations.suivreAutomatisations);return(o,_)=>(v(),$(qe,{class:"text-center"},{default:t(()=>[e(Ne,{titre:i(u)("pages.automatisations.titre"),image:i(n),"sous-titre":i(u)("pages.automatisations.sousTitre")},null,8,["titre","image","sous-titre"]),e(se,{class:"text-start"},{default:t(()=>[e(Je,{automatiser:""},{activateur:t(({props:m})=>[e(h,D(m,{"prepend-icon":"mdi-plus",title:i(u)("pages.automatisations.ajouterNouvelle.titre"),subtitle:i(u)("pages.automatisations.ajouterNouvelle.sousTitre")}),null,16,["title","subtitle"])]),_:1}),e(ae),i(s)?.length?j("",!0):(v(),S("div",Ye,[$e("p",He,C(i(u)("pages.automatisations.aucune")),1)])),(v(!0),S(z,null,we(i(s),m=>(v(),S(z,{key:m.id},[m.type==="exportation"?(v(),$(Le,{key:0,spécification:m,"objet-modifiable":""},{activateur:t(({props:f})=>[e(Te,D({ref_for:!0},f,{specification:m}),null,16,["specification"])]),_:2},1032,["spécification"])):(v(),$(Ge,{key:1,specification:m,"objet-modifiable":""},{activateur:t(({props:f})=>[e(Me,D({ref_for:!0},f,{specification:m}),null,16,["specification"])]),_:2},1032,["specification"]))],64))),128))]),_:1})]),_:1}))}});export{ut as default};
//# sourceMappingURL=PageAutomatisations-CVXGMmXh.js.map

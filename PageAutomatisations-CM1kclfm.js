import{q,h as i,d as T,p as N,ம as E,r as y,o as oe,cs as ue,c as $,a as f,M as A,w as t,F as C,b as e,j as O,f as b,t as D,G as ee,du as le,n as I,cw as re,v as ce,A as h,aW as B,a8 as me,bH as de,dv as pe,a1 as Z,K as S,dw as P,as as fe,Q as z,s as R,dx as ve,x as L,i as H,e as J,y as te,m as X,aL as M,R as ae,aj as _e,ak as Ve,al as ye,V as G,H as K,I as Q,J as W,c8 as xe,bR as ge,X as se,aB as be,aF as qe,z as $e,N as we}from"./index-wjx8jMps.js";import{o as ke}from"./action-meHMXXd6.js";import{g as ie,d as je,e as Ce,f as De,h as Fe,i as Se,j as Ue,_ as he,a as Ae,c as Te,b as Ee}from"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-AKSp-yE0.js";import{a as Me}from"./index-7zaNMxE6.js";import{_ as Ne}from"./TitrePage.vue_vue_type_script_setup_true_lang-CWPusMsf.js";import"./SélecteurNuée.vue_vue_type_script_setup_true_lang-BNTdbYzI.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-BSIKVS2X.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-k7tzkUR0.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-CvM0FBWu.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-C5Lfx5cI.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-DIDTbsxA.js";const Ie=()=>{const x=Me();return r=>{const u=i(r),a=q(()=>u?x.value.getTime()-u:void 0);return q(()=>{if(a.value!==void 0){const s=Math.abs(a.value),o=a.value<0?-1:1;return s<1e3?{unité:"millisecondes",n:s*o}:s<1e3*60?{unité:"secondes",n:Math.floor(s/1e3)*o}:s<1e3*60*60?{unité:"minutes",n:Math.floor(s/(1e3*60))*o}:s<1e3*60*60*24?{unité:"heures",n:Math.floor(s/(1e3*60*60))*o}:s<1e3*60*60*24*7?{unité:"jours",n:Math.floor(s/(1e3*60*60*24))*o}:s<1e3*60*60*24*30?{unité:"semaines",n:Math.floor(s/(1e3*60*60*24*7))*o}:s<1e3*60*60*24*365.25?{unité:"mois",n:Math.floor(s/(1e3*60*60*24*30))*o}:{unité:"années",n:Math.floor(s/(1e3*60*60*24*365.25))*o}}})}},Be=({t:x,clefs:r={dans:{millisecondes:"communs.temps.dans.ms",secondes:"communs.temps.dans.secondes",minutes:"communs.temps.dans.minutes",heures:"communs.temps.dans.heures",jours:"communs.temps.dans.jours",semaines:"communs.temps.dans.semaines",mois:"communs.temps.dans.mois",années:"communs.temps.dans.années"},depuis:{millisecondes:"communs.temps.depuis.ms",secondes:"communs.temps.depuis.secondes",minutes:"communs.temps.depuis.minutes",heures:"communs.temps.depuis.heures",jours:"communs.temps.depuis.jours",semaines:"communs.temps.depuis.semaines",mois:"communs.temps.depuis.mois",années:"communs.temps.depuis.années"}}})=>{const u=Ie();return a=>{const n=u(a);return q(()=>{if(n.value)return x(r[n.value.n<0?"dans":"depuis"][n.value.unité],{n:Math.abs(n.value.n)})})}},Pe=T({__name:"ItemStatutAutomatisation",props:{statut:{},spécification:{}},setup(x){const r=N(),{$மொ:u}=E(),a=Be({t:u}),n=x,s=q(()=>{switch(n.statut.type){case"erreur":return{icône:"mdi-alert",couleur:"error"};case"programmée":return{icône:"mdi-check",couleur:"success"};case"sync":return{icône:"mdi-sync",couleur:"primary"};case"écoute":return{icône:"",couleur:"success"};default:throw new Error(JSON.stringify(n.statut))}}),o=y(new Date().getTime());let v;oe(()=>{v=window.setInterval(()=>o.value=new Date().getTime(),1e3)}),ue(()=>{v&&clearInterval(v)});const c=async()=>{},p=a(q(()=>n.statut.type==="programmée"?n.statut.à:n.statut.type==="erreur"?n.statut.prochaineProgramméeÀ:void 0)),k=a(q(()=>n.statut.type==="sync"?n.statut.depuis:void 0)),g=q(()=>{switch(n.statut.type){case"écoute":return"automatisations.jetonStatut.écoute";case"sync":return u("automatisations.jetonStatut.sync",{depuis:k.value});case"programmée":return u("automatisations.jetonStatut.programmée",{dans:p.value});case"erreur":return n.statut.prochaineProgramméeÀ?u("automatisations.jetonStatut.erreurRéssayer",{dans:p.value}):"automatisations.jetonStatut.erreur";default:throw new Error(n.statut)}}),U=async()=>await r.automatisations.lancerManuellement({id:n.spécification.id});return(j,m)=>(f(),$(A,{title:"Ce dispositif"},{prepend:t(()=>[e(ee,{start:"",color:s.value.couleur},{default:t(()=>[b(D(s.value.icône),1)]),_:1},8,["color"])]),subtitle:t(()=>[b(D(i(u)(g.value)),1)]),default:t(()=>[j.spécification?.type==="exportation"?(f(),$(ie,{key:0,class:"my-2",spécification:j.spécification,onClick:m[0]||(m[0]=()=>c())},null,8,["spécification"])):C("",!0),e(O,{class:"my-2",size:"small",variant:"outlined","append-icon":"mdi-refresh",onClick:U},{default:t(()=>m[1]||(m[1]=[b(' "Relancer" ')])),_:1})]),_:1}))}}),ze={key:0},Oe={key:0,class:"d-flex"},Re={key:0,class:"d-flex mb-4"},Le=T({__name:"OptionsFréquenceExportation",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const r=le(x,"modelValue"),{mdAndUp:u}=I(),{$மொ:a}=E(),n=re(),s=[{value:"manuelle",title:"automatisations.fréquence.manuelle",sélection:"automatisations.exportation.fréquence.sélection.manuelle"},{value:"dynamique",title:"automatisations.fréquence.dynamique",sélection:"automatisations.exportation.fréquence.sélection.dynamique"},{value:"fixe",title:"automatisations.fréquence.fixe",sélection:"automatisations.exportation.fréquence.sélection.fixe"}],o=y(P?"manuelle":"fixe"),v=y(r.value?.type==="fixe"?r.value.détails.n.toString():"1"),c=q(()=>n.எண்ணுக்கு({உரை:v.value})),p=y("jours"),k=["années","mois","semaines","jours","heures","minutes","secondes","millisecondes"],g=m=>{try{return n.எண்ணுக்கு({உரை:m}),!0}catch{return a("règles.numérique")}},U=m=>(m|0)===m,j=()=>c.value!==void 0&&c.value>0&&U(c.value)?!0:a("règles.nombreEntierPositif");return ce(()=>{switch(o.value){case"manuelle":{const m={type:"manuelle"};r.value=m;break}case"dynamique":{const m={type:"dynamique"};r.value=m;break}case"fixe":{const m={type:"fixe",détails:{unités:p.value,n:c.value}};r.value=m;break}}}),(m,V)=>(f(),h(z,null,[e(B,{modelValue:o.value,"onUpdate:modelValue":V[2]||(V[2]=l=>o.value=l),class:me(i(u)?["mb-4"]:["mb-2"]),items:s,variant:"outlined",density:"compact","hide-details":""},de({item:t(({props:l,item:w})=>[e(A,S({...l,title:i(a)(w.title)},{disabled:i(P)&&(w.value==="manuelle"||w.value==="dynamique")}),{default:t(()=>[i(P)&&(w.value==="manuelle"||w.value==="dynamique")?(f(),h("span",ze,[e(ee,{size:"small",start:""},{default:t(()=>V[5]||(V[5]=[b(" mdi-alert-outline ")])),_:1}),b(" "+D(i(a)("automatisations.fréquence.pasSurNavig")),1)])):C("",!0)]),_:2},1040,["disabled"])]),selection:t(({item:l})=>[b(D(i(a)(l.raw.sélection)),1)]),_:2},[i(u)?{name:"append",fn:t(()=>[e(pe,null,{default:t(()=>[o.value==="fixe"?(f(),h("div",Oe,[e(Z,{modelValue:v.value,"onUpdate:modelValue":V[0]||(V[0]=l=>v.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,j]},null,8,["modelValue","rules"]),e(B,{modelValue:p.value,"onUpdate:modelValue":V[1]||(V[1]=l=>p.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(D(i(a)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(A,S(w,{title:i(a)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):C("",!0)]),_:1})]),key:"0"}:void 0]),1032,["modelValue","class"]),i(u)?C("",!0):(f(),$(fe,{key:0},{default:t(()=>[o.value==="fixe"?(f(),h("div",Re,[e(Z,{modelValue:v.value,"onUpdate:modelValue":V[3]||(V[3]=l=>v.value=l),variant:"outlined",density:"compact","hide-details":"",rules:[g,j]},null,8,["modelValue","rules"]),e(B,{modelValue:p.value,"onUpdate:modelValue":V[4]||(V[4]=l=>p.value=l),items:k,class:"ms-2",variant:"outlined",density:"compact","hide-details":""},{selection:t(({item:l})=>[b(D(i(a)(`automatisations.fréquence.unités.${l.raw}`)),1)]),item:t(({item:l,props:w})=>[e(A,S(w,{title:i(a)(`automatisations.fréquence.unités.${l.raw}`)}),null,16,["title"])]),_:1},8,["modelValue"])])):C("",!0)]),_:1}))],64))}}),He=T({__name:"CarteAutomatisationExportation",props:{spécification:{},objetModifiable:{type:Boolean}},setup(x){const{$மொ:r}=E(),{mdAndUp:u}=I(),a=x,n=N(),s=y(!1),o=ke(n.obtIdDispositif),v=R(n.automatisations.suivreÉtatAutomatisations),c=q(()=>v.value?.[a.spécification.id]),p=y(a.spécification.langues),k=y(a.spécification.dossier),g=y(a.spécification.fréquence),U=y(a.spécification.formatDoc),j=y(a.spécification.inclureDocuments),m=y(a.spécification.copies),V=y(a.spécification.dispositifs),l=q(()=>({id:a.spécification.id,type:"exportation",fréquence:g.value,idObjet:a.spécification.idObjet,typeObjet:a.spécification.typeObjet,formatDoc:U.value,dossier:k.value,langues:p.value,dispositifs:V.value,inclureDocuments:j.value,copies:m.value})),w=async()=>{const F=await xe();F&&(k.value=F)},Y=q(()=>!ve(l.value,a.spécification)),ne=async()=>{Y.value&&await n.automatisations.modifierAutomatisation({id:a.spécification.id,automatisation:l.value})};return(F,d)=>(f(),$(L,{modelValue:s.value,"onUpdate:modelValue":d[9]||(d[9]=_=>s.value=_)},{activator:t(({props:_})=>[K(F.$slots,"activateur",Q(W({props:_})))]),default:t(()=>[e(G,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,{class:"d-flex align-center"},{default:t(()=>[b(D(i(r)("automatisations.exportation.titreCarte"))+" ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:d[0]||(d[0]=_=>s.value=!1)})]),_:1})]),_:1}),e(X,{style:{"overflow-y":"scroll"}},{default:t(()=>[e(M,{titre:i(r)("automatisations.exportation.sousSections.statut"),"en-attente":!1},null,8,["titre"]),c.value?(f(),$(Pe,{key:0,statut:c.value,spécification:F.spécification},null,8,["statut","spécification"])):C("",!0),i(o)&&F.spécification.dispositifs.includes(i(o))?(f(),$(ie,{key:1,class:"my-2",spécification:F.spécification,onClick:d[1]||(d[1]=()=>w())},null,8,["spécification"])):C("",!0),e(M,{titre:i(r)("automatisations.exportation.sousSections.format"),"en-attente":!1},null,8,["titre"]),e(je,{modelValue:U.value,"onUpdate:modelValue":d[2]||(d[2]=_=>U.value=_)},null,8,["modelValue"]),e(Ce,{modelValue:p.value,"onUpdate:modelValue":d[3]||(d[3]=_=>p.value=_)},null,8,["modelValue"]),e(De,{modelValue:j.value,"onUpdate:modelValue":d[4]||(d[4]=_=>j.value=_)},null,8,["modelValue"]),e(M,{titre:i(r)("automatisations.exportation.sousSections.fréquence"),"en-attente":!1},null,8,["titre"]),e(Le,{modelValue:g.value,"onUpdate:modelValue":d[5]||(d[5]=_=>g.value=_)},null,8,["modelValue"]),e(Fe,{modelValue:m.value,"onUpdate:modelValue":d[6]||(d[6]=_=>m.value=_)},null,8,["modelValue"])]),_:1}),e(ae),e(_e,null,{default:t(()=>[e(Ve,{onClick:d[7]||(d[7]=_=>s.value=!1)}),e(ye,{actif:Y.value,onClick:d[8]||(d[8]=()=>ne())},null,8,["actif"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Je=T({__name:"CarteAutomatisationImportation",props:{specification:{}},setup(x){const{$மொ:r}=E(),{mdAndUp:u}=I(),a=x,n=N(),s=y(!1),o=R(n.automatisations.suivreÉtatAutomatisations),v=q(()=>o.value?.[a.specification.id]);return(c,p)=>{const k=ge("nom-tableau");return f(),$(L,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=g=>s.value=g)},{activator:t(({props:g})=>[K(c.$slots,"activateur",Q(W({props:g})))]),default:t(()=>[e(G,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,null,{default:t(()=>[e(k,{"id-tableau":c.specification.idTableau},null,8,["id-tableau"])]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(M,{titre:i(r)("automatisations.statut"),"en-attente":!1},null,8,["titre"]),v.value?(f(),$(Se,{key:0,statut:v.value},null,8,["statut"])):C("",!0),e(Ue,{spécification:c.specification},null,8,["spécification"])]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"])}}}),Xe=T({__name:"NouvelleAutomatisation",setup(x){const{$மொ:r}=E(),{mdAndUp:u}=I(),a=y(!1);return(n,s)=>(f(),$(L,{modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=o=>a.value=o)},{activator:t(({props:o})=>[K(n.$slots,"activateur",Q(W({props:o})))]),default:t(()=>[e(G,{class:"mx-auto","max-width":i(u)?500:300},{default:t(()=>[e(H,null,{default:t(()=>[e(J,{class:"d-flex align-center"},{default:t(()=>[b(D(i(r)(""))+" Ajout d'automatisation ",1),e(te),e(O,{icon:"mdi-close",size:"small",variant:"flat",onClick:s[0]||(s[0]=o=>a.value=!1)})]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(se,null,{default:t(()=>[e(he,null,{activateur:t(({props:o})=>[e(A,S({"prepend-icon":"mdi-import"},o),{default:t(()=>s[2]||(s[2]=[b(" Importer ")])),_:2},1040)]),_:1}),e(Ae,null,{activateur:t(({props:o})=>[e(A,S({"prepend-icon":"mdi-export"},o),{default:t(()=>s[3]||(s[3]=[b(" Exporter ")])),_:2},1040)]),_:1})]),_:1})]),_:1})]),_:1},8,["max-width"])]),_:3},8,["modelValue"]))}}),Ge={key:0},Ke={class:"my-6 text-center text-h5 text-disabled"},ut=T({__name:"PageAutomatisations",setup(x){const r=N(),{$மொ:u}=E(),{obtImageDéco:a}=be(),n=a("automatisation"),s=R(r.automatisations.suivreAutomatisations);return(o,v)=>(f(),$(qe,{class:"text-center"},{default:t(()=>[e(Ne,{titre:i(u)("pages.automatisations.titre"),image:i(n),"sous-titre":i(u)("pages.automatisations.sousTitre")},null,8,["titre","image","sous-titre"]),e(se,{class:"text-start"},{default:t(()=>[e(Xe,{automatiser:""},{activateur:t(({props:c})=>[e(A,S(c,{"prepend-icon":"mdi-plus",title:i(u)("pages.automatisations.ajouterNouvelle.titre"),subtitle:i(u)("pages.automatisations.ajouterNouvelle.sousTitre")}),null,16,["title","subtitle"])]),_:1}),e(ae),i(s)?.length?C("",!0):(f(),h("div",Ge,[$e("p",Ke,D(i(u)("pages.automatisations.aucune")),1)])),(f(!0),h(z,null,we(i(s),c=>(f(),h(z,{key:c.id},[c.type==="exportation"?(f(),$(He,{key:0,spécification:c,"objet-modifiable":""},{activateur:t(({props:p})=>[e(Te,S({ref_for:!0},p,{specification:c}),null,16,["specification"])]),_:2},1032,["spécification"])):(f(),$(Je,{key:1,specification:c,"objet-modifiable":""},{activateur:t(({props:p})=>[e(Ee,S({ref_for:!0},p,{specification:c}),null,16,["specification"])]),_:2},1032,["specification"]))],64))),128))]),_:1})]),_:1}))}});export{ut as default};
//# sourceMappingURL=PageAutomatisations-CM1kclfm.js.map

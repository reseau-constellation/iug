import{d as Q,ம as ue,p as de,s as C,q as v,c as b,a as c,w as t,f as E,b as e,t as T,h as a,R as ae,X as Ce,A as z,F as V,M as G,K as B,N as ie,Q as be,aq as Ae,H as xe,I as oe,J as se,az as De,n as Se,r as D,x as Te,V as F,i as ke,e as je,y as J,j as k,m as _e,Z as ve,B as ee,bB as le,bC as ze,G as K,v as Ie,bD as Xe,aj as Ee,ak as Ze,al as Ye,bE as Fe,bF as ea,bG as aa,aO as ta,bH as ia,ah as Ne,z as L,S as na,ai as te,bI as Ge,u as la,o as oa,aB as sa,bJ as ua,aF as da,bK as ra,aY as ca,aZ as ma,a_ as Pe,a$ as fa,bt as Le,bu as pa,bL as va,bM as Me,bN as ba,bO as _a,bP as xa,a8 as ya,bQ as ga,bR as Ba,bv as Oe,bw as Ca,bS as Ta,O as $e,a2 as ka,b0 as ja,aE as wa,T as Va,b1 as Re,W as $a}from"./index-DJQWYRVI.js";import{u as ha}from"./historiqueDocuments-BGOgfBaJ.js";import{_ as Qe,a as He,t as Ea,V as Aa,E as Da,b as Sa,c as We,d as Ia,e as Na,f as Pa,g as La,h as Ma,i as Oa,j as Ra,k as Ue}from"./VBreadcrumbs-5MAa214B.js";import{_ as Ua,a as qa,b as za,c as Fa}from"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-DJ1wODzm.js";import{_ as Ga}from"./ChoisirStatut.vue_vue_type_script_setup_true_lang-BXfymj8B.js";import{a as Qa,b as he}from"./SélecteurNuée.vue_vue_type_script_setup_true_lang-D70-wzx6.js";import{V as Ha}from"./VSwitch-BUvR_0yG.js";import{V as Wa,a as Ja}from"./VTabs-fgtgjuK8.js";import{V as qe}from"./VSlideGroupItem-BeU_TAJr.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-BvN0WUje.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-PRyZ1cxQ.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-B-w3_ZHS.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-GaUfsQwH.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-BUNEAPYZ.js";const Ka={key:0,class:"text-disabled text-h6 text-center"},Xa={key:0,class:"text-disabled text-h6 text-center"},Za=Q({__name:"CarteAutomatisationsBd",props:{idBd:{}},setup(S){const s=S,{$மொ:l}=ue(),p=de(),_=C(p.automatisations.suivreAutomatisations),d=C(p.bds.suivreTableauxBd,{idBd:v(()=>s.idBd)}),r=v(()=>{const j=(d.value||[]).filter(g=>g.id).map(g=>g.id);return _.value?.filter(g=>j.includes(g.type==="exportation"?g.idObjet:g.idTableau))}),$=v(()=>r.value?.filter(j=>j.type==="importation")||[]),N=v(()=>r.value?.filter(j=>j.type==="exportation")||[]);return(j,g)=>(c(),b(Qe,{"type-objet":"bd","id-objet":j.idBd},{activateur:t(({props:x})=>[xe(j.$slots,"activateur",oe(se({props:x})))]),default:t(()=>[E(" "+T(a(l)("automatisations.carte.importations"))+" ",1),e(ae),e(Ce,null,{default:t(()=>[e(Ua,{"id-bd":j.idBd},{activateur:t(({props:x})=>[e(G,B(x,{"prepend-icon":"mdi-upload-outline",title:a(l)("automatisations.carte.bds.ajouterImportationTableau")}),null,16,["title"])]),_:1},8,["id-bd"]),(c(!0),z(be,null,ie($.value,x=>(c(),b(za,{key:x.id,specification:x},null,8,["specification"]))),128)),$.value.length?V("",!0):(c(),z("p",Ka,T(a(l)("automatisations.carte.bds.aucuneImportationTableau")),1))]),_:1}),E(" "+T(a(l)("automatisations.carte.bds.exportationsTableaux"))+" ",1),e(ae),e(Ce,null,{default:t(()=>[e(qa,{"id-bd":j.idBd},{activateur:t(({props:x})=>[e(G,B({"prepend-icon":"mdi-download-outline"},x),{default:t(()=>[e(Ae,null,{default:t(()=>[E(T(a(l)("automatisations.carte.bds.ajouterExportationTableau")),1)]),_:1})]),_:2},1040)]),_:1},8,["id-bd"]),(c(!0),z(be,null,ie(N.value,x=>(c(),b(Fa,{key:x.id,specification:x},null,8,["specification"]))),128)),N.value.length?V("",!0):(c(),z("p",Xa,T(a(l)("automatisations.carte.bds.aucuneExportationTableau")),1))]),_:1})]),_:3},8,["id-objet"]))}}),Ya=Q({__name:"CarteCodeBd",props:{id:{}},setup(S){const s=S,{மொழி:l,மாற்றுமொழிகள்:p}=De(),_=v(()=>[l.value,...p.value]),d=v(()=>({ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.bds.suivreDonnéesExportation({
  idBd: "${s.id}",
  langues: [${_.value.map(r=>'"'+r+'"').join(", ")}],  // Modifier langues selon vos besoins
  f: monAnalyse
})
`,py:`from constellationPy import Serveur, ClientSync, tableau_exporté_à_pandas
    
with Serveur():
    client = ClientSync()

    données = client.obt_données_bd(
      idBd="${s.id}",
      # Modifier langues selon vos besoins
      langues=[${_.value.map(r=>'"'+r+'"').join(", ")}]
    )

    # Exporter les données
    données.exporter("fichier.ods")  # ou bien "fichier.xlsx" pour Excel

    # Accéder à un tableau en format pandas
    données_tableau = tableau_exporté_à_pandas(données["Un tableau"])
    
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "bds.suivreDonnéesExportation", 
        Dict([("idBd","${s.id}")])
    ) do résultat
        print(résultat)
    end
  end
end
`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "bds.suivreDonnéesExportation", 
      list(idBd="${s.id}")
    )
  }
)
`}));return(r,$)=>(c(),b(He,{codes:d.value,"langage-defaut":"py"},{activateur:t(({props:N})=>[xe(r.$slots,"activateur",oe(se({props:N})))]),_:3},8,["codes"]))}}),et=Q({__name:"CarteQualitéBd",props:{idBd:{}},setup(S){const{mdAndUp:s}=Se(),{$மொ:l}=ue(),p=S,_=de(),d=D(!1),r=C(_.bds.suivreQualitéBd,{idBd:v(()=>p.idBd)}),$=C(_.bds.suivreLicenceBd,{idBd:v(()=>p.idBd)}),N=C(_.bds.suivreLicenceContenuBd,{idBd:v(()=>p.idBd)}),j=C(_.suivrePermission,{idObjet:v(()=>p.idBd)});return(g,x)=>(c(),b(Te,{modelValue:d.value,"onUpdate:modelValue":x[1]||(x[1]=h=>d.value=h),"max-width":a(s)?500:300},{activator:t(({props:h})=>[xe(g.$slots,"activateur",oe(se({props:h})))]),default:t(()=>[e(F,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(je,{class:"d-flex align-center"},{default:t(()=>[E(T(a(l)("bds.qualité.titre"))+" ",1),e(J),e(k,{icon:"mdi-close",size:"small",variant:"flat",onClick:x[0]||(x[0]=h=>d.value=!1)})]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Ce,null,{default:t(()=>[e(G,null,{prepend:t(()=>[e(ve,null,{default:t(()=>[e(ee,{"model-value":(a(r)?.total||0)*100,width:5,indeterminate:a(r)?.total===void 0,color:a(le)(a(r)?.total).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>x[2]||(x[2]=[E("Score total")])),_:1}),e(ae),e(G,null,{prepend:t(()=>[e(ve,null,{default:t(()=>[e(ee,{"model-value":(a(r)?.accès||0)*100,width:5,indeterminate:a(r)?.accès===void 0,color:a(le)(a(r)?.accès).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>x[3]||(x[3]=[E("Accessibilité")])),_:1}),e(ze,{licence:a($),"licence-contenu":a(N),"permission-modifier":!!a(j)},{activateur:t(({props:h})=>[e(G,oe(se(h)),{prepend:t(()=>[e(ve,null,{default:t(()=>[a(r)?.licence===void 0?(c(),b(ee,{key:0,width:5,indeterminate:"",color:a(le)(a(r)?.licence).couleur},null,8,["color"])):V("",!0),e(K,{icon:a(r)?.licence?"mdi-check":"mdi-alert-circle-outline",color:a(le)(a(r)?.licence).couleur},null,8,["icon","color"])]),_:1})]),title:t(()=>[E(T(a(r)?.licence===void 0?a(l)("bds.qualité.rechercheLicence"):a(r).licence?a(l)("bds.qualité.licenceOuverte"):a(l)("bds.qualité.licenceNonReconnue")),1)]),_:2},1040)]),_:1},8,["licence","licence-contenu","permission-modifier"]),e(G,null,{prepend:t(()=>[e(ve,null,{default:t(()=>[e(ee,{"model-value":(a(r)?.valide||0)*100,width:5,indeterminate:a(r)?.valide===void 0,color:a(le)(a(r)?.valide).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>x[4]||(x[4]=[E("Validation données")])),_:1}),e(G,null,{prepend:t(()=>[e(ve,null,{default:t(()=>[e(ee,{"model-value":(a(r)?.couverture||0)*100,width:5,indeterminate:a(r)?.couverture===void 0,color:a(le)(a(r)?.couverture).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>x[5]||(x[5]=[E("Couverture tests")])),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue","max-width"]))}}),at=Q({__name:"CarteStatutBd",props:{idBd:{}},setup(S){const s=S,{$மொ:l}=ue(),{mdAndUp:p}=Se(),_=de(),d=D(!1),r=C(_.bds.suivreStatutBd,{idBd:v(()=>s.idBd)}),$=D();Ie(()=>{$.value=r.value});const N=v(()=>r.value?.statut!==$.value?.statut||r.value?.idNouvelle!==$.value?.idNouvelle),j=D(!1),g=async()=>{j.value=!0,$.value&&await _.bds.changerStatutBd({idBd:s.idBd,statut:Fe($.value)}),j.value=!1,d.value=!1};return(x,h)=>(c(),b(Te,{modelValue:d.value,"onUpdate:modelValue":h[3]||(h[3]=P=>d.value=P)},{activator:t(({props:P})=>[xe(x.$slots,"activateur",oe(se({props:P})))]),default:t(()=>[e(F,{class:"mx-auto","min-width":a(p)?500:300},{default:t(()=>[e(ke,null,{default:t(()=>[e(je,null,{default:t(()=>[E(T(a(l)("données.statut.carte.titre")),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Ga,{initial:$.value,onChoisir:h[0]||(h[0]=P=>$.value=P)},{sélecteur:t(({choisirNouvelle:P})=>[e(Xe,{multiples:!1,onSelectionnee:H=>P(H[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e(Ee,null,{default:t(()=>[e(J),e(Ze,{onClick:h[1]||(h[1]=P=>d.value=!1)}),e(Ye,{actif:N.value,"en-attente":j.value,onClick:h[2]||(h[2]=()=>g())},null,8,["actif","en-attente"])]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),tt=Q({__name:"ItemQualitéBd",props:{id:{}},setup(S){return(s,l)=>(c(),b(G,null,{prepend:t(()=>[e(aa,{id:s.id},null,8,["id"])]),default:t(()=>[e(Ae,null,{default:t(()=>[e(ea,{id:s.id},null,8,["id"])]),_:1})]),_:1}))}}),it=Q({__name:"ItemLicence",props:{licence:{}},setup(S){const s=de(),{$மொ:l}=ue(),p=S,_=C(s.licences.suivreLicences),d=v(()=>!!(p.licence&&_.value&&Object.keys(_.value).includes(p.licence)));return(r,$)=>(c(),b(G,null,{prepend:t(()=>[e(K,{start:"",color:d.value?"primary":"error"},{default:t(()=>[E(T(d.value?"mdi-scale-balance":"mdi-alert"),1)]),_:1},8,["color"])]),default:t(()=>[e(Ae,null,{default:t(()=>[E(T(d.value?a(l)(`licences.info.${r.licence}.abr`):r.licence),1)]),_:1})]),_:1}))}}),nt=Q({__name:"CarteCodeTableau",props:{idTableau:{}},setup(S){const s=S,{மொழி:l,மாற்றுமொழிகள்:p}=De(),_=v(()=>[l.value,...p.value]),d={ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.tableaux.suivreDonnéesExportation({
  idTableau: "${s.idTableau}",
  langues: [${_.value.map(r=>'"'+r+'"').join(", ")}],  // Modifier langues selon vos besoins
  f: monAnalyse
});
`,py:`from constellationPy import Serveur, ClientSync

with Serveur():
    client = ClientSync()

    données = client.obt_données_tableau(
      idTableau="${s.idTableau}"
      # Modifier langues selon vos besoins
      langues=[${_.value.map(r=>'"'+r+'"').join(", ")}]
    )

    # Analyser ou sauvegarder les données ici...
    données.to_excel("./MesDonnéesExportées.xlsx")
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "tableaux.suivreDonnéesExportation", 
        Dict([
          ("idTableau","${s.idTableau}"),
          ("langues", [${_.value.map(r=>'"'+r+'"').join(", ")}])
        ])
    ) do résultat
        print(résultat)
    end
  end
end

`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "tableaux.suivreDonnéesExportation", 
      list(
        idTableau="${s.idTableau}",
        langues=c(${_.value.map(r=>'"'+r+'"').join(", ")})
      )
    )
  }
)

`};return(r,$)=>(c(),b(He,{codes:d,"langage-defaut":"py"},{activateur:t(({props:N})=>[xe(r.$slots,"activateur",oe(se({props:N})))]),_:3}))}}),lt={class:"my-4 text-h6 text-disabled"},ot=Q({__name:"TableauBd",props:{idTableau:{},idBd:{}},setup(S){const{$மொ:s}=ue(),l=de(),p=S,_=C(l.suivrePermission,{idObjet:v(()=>p.idTableau)}),d=C(l.tableaux.suivreNomsTableau,{idTableau:v(()=>p.idTableau)}),r=C(l.tableaux.suivreVariables,{idTableau:v(()=>p.idTableau)}),$=C(l.tableaux.suivreColonnesTableau,{idTableau:v(()=>p.idTableau)}),N=C(l.tableaux.suivreColonnesEtCatégoriesTableau,{idTableau:v(()=>p.idTableau)}),j=v(()=>($.value||[]).map(o=>{const u=N.value?.find(n=>n.id===o.id)?.catégorie;return{key:o.id,sortable:u===void 0||(u?.type==="simple"?Ea(u.catégorie):!1),info:{index:o.index,catégorie:u,variable:o.variable}}})),g=v(()=>{const o={key:"actions",sortable:!1,info:{}};return[...j.value,o]}),x=async({idVariable:o,idColonne:u,index:n,règles:f})=>{u=await l.tableaux.ajouterColonneTableau({idTableau:p.idTableau,idVariable:o,idColonne:u}),n&&await l.tableaux.changerColIndex({idTableau:p.idTableau,idColonne:u,val:!0});for(const w of f)await l.tableaux.ajouterRègleTableau({idTableau:p.idTableau,idColonne:u,règle:w})},h=async({idColonne:o,index:u,règles:n})=>{await l.tableaux.changerColIndex({idTableau:p.idTableau,idColonne:o,val:u});for(const f of n.nouvelles)await l.tableaux.ajouterRègleTableau({idTableau:p.idTableau,idColonne:o,règle:f});for(const f of n.àEffacer)await l.tableaux.effacerRègleTableau({idTableau:p.idTableau,idRègle:f})},P=async({idColonne:o})=>{await l.tableaux.effacerColonneTableau({idTableau:p.idTableau,idColonne:o})},H=C(l.tableaux.suivreDonnées,{idTableau:v(()=>p.idTableau)}),ye=v(()=>{const o=H.value?.toSorted((n,f)=>re.value&&re.value.map(w=>n.données[w.key]===void 0?f.données[w.key]===void 0?0:w.order==="asc"?1:-1:f.données[w.key]===void 0?n.données[w.key]===void 0?0:w.order==="asc"?-1:1:n.données[w.key]>f.données[w.key]?w.order==="asc"?1:-1:n.données[w.key]<f.données[w.key]?w.order==="asc"?-1:1:0).find(w=>w!==0)||0),u={id:"-1",données:{}};return X.value&&o?[u,...o]:o}),re=D(),O=D([]),we=C(l.tableaux.suivreRègles,{idTableau:v(()=>p.idTableau)}),X=D(!1),ne=D(!1),Z=D(),R=v(()=>{const o=[];for(const[u,n]of Object.entries(Z.value||{})){const f=H.value?.find(w=>w.id===u);f&&U({modifs:n,original:f.données})&&o.push({idÉlément:u,vals:n})}return o}),ce=v(()=>R.value.length+(Object.keys(A.value).length?1:0)),U=({modifs:o,original:u})=>Object.keys(o).some(n=>u[n]!==o[n]),A=D({});Ie(()=>{X.value||(A.value={})});const M=v(()=>Object.keys(A.value).length>0),me=({val:o,idCol:u,idÉlément:n})=>{if(n==="-1")o!==void 0?A.value[u]=o:delete A.value[u];else{const f=Z.value||{};f[n]||(f[n]={}),f[n][u]=o,Z.value=f}},ge=async({vals:o})=>Object.fromEntries(await Promise.all(Object.entries(o).map(async([u,n])=>{if(n instanceof File){const f=await l.ajouterÀSFIP({contenu:new Uint8Array(await n.arrayBuffer()),nomFichier:n.name});return[u,f]}else return[u,n]}))),Be=async()=>{ne.value=!0;for(const{idÉlément:o,vals:u}of R.value)await l.tableaux.modifierÉlément({idTableau:p.idTableau,idÉlément:o,vals:await ge({vals:u})});M.value&&await fe(),Z.value=void 0,ne.value=!1},fe=async()=>{await l.tableaux.ajouterÉlément({idTableau:p.idTableau,vals:await ge({vals:A.value})}),A.value={}},pe=D(!1),W=D(!1),q=D(!1),Y=D(!1),m=D(!1);ta([Y,m],()=>{pe.value=W.value});const y=async({idÉlément:o})=>{q.value=!0,await l.tableaux.effacerÉlément({idTableau:p.idTableau,idÉlément:o}),q.value=!1},I=async()=>{q.value=!0,await Promise.all(O.value.map(o=>y({idÉlément:o}))),O.value=[],q.value=!1},i=async()=>{await l.bds.effacerTableauBd({idBd:p.idBd,idTableau:p.idTableau})};return(o,u)=>(c(),b(Aa,{modelValue:O.value,"onUpdate:modelValue":u[13]||(u[13]=n=>O.value=n),headers:g.value,items:ye.value,"show-select":!!a(_),"multi-sort":"","onUpdate:sortBy":u[14]||(u[14]=n=>re.value=n)},ia({top:t(()=>[e(Ia,{flat:"",density:"compact"},{default:t(()=>[e(J),a(_)?(c(),b(k,{key:0,icon:"",disabled:!ce.value,onClick:u[0]||(u[0]=()=>Be())},{default:t(()=>[ce.value?(c(),b(na,{key:0,color:"success",content:ce.value},{default:t(()=>[e(K,{color:"primary",icon:"mdi-content-save-outline"})]),_:1},8,["content"])):(c(),b(K,{key:1,color:"primary",icon:"mdi-content-save-check-outline"}))]),_:1},8,["disabled"])):V("",!0),a(_)?(c(),b(Ha,{key:1,modelValue:X.value,"onUpdate:modelValue":u[1]||(u[1]=n=>X.value=n),class:"me-4",density:"compact",color:"primary","true-icon":"mdi-pencil-outline","false-icon":"mdi-pencil-off-outline","hide-details":""},null,8,["modelValue"])):V("",!0),a(_)?(c(),b(Qa,{key:2,"id-tableau":o.idTableau,"variables-interdites":a(r),onNouvelle:u[2]||(u[2]=n=>x(n))},{activateur:t(({props:n})=>[e(k,B(n,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):V("",!0),e(nt,{"id-tableau":o.idTableau,"pour-nuee":!1},{activateur:t(({props:n})=>[e(te,{text:a(s)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(k,B({...n,...f},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-tableau"]),e(Qe,{"id-objet":o.idTableau,"type-objet":"tableau"},{activateur:t(({props:n})=>[e(te,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(k,B({...n,...f},{icon:"mdi-sync"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(We,{"id-objet":o.idTableau,"noms-objet":a(d),"type-objet":"tableau"},{activateur:t(({props:n})=>[e(te,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(k,B({...n,...f},{icon:"mdi-download"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),a(_)?(c(),b(Ge,{key:3,onEffacer:u[3]||(u[3]=()=>i())},{activateur:t(({props:n})=>[e(k,B(n,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):V("",!0)]),_:1})]),"no-data":t(()=>[L("p",lt,T(a(s)("tableaux.aucuneDonnée")),1),V("",!0)]),"item.actions":t(({item:n})=>[n.id==="-1"?(c(),b(k,{key:0,disabled:!M.value,icon:"mdi-content-save-outline",size:"small",variant:"flat",onClick:u[9]||(u[9]=()=>fe())},null,8,["disabled"])):pe.value&&a(_)?(c(),b(k,{key:1,size:"small",icon:"mdi-delete",variant:"flat",loading:q.value,onClick:()=>y({idÉlément:n.id})},null,8,["loading","onClick"])):a(_)?(c(),b(Te,{key:2,modelValue:Y.value,"onUpdate:modelValue":u[12]||(u[12]=f=>Y.value=f)},{activator:t(({props:f})=>[e(k,B(f,{variant:"flat",icon:"mdi-delete",size:"small",loading:q.value}),null,16,["loading"])]),default:t(()=>[e(F,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(ke,null,{default:t(()=>[e(je,null,{default:t(()=>[E(T(a(s)("tableaux.données.titreEffacer")),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Ne,{modelValue:W.value,"onUpdate:modelValue":u[10]||(u[10]=f=>W.value=f),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(Ee,null,{default:t(()=>[e(J),e(k,{variant:"text",text:a(s)("communs.oui"),onClick:()=>{y({idÉlément:n.id}),Y.value=!1}},null,8,["text","onClick"]),e(k,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:u[11]||(u[11]=f=>Y.value=!1)},null,8,["text"]),e(J)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])):V("",!0)]),_:2},[ie(j.value||[],n=>({name:`header.${n.key}`,fn:t(({column:f,isSorted:w,getSortIcon:Je,toggleSort:Ke})=>[e(Da,{"id-colonne":n.key,"id-variable":n.info.variable,"id-tableau":o.idTableau,index:!!n.info.index,regles:a(we)?.filter(Ve=>Ve.colonne===n.key),"permission-modifier":!!a(_),ordonnable:f.sortable,"est-ordonnee":w(f),"icone-ordonner":Je(f),onBasculerOrdonner:()=>Ke(f),onSauvegarder:Ve=>h({idColonne:n.key,...Ve}),onEffacer:()=>P({idColonne:n.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),a(_)?{name:"header.actions",fn:t(()=>[pe.value?(c(),b(k,{key:0,icon:"mdi-delete",variant:"flat",size:"small",loading:q.value,readonly:!O.value.length,onClick:u[4]||(u[4]=()=>I())},null,8,["loading","readonly"])):(c(),b(Te,{key:1,modelValue:m.value,"onUpdate:modelValue":u[8]||(u[8]=n=>m.value=n)},{activator:t(({props:n})=>[e(k,B(n,{icon:"",variant:"flat",size:"small",readonly:!O.value.length,loading:q.value}),{default:t(()=>[e(K,{icon:"mdi-delete",color:O.value.length?void 0:"disabled"},null,8,["color"])]),_:2},1040,["readonly","loading"])]),default:t(()=>[e(F,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(ke,null,{default:t(()=>[e(je,null,{default:t(()=>[E(T(a(s)("tableaux.données.titreEffacerSélectionnées",O.value.length)),1)]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Ne,{modelValue:W.value,"onUpdate:modelValue":u[5]||(u[5]=n=>W.value=n),label:a(s)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(Ee,null,{default:t(()=>[e(J),e(k,{variant:"text",text:a(s)("communs.oui"),onClick:u[6]||(u[6]=()=>{I(),m.value=!1})},null,8,["text"]),e(k,{variant:"text",color:"primary",text:a(s)("communs.non"),onClick:u[7]||(u[7]=n=>m.value=!1)},null,8,["text"]),e(J)]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),key:"0"}:void 0,ie(j.value,n=>({name:`item.${n.key}`,fn:t(({item:f})=>[e(Sa,{categorie:n.info.catégorie?.catégorie,val:f.données[n.key],editable:!!a(_)&&X.value,onModifiee:({val:w})=>me({idCol:n.key,idÉlément:f.id,val:w})},null,8,["categorie","val","editable","onModifiee"])])}))]),1032,["modelValue","headers","items","show-select"]))}}),st={class:"text-center"},ut={class:"text-center"},dt={key:0,class:"text-disabled"},rt={class:"text-center"},ct={class:"mt-6 text-h5"},mt={class:"d-flex flex-wrap"},ft={class:"mt-6 text-h5"},pt={key:0,class:"text-disabled"},vt={class:"mt-6 text-h5"},bt={key:2,class:"text-center"},_t={class:"text-h5 mt-5"},Dt=Q({__name:"PageBd",props:{id:{}},setup(S){const s=S,l=de(),{mdAndUp:p}=Se(),{isRtl:_}=la(),{$மொ:d}=ue(),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:r}=De(),{obtImageDéco:$}=sa(),N=ha();oa(()=>{N.documentOuvert({id:s.id,à:Date.now()})});const j=$("vide"),g=C(l.suivrePermission,{idObjet:v(()=>s.id)}),x=C(l.bds.suivreNomsBd,{idBd:v(()=>s.id)}),h=r(x),P=async m=>{const{àEffacer:y,àAjouter:I}=Re({anciennes:x.value,nouvelles:m});for(const i of y)await l.bds.effacerNomBd({idBd:s.id,langue:i});await l.bds.sauvegarderNomsBd({idBd:s.id,noms:I})},H=C(l.bds.suivreDescriptionsBd,{idBd:v(()=>s.id)}),ye=r(H),re=async m=>{const{àEffacer:y,àAjouter:I}=Re({anciennes:H.value,nouvelles:m});for(const i of y)await l.bds.effacerDescriptionBd({idBd:s.id,langue:i});await l.bds.sauvegarderDescriptionsBd({idBd:s.id,descriptions:I})},O=ua(C(l.bds.suivreImage,{idBd:v(()=>s.id)})),we=$("logoBD"),X=async m=>{m?await l.bds.sauvegarderImage({idBd:s.id,image:{contenu:new Uint8Array(m.contenu),nomFichier:m.fichier}}):await l.bds.effacerImage({idBd:s.id})},ne=C(l.bds.suivreStatutBd,{idBd:v(()=>s.id)}),Z=C(l.bds.suivreVariablesBd,{idBd:v(()=>s.id)}),R=C(l.bds.suivreMotsClefsBd,{idBd:v(()=>s.id)}),ce=async m=>{const y=m.filter(i=>!R.value?.includes(i)),I=R.value?.filter(i=>!m.includes(i))||[];await l.bds.ajouterMotsClefsBd({idBd:s.id,idsMotsClefs:y}),await Promise.all(I.map(i=>l.bds.effacerMotClefBd({idBd:s.id,idMotClef:i})))},U=C(l.bds.suivreTableauxBd,{idBd:v(()=>s.id)}),A=D();Ie(()=>{!A.value&&U.value?.length&&(A.value=U.value[0].clef),A.value&&!U.value?.map(m=>m.clef).includes(A.value)&&(A.value=void 0)});const M=D(!1),me=async({noms:m,cols:y})=>{M.value=!0;try{const I=await l.bds.ajouterTableauBd({idBd:s.id});await l.tableaux.sauvegarderNomsTableau({idTableau:I,noms:Fe(m)}),await Promise.all(y.map(async i=>{await l.tableaux.ajouterColonneTableau({idTableau:I,idColonne:i.info.id,idVariable:i.info.variable}),i.info.index&&await l.tableaux.changerColIndex({idTableau:I,idColonne:i.info.id,val:!0}),await Promise.all(i.règles.map(async o=>await l.tableaux.ajouterRègleTableau({idTableau:I,idColonne:i.info.id,règle:o})))}))}finally{M.value=!1}},ge=async m=>{await l.bds.effacerTableauBd({idBd:s.id,idTableau:m})},Be=C(l.réseau.suivreAuteursBd,{idBd:v(()=>s.id)}),fe=C(l.bds.suivreLicenceBd,{idBd:v(()=>s.id)}),pe=C(l.bds.suivreLicenceContenuBd,{idBd:v(()=>s.id)}),W=async({licence:m,licenceContenu:y})=>{await l.bds.changerLicenceBd({idBd:s.id,licence:m}),y&&await l.bds.changerLicenceContenuBd({idBd:s.id,licenceContenu:y})},q=v(()=>[{title:d("navigation.données"),href:encodeURI("/données/")},{title:h.value||d("bds.sansNom"),disabled:!0}]),Y=async()=>{await l.bds.effacerBd({idBd:s.id})};return(m,y)=>{const I=Ba("carte-replications-objet");return c(),b(da,null,{default:t(()=>[L("div",null,[a(p)?(c(),b(Na,{key:0,items:q.value,class:"pa-0"},{divider:t(()=>[e(K,null,{default:t(()=>[E(T(a(_)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:t(({item:i})=>[e(Pa,{disabled:i.disabled,onClick:o=>i.href&&m.$router.push(i.href)},{default:t(()=>[e(ra,{texte:i.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(c(),b(k,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:y[0]||(y[0]=()=>m.$router.push(encodeURI("/données/")))}))]),e(ma,{"src-image":a(O),"img-defaut":a(we),editable:!!a(g),"taille-avatar":a(p)?275:175,"max-taille-image":a(ca),onImageChangee:y[1]||(y[1]=i=>X(i))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),L("div",st,[e(Pe,{"etiquette-nom":a(d)("objet.étiquetteNom"),"indice-nom":a(d)("objet.indiceNom"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucunNom"),"noms-initiaux":a(x),titre:a(d)("objet.titreDialogueNoms"),"sous-titre":a(d)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!a(g),onAjusterNoms:P},{activateur:t(({props:i})=>[L("span",B(i,{class:"text-h4"}),[E(T(a(h)||a(d)("bds.sansNom"))+" ",1),e(k,{icon:a(g)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(fa,{id:m.id},null,8,["id"]),e(J)]),L("div",ut,[e(Me,{"n-max":5,items:a(R)},{jeton:t(({id:i})=>[e(Le,{id:i},{activateur:t(({props:o})=>[e(va,B(o,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Le,{id:i},{activateur:t(({props:o})=>[e(pa,B(o,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(R)&&!a(R).length?(c(),z("span",dt,T(a(d)("bds.aucunMotClef")),1)):V("",!0),a(g)&&a(R)?(c(),b(ba,{key:1,originaux:a(R),onSauvegarder:y[2]||(y[2]=i=>ce(i))},null,8,["originaux"])):V("",!0)]),L("div",rt,[e(xa,{"id-bd":m.id},{activateur:t(({props:i})=>[e(te,{"open-delay":"200",location:"bottom",text:a(d)("épingler.épingler")},{activator:t(({props:o})=>[e(k,B({...i,...o},{icon:"",variant:"flat"}),{default:t(()=>[e(_a,{id:m.id},null,8,["id"])]),_:2},1040)]),_:2},1032,["text"])]),_:1},8,["id-bd"]),e(We,{"id-objet":m.id,"noms-objet":a(x),"type-objet":"bd"},{activateur:t(({props:i})=>[e(te,{text:a(d)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:o})=>[e(k,B({...i,...o},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),e(Ya,{id:m.id},{activateur:t(({props:i})=>[e(te,{text:a(d)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:o})=>[e(k,B({...i,...o},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),V("",!0),a(g)?(c(),b(Ge,{key:1,onEffacer:Y},{activateur:t(({props:i})=>[e(te,{"open-delay":"200",location:"bottom",text:a(d)("effacer.indice")},{activator:t(({props:o})=>[e(k,B({...i,...o},{variant:"flat",icon:""}),{default:t(()=>[e(K,{color:"error"},{default:t(()=>y[7]||(y[7]=[E("mdi-delete")])),_:1})]),_:2},1040)]),_:2},1032,["text"])]),_:1})):V("",!0)]),e(ae),e(_e,null,{default:t(()=>[e(Pe,{"etiquette-nom":a(d)("objet.étiquetteDescription"),"indice-nom":a(d)("objet.indiceDescription"),"indice-langue":a(d)("objet.indiceLangue"),"texte-aucun-nom":a(d)("objet.texteAucuneDescription"),"noms-initiaux":a(H),titre:a(d)("objet.titreDialogueDescriptions"),"sous-titre":a(d)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!a(g),longue:"",onAjusterNoms:re},{activateur:t(({props:i})=>[L("span",{class:ya({"text-disabled":!a(ye)})},T(a(ye)||a(d)("communs.baseCarteObjet.sansDescription")),3),e(k,B(i,{icon:a(g)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),L("p",ct,T(a(d)("bds.info")),1),e(ae,{class:"mb-2"}),L("div",mt,[a(ne)&&(a(ne).statut!=="active"||a(g))?(c(),b(F,{key:0,flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(at,{"id-bd":m.id},{activateur:t(({props:i})=>[e(La,B(i,{"type-objet":"bd",statut:a(ne)}),null,16,["statut"])]),_:1},8,["id-bd"])]),_:1})):V("",!0),e(F,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(et,{"id-bd":m.id},{activateur:t(({props:i})=>[e(tt,B(i,{id:m.id}),null,16,["id"])]),_:1},8,["id-bd"])]),_:1}),e(F,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ga,{id:m.id,auteurs:a(Be),"permission-moderateur":a(g)==="MODÉRATEUR"},{activateur:t(({props:i})=>[e(Ma,B(i,{auteurs:a(Be)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(F,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ze,{licence:a(fe),"licence-contenu":a(pe),"permission-modifier":a(g)==="MODÉRATEUR",onChangerLicence:W},{activateur:t(({props:i})=>[e(it,B(i,{licence:a(fe),onChangerLicence:W}),null,16,["licence"])]),_:1},8,["licence","licence-contenu","permission-modifier"])]),_:1}),e(F,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(I,{id:m.id},{activator:t(({props:i})=>[e(Oa,B(i,{id:m.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(F,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Za,{"id-bd":m.id,permission:a(g),"type-objet":"bd"},{activateur:t(({props:i})=>[e(Ra,B(i,{"id-objet":m.id}),null,16,["id-objet"])]),_:1},8,["id-bd","permission"])]),_:1})]),L("p",ft,T(a(d)("bds.variables")),1),e(ae,{class:"mb-2"}),e(Me,{"n-max":5,items:a(Z)},{jeton:t(({id:i})=>[e(Oe,{id:i},{activateur:t(({props:o})=>[e(Ta,B(o,{id:i,class:"me-1 mb-1"}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Oe,{id:i},{activateur:t(({props:o})=>[e(Ca,B(o,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(Z)?.length?V("",!0):(c(),z("p",pt,T(a(d)("bds.aucuneVariable")),1)),e(Ce,null,{default:t(()=>[L("p",vt,T(a(d)("bds.tableaux")),1),e(ae),a(p)?(c(),b(Wa,{key:0,modelValue:A.value,"onUpdate:modelValue":y[4]||(y[4]=i=>A.value=i),class:"mt-2"},{default:t(()=>[(c(!0),z(be,null,ie(a(U),i=>(c(),b(Ja,{key:i.clef,value:i.clef,color:"primary",size:"small",density:"compact"},{default:t(()=>[e(Ue,{id:i.id,clef:i.clef,onEffacer:()=>ge(i.id)},null,8,["id","clef","onEffacer"])]),_:2},1032,["value"]))),128)),e(he,{onSauvegarder:me},{activateur:t(({props:i})=>[a(g)?(c(),b($e,B({key:0},i,{"append-icon":M.value?void 0:"mdi-plus",disabled:M.value,variant:"text",class:"mx-1 my-auto",size:"x-large",label:"",onClick:y[3]||(y[3]=ka(()=>{},["stop"]))}),{default:t(()=>[E(T(a(d)("tableaux.nouveau"))+" ",1),M.value?(c(),b(ee,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):V("",!0)]),_:2},1040,["append-icon","disabled"])):V("",!0)]),_:1})]),_:1},8,["modelValue"])):(c(),b(ja,{key:1,modelValue:A.value,"onUpdate:modelValue":y[5]||(y[5]=i=>A.value=i),class:"mt-4","show-arrows":"","center-active":""},{default:t(()=>[(c(!0),z(be,null,ie(a(U),i=>(c(),b(qe,{key:i.clef,value:i.clef},{default:t(({isSelected:o,toggle:u})=>[e($e,{class:"mx-1",variant:"tonal",label:"",active:!1,color:o?"primary":"",onClick:u},{default:t(()=>[e(Ue,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(qe,{key:"nouveau",value:"nouveau"},{default:t(()=>[e(he,{onSauvegarder:me},{activateur:t(({props:i})=>[a(g)?(c(),b($e,B({key:0},i,{"append-icon":M.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:M.value}),{default:t(()=>[E(T(a(d)("tableaux.nouveau"))+" ",1),M.value?(c(),b(ee,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):V("",!0)]),_:2},1040,["append-icon","disabled"])):V("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),a(U)&&!a(U).length?(c(),z("div",bt,[L("p",_t,T(a(d)("tableaux.aucun")),1),e(wa,{src:a(j),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e(he,{onSauvegarder:me},{activateur:t(({props:i})=>[a(g)?(c(),b(k,B({key:0},i,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:t(()=>[e(K,{icon:"mdi-table",start:""})]),default:t(()=>[E(" "+T(a(d)("tableaux.nouveau")),1)]),_:2},1040)):V("",!0)]),_:1})])):V("",!0)]),_:1}),e(Va,{modelValue:A.value,"onUpdate:modelValue":y[6]||(y[6]=i=>A.value=i)},{default:t(()=>[(c(!0),z(be,null,ie(a(U),i=>(c(),b($a,{key:i.clef,value:i.clef},{default:t(()=>[e(ot,{"id-tableau":i.id,"id-bd":m.id},null,8,["id-tableau","id-bd"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Dt as default};
//# sourceMappingURL=PageBd-DAibdda8.js.map

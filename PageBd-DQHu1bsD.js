import{d as Y,q as _,c as p,a as u,w as t,H as De,I as ge,J as xe,n as Ae,க as ve,p as pe,r as E,s as k,x as Be,h as a,b as e,V as z,i as Ce,e as ke,f as D,t as T,y as G,j as C,m as fe,X as Me,M as Z,Z as ue,B as J,bB as te,R as ce,bC as qe,F as h,G as Q,v as Ee,bD as Xe,ao as he,bE as ze,as as Fe,bF as Ze,bG as Je,aO as Ye,bH as ea,N as me,am as Se,K as B,z as L,S as aa,an as le,bI as Ge,u as ta,ம as ia,o as la,aC as na,bJ as oa,aG as sa,bK as da,aY as ra,aZ as ua,a_ as Ie,a$ as ca,A as ie,bt as Ne,bu as ma,bL as fa,bM as Le,bN as va,bO as pa,bP as ba,a8 as _a,bQ as ya,bR as ga,bv as Pe,bw as xa,bS as Ba,Q as we,O as je,a2 as Ca,b0 as ka,aF as Va,T as Ta,b1 as Oe,W as wa}from"./index-fdjmi-3N.js";import{u as ja}from"./historiqueDocuments-CsTY8Dva.js";import{_ as $a,t as ha,V as Da,E as Aa,a as Ea,b as Qe,c as He,d as Sa,e as Ia,f as Na,g as La,h as Pa,i as Oa,j as Ra,k as Re}from"./VBreadcrumbs-BAy-2Xsc.js";import{_ as Ua}from"./ChoisirStatut.vue_vue_type_script_setup_true_lang-BQnqr8Do.js";import{a as Ma,b as $e}from"./SélecteurNuée.vue_vue_type_script_setup_true_lang-DS2LbELM.js";import{V as qa}from"./VSwitch-CxBQ2d9q.js";import{V as za,a as Fa}from"./VTabs-Db1F3xCA.js";import{V as Ue}from"./VSlideGroupItem-CiMpCDlV.js";import"./OptionsFormatExportation.vue_vue_type_script_setup_true_lang-Bo0D29R9.js";import"./RésultatRechercheProjet.vue_vue_type_script_setup_true_lang-C2IciwZA.js";import"./CarteProjet.vue_vue_type_script_setup_true_lang-DZeWR0_H.js";import"./NouveauProjet.vue_vue_type_script_setup_true_lang-7WW-HByC.js";import"./RésultatRechercheNuée.vue_vue_type_script_setup_true_lang-BQ8HWNdd.js";import"./CarteNuée.vue_vue_type_script_setup_true_lang-BHcSStYY.js";const Ga=Y({__name:"CarteCodeBd",props:{id:{}},setup(I){const d=I,o=_(()=>({ts:`import { créerConstellation } from "@constl/ipa";

const client = créerConstellation();

const monAnalyse = async (données) => {
  console.log(données)
  // Faire quelque chose...
}

const fOublier = client.bds.suivreDonnéesExportation({
  idBd: "${d.id}",
  f: monAnalyse
})
`,py:`from constellationPy import Serveur, ClientSync
    
with Serveur():
    client = ClientSync()

    données = client.bds.suivreDonnéesExportation(
      idBd="${d.id}"
    )
`,julia:`import Constellation

Constellation.avecServeur() do port
  Constellation.avecClient(port) do client

    oublier = Constellation.suivre(
        client, 
        "bds.suivreDonnéesExportation", 
        Dict([("idBd","${d.id}")])
    ) do résultat
        print(résultat)
    end
  end
end
`,r:`library(constellationR)

constellationR::avecClientEtServeur(
  function (client) {
    
    données <- client$appeler(
      "bds.suivreDonnéesExportation", 
      list(idBd="${d.id}")
    )
  }
)
`}));return(v,y)=>(u(),p($a,{codes:o.value},{activator:t(({props:x})=>[De(v.$slots,"activator",ge(xe({props:x})))]),_:3},8,["codes"]))}}),Qa=Y({__name:"CarteQualitéBd",props:{idBd:{}},setup(I){const{mdAndUp:d}=Ae(),{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),y=I,x=pe(),s=E(!1),g=k(x.bds.suivreQualitéBd,{idBd:_(()=>y.idBd)}),S=k(x.bds.suivreLicenceBd,{idBd:_(()=>y.idBd)}),H=k(x.bds.suivreLicenceContenuBd,{idBd:_(()=>y.idBd)}),P=k(x.suivrePermission,{idObjet:_(()=>y.idBd)});return(j,w)=>(u(),p(Be,{modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=A=>s.value=A),"max-width":a(d)?500:300},{activator:t(({props:A})=>[De(j.$slots,"activator",ge(xe({props:A})))]),default:t(()=>[e(z,null,{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,{class:"d-flex"},{default:t(()=>[D(T(a(v)("bds.qualité.titre"))+" ",1),e(G),e(C,{icon:"mdi-close",size:"small",variant:"flat",onClick:w[0]||(w[0]=A=>s.value=!1)})]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Me,null,{default:t(()=>[e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(g)?.total||0)*100,width:5,indeterminate:a(g)?.total===void 0,color:a(te)(a(g)?.total).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>w[2]||(w[2]=[D("Score total")])),_:1}),e(ce),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(g)?.accès||0)*100,width:5,indeterminate:a(g)?.accès===void 0,color:a(te)(a(g)?.accès).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>w[3]||(w[3]=[D("Accessibilité")])),_:1}),e(qe,{licence:a(S),"licence-contenu":a(H),"permission-modifier":!!a(P)},{activator:t(({props:A})=>[e(Z,ge(xe(A)),{prepend:t(()=>[e(ue,null,{default:t(()=>[a(g)?.licence===void 0?(u(),p(J,{key:0,width:5,indeterminate:"",color:a(te)(a(g)?.licence).couleur},null,8,["color"])):h("",!0),e(Q,{icon:a(g)?.licence?"mdi-check":"mdi-alert-circle-outline",color:a(te)(a(g)?.licence).couleur},null,8,["icon","color"])]),_:1})]),title:t(()=>[D(T(a(g)?.licence===void 0?a(v)("bds.qualité.rechercheLicence"):a(g).licence?a(v)("bds.qualité.licenceOuverte"):a(v)("bds.qualité.licenceNonReconnue")),1)]),_:2},1040)]),_:1},8,["licence","licence-contenu","permission-modifier"]),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(g)?.valide||0)*100,width:5,indeterminate:a(g)?.valide===void 0,color:a(te)(a(g)?.valide).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>w[4]||(w[4]=[D("Validation données")])),_:1}),e(Z,null,{prepend:t(()=>[e(ue,null,{default:t(()=>[e(J,{"model-value":(a(g)?.couverture||0)*100,width:5,indeterminate:a(g)?.couverture===void 0,color:a(te)(a(g)?.couverture).couleur},null,8,["model-value","indeterminate","color"])]),_:1})]),title:t(()=>w[5]||(w[5]=[D("Couverture tests")])),_:1})]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue","max-width"]))}}),Ha=Y({__name:"CarteStatutBd",props:{idBd:{}},setup(I){const d=I,{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),{mdAndUp:y}=Ae(),x=pe(),s=E(!1),g=k(x.bds.suivreStatutBd,{idBd:_(()=>d.idBd)}),S=E();Ee(()=>{S.value=g.value});const H=_(()=>g.value?.statut!==S.value?.statut||g.value?.idNouvelle!==S.value?.idNouvelle),P=E(!1),j=async()=>{P.value=!0,S.value&&await x.bds.changerStatutBd({idBd:d.idBd,statut:ze(S.value)}),P.value=!1,s.value=!1};return(w,A)=>(u(),p(Be,{modelValue:s.value,"onUpdate:modelValue":A[2]||(A[2]=N=>s.value=N)},{activator:t(({props:N})=>[De(w.$slots,"activator",ge(xe({props:N})))]),default:t(()=>[e(z,{class:"mx-auto","min-width":a(y)?500:300},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[D(T(a(v)("données.statut.carte.titre")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Ua,{initial:S.value,onChoisir:A[0]||(A[0]=N=>S.value=N)},{sélecteur:t(({choisirNouvelle:N})=>[e(Xe,{multiples:!1,onSelectionnee:F=>N(F[0])},null,8,["onSelectionnee"])]),_:1},8,["initial"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(C,{disabled:!H.value,loading:P.value,variant:"flat",color:"primary",onClick:j},{default:t(()=>[D(T(a(v)("communs.sauvegarder")),1)]),_:1},8,["disabled","loading"]),e(C,{variant:"flat","append-icon":"mdi-close",onClick:A[1]||(A[1]=N=>s.value=!1)},{default:t(()=>[D(T(a(v)("communs.fermer")),1)]),_:1})]),_:1})]),_:1},8,["min-width"])]),_:3},8,["modelValue"]))}}),Wa=Y({__name:"ItemQualitéBd",props:{id:{}},setup(I){return(d,o)=>(u(),p(Z,null,{prepend:t(()=>[e(Je,{id:d.id},null,8,["id"])]),default:t(()=>[e(Fe,null,{default:t(()=>[e(Ze,{id:d.id},null,8,["id"])]),_:1})]),_:1}))}}),Ka=Y({__name:"ItemLicence",props:{licence:{}},setup(I){const d=pe(),{மொழியாக்கம்_பயன்படுத்து:o}=ve(),{$மொ:v}=o(),y=I,x=k(d.licences.suivreLicences),s=_(()=>y.licence&&x.value&&Object.keys(x.value).includes(y.licence));return(g,S)=>(u(),p(Z,null,{prepend:t(()=>[e(Q,{start:"",color:s.value?"primary":"error"},{default:t(()=>[D(T(s.value?"mdi-scale-balance":"mdi-alert"),1)]),_:1},8,["color"])]),default:t(()=>[e(Fe,null,{default:t(()=>[D(T(s.value?a(v)(`licences.info.${g.licence}.abr`):g.licence),1)]),_:1})]),_:1}))}}),Xa={class:"my-4 text-h6 text-disabled"},Za=Y({__name:"TableauBd",props:{idTableau:{},idBd:{}},setup(I){const{மொழியாக்கம்_பயன்படுத்து:d}=ve(),{$மொ:o}=d(),v=pe(),y=I,x=k(v.suivrePermission,{idObjet:_(()=>y.idTableau)}),s=k(v.tableaux.suivreNomsTableau,{idTableau:_(()=>y.idTableau)}),g=k(v.tableaux.suivreVariables,{idTableau:_(()=>y.idTableau)}),S=k(v.tableaux.suivreColonnesTableau,{idTableau:_(()=>y.idTableau)}),H=k(v.tableaux.suivreColonnesEtCatégoriesTableau,{idTableau:_(()=>y.idTableau)}),P=_(()=>(S.value||[]).map(r=>{const n=H.value?.find(l=>l.id===r.id)?.catégorie;return{key:r.id,sortable:n===void 0||(n?.type==="simple"?ha(n.catégorie):!1),info:{index:r.index,catégorie:n,variable:r.variable}}})),j=_(()=>{const r={key:"actions",sortable:!1,info:{}};return[...P.value,r]}),w=async({idVariable:r,idColonne:n,index:l,règles:f})=>{n=await v.tableaux.ajouterColonneTableau({idTableau:y.idTableau,idVariable:r,idColonne:n}),l&&await v.tableaux.changerColIndex({idTableau:y.idTableau,idColonne:n,val:!0});for(const V of f)await v.tableaux.ajouterRègleTableau({idTableau:y.idTableau,idColonne:n,règle:V})},A=async({idColonne:r,index:n,règles:l})=>{await v.tableaux.changerColIndex({idTableau:y.idTableau,idColonne:r,val:n});for(const f of l.nouvelles)await v.tableaux.ajouterRègleTableau({idTableau:y.idTableau,idColonne:r,règle:f});for(const f of l.àEffacer)await v.tableaux.effacerRègleTableau({idTableau:y.idTableau,idRègle:f})},N=async({idColonne:r})=>{await v.tableaux.effacerColonneTableau({idTableau:y.idTableau,idColonne:r})},F=k(v.tableaux.suivreDonnées,{idTableau:_(()=>y.idTableau)}),be=_(()=>{const r=F.value?.toSorted((l,f)=>ne.value&&ne.value.map(V=>l.données[V.key]===void 0?f.données[V.key]===void 0?0:V.order==="asc"?1:-1:f.données[V.key]===void 0?l.données[V.key]===void 0?0:V.order==="asc"?-1:1:l.données[V.key]>f.données[V.key]?V.order==="asc"?1:-1:l.données[V.key]<f.données[V.key]?V.order==="asc"?-1:1:0).find(V=>V!==0)||0),n={id:"-1",données:{}};return W.value&&r?[n,...r]:r}),ne=E(),R=E([]),Ve=k(v.tableaux.suivreRègles,{idTableau:_(()=>y.idTableau)}),W=E(!1),ee=E(!1),K=E(),U=_(()=>{const r=[];for(const[n,l]of Object.entries(K.value||{})){const f=F.value?.find(V=>V.id===n);f&&M({modifs:l,original:f.données})&&r.push({idÉlément:n,vals:l})}return r}),oe=_(()=>U.value.length+(Object.keys($.value).length?1:0)),M=({modifs:r,original:n})=>Object.keys(r).some(l=>n[l]!==r[l]),$=E({});Ee(()=>{W.value||($.value={})});const O=_(()=>Object.keys($.value).length>0),se=({val:r,idCol:n,idÉlément:l})=>{if(l==="-1")r!==void 0?$.value[n]=r:delete $.value[n];else{const f=K.value||{};f[l]||(f[l]={}),f[l][n]=r,K.value=f}},de=async({vals:r})=>Object.fromEntries(await Promise.all(Object.entries(r).map(async([n,l])=>{if(l instanceof File){const f=await v.ajouterÀSFIP({contenu:new Uint8Array(await l.arrayBuffer()),nomFichier:l.name});return[n,f]}else return[n,l]}))),_e=async()=>{ee.value=!0;for(const{idÉlément:r,vals:n}of U.value)await v.tableaux.modifierÉlément({idTableau:y.idTableau,idÉlément:r,vals:await de({vals:n})});O.value&&await ye(),K.value=void 0,ee.value=!1},ye=async()=>{await v.tableaux.ajouterÉlément({idTableau:y.idTableau,vals:await de({vals:$.value})}),$.value={}},ae=E(!1),X=E(!1),q=E(!1),c=E(!1),b=E(!1);Ye([c,b],()=>{ae.value=X.value});const i=async({idÉlément:r})=>{q.value=!0,await v.tableaux.effacerÉlément({idTableau:y.idTableau,idÉlément:r}),q.value=!1},m=async()=>{q.value=!0,await Promise.all(R.value.map(r=>i({idÉlément:r}))),R.value=[],q.value=!1},re=async()=>{await v.bds.effacerTableauBd({idBd:y.idBd,idTableau:y.idTableau})};return(r,n)=>(u(),p(Da,{modelValue:R.value,"onUpdate:modelValue":n[13]||(n[13]=l=>R.value=l),headers:j.value,items:be.value,"show-select":!!a(x),"multi-sort":"","onUpdate:sortBy":n[14]||(n[14]=l=>ne.value=l)},ea({top:t(()=>[e(Sa,{flat:"",density:"compact"},{default:t(()=>[e(G),a(x)?(u(),p(C,{key:0,icon:"",disabled:!oe.value,onClick:n[0]||(n[0]=()=>_e())},{default:t(()=>[oe.value?(u(),p(aa,{key:0,color:"success",content:oe.value},{default:t(()=>[e(Q,{color:"primary",icon:"mdi-content-save-outline"})]),_:1},8,["content"])):(u(),p(Q,{key:1,color:"primary",icon:"mdi-content-save-check-outline"}))]),_:1},8,["disabled"])):h("",!0),a(x)?(u(),p(qa,{key:1,modelValue:W.value,"onUpdate:modelValue":n[1]||(n[1]=l=>W.value=l),class:"me-4",density:"compact",color:"primary","true-icon":"mdi-pencil-outline","false-icon":"mdi-pencil-off-outline","hide-details":""},null,8,["modelValue"])):h("",!0),a(x)?(u(),p(Ma,{key:2,"id-tableau":r.idTableau,"variables-interdites":a(g),onNouvelle:n[2]||(n[2]=l=>w(l))},{activator:t(({props:l})=>[e(C,B(l,{icon:"mdi-table-column-plus-after"}),null,16)]),_:1},8,["id-tableau","variables-interdites"])):h("",!0),e(Qe,{"id-objet":r.idTableau,"type-objet":"tableau"},{activator:t(({props:l})=>[e(le,{text:a(o)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(C,B({...l,...f},{icon:"mdi-sync"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet"]),e(He,{"id-objet":r.idTableau,"noms-objet":a(s),"type-objet":"tableau"},{activator:t(({props:l})=>[e(le,{text:a(o)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:f})=>[e(C,B({...l,...f},{icon:"mdi-download"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),a(x)?(u(),p(Ge,{key:3,onEffacer:n[3]||(n[3]=()=>re())},{activator:t(({props:l})=>[e(C,B(l,{icon:"mdi-delete",color:"error"}),null,16)]),_:1})):h("",!0)]),_:1})]),"no-data":t(()=>[L("p",Xa,T(a(o)("tableaux.aucuneDonnée")),1),h("",!0)]),"item.actions":t(({item:l})=>[l.id==="-1"?(u(),p(C,{key:0,disabled:!O.value,icon:"mdi-content-save-outline",size:"small",variant:"flat",onClick:n[9]||(n[9]=()=>ye())},null,8,["disabled"])):ae.value&&a(x)?(u(),p(C,{key:1,size:"small",icon:"mdi-delete",variant:"flat",loading:q.value,onClick:()=>i({idÉlément:l.id})},null,8,["loading","onClick"])):a(x)?(u(),p(Be,{key:2,modelValue:c.value,"onUpdate:modelValue":n[12]||(n[12]=f=>c.value=f)},{activator:t(({props:f})=>[e(C,B(f,{variant:"flat",icon:"mdi-delete",size:"small",loading:q.value}),null,16,["loading"])]),default:t(()=>[e(z,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[D(T(a(o)("tableaux.données.titreEffacer")),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Se,{modelValue:X.value,"onUpdate:modelValue":n[10]||(n[10]=f=>X.value=f),label:a(o)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(C,{variant:"text",text:a(o)("communs.oui"),onClick:()=>{i({idÉlément:l.id}),c.value=!1}},null,8,["text","onClick"]),e(C,{variant:"text",color:"primary",text:a(o)("communs.non"),onClick:n[11]||(n[11]=f=>c.value=!1)},null,8,["text"]),e(G)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])):h("",!0)]),_:2},[me(P.value||[],l=>({name:`header.${l.key}`,fn:t(({column:f,isSorted:V,getSortIcon:We,toggleSort:Ke})=>[e(Aa,{"id-colonne":l.key,"id-variable":l.info.variable,"id-tableau":r.idTableau,index:!!l.info.index,regles:a(Ve)?.filter(Te=>Te.colonne===l.key),"permission-modifier":!!a(x),ordonnable:f.sortable,"est-ordonnee":V(f),"icone-ordonner":We(f),onBasculerOrdonner:()=>Ke(f),onSauvegarder:Te=>A({idColonne:l.key,...Te}),onEffacer:()=>N({idColonne:l.key})},null,8,["id-colonne","id-variable","id-tableau","index","regles","permission-modifier","ordonnable","est-ordonnee","icone-ordonner","onBasculerOrdonner","onSauvegarder","onEffacer"])])})),a(x)?{name:"header.actions",fn:t(()=>[ae.value?(u(),p(C,{key:0,icon:"mdi-delete",variant:"flat",size:"small",loading:q.value,readonly:!R.value.length,onClick:n[4]||(n[4]=()=>m())},null,8,["loading","readonly"])):(u(),p(Be,{key:1,modelValue:b.value,"onUpdate:modelValue":n[8]||(n[8]=l=>b.value=l)},{activator:t(({props:l})=>[e(C,B(l,{icon:"",variant:"flat",size:"small",readonly:!R.value.length,loading:q.value}),{default:t(()=>[e(Q,{icon:"mdi-delete",color:R.value.length?void 0:"disabled"},null,8,["color"])]),_:2},1040,["readonly","loading"])]),default:t(()=>[e(z,{class:"mx-auto","max-width":"450"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[D(T(a(o)("tableaux.données.titreEffacerSélectionnées",R.value.length)),1)]),_:1})]),_:1}),e(fe,null,{default:t(()=>[e(Se,{modelValue:X.value,"onUpdate:modelValue":n[5]||(n[5]=l=>X.value=l),label:a(o)("tableaux.données.nePlusConfirmerEffacer")},null,8,["modelValue","label"])]),_:1}),e(he,null,{default:t(()=>[e(G),e(C,{variant:"text",text:a(o)("communs.oui"),onClick:n[6]||(n[6]=()=>{m(),b.value=!1})},null,8,["text"]),e(C,{variant:"text",color:"primary",text:a(o)("communs.non"),onClick:n[7]||(n[7]=l=>b.value=!1)},null,8,["text"]),e(G)]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),key:"0"}:void 0,me(P.value,l=>({name:`item.${l.key}`,fn:t(({item:f})=>[e(Ea,{categorie:l.info.catégorie?.catégorie,val:f.données[l.key],editable:!!a(x)&&W.value,onModifiee:({val:V})=>se({idCol:l.key,idÉlément:f.id,val:V})},null,8,["categorie","val","editable","onModifiee"])])}))]),1032,["modelValue","headers","items","show-select"]))}}),Ja={class:"text-center"},Ya={class:"text-center"},et={key:0,class:"text-disabled"},at={class:"text-center"},tt={class:"mt-6 text-h5"},it={class:"d-flex flex-wrap"},lt={class:"mt-6 text-h5"},nt={key:0,class:"text-disabled"},ot={class:"mt-6 text-h5"},st={key:2,class:"text-center"},dt={class:"text-h5 mt-5"},kt=Y({__name:"PageBd",props:{id:{}},setup(I){const d=I,o=pe(),{mdAndUp:v}=Ae(),{isRtl:y}=ta(),{மொழியாக்கம்_பயன்படுத்து:x}=ve(),{$மொ:s}=x(),{அகராதியிலிருந்து_மொழிபெயர்ப்பு:g}=ia(),{obtImageDéco:S}=na(),H=ja();la(()=>{H.documentOuvert({id:d.id,à:Date.now()})});const P=S("vide"),j=k(o.suivrePermission,{idObjet:_(()=>d.id)}),w=k(o.bds.suivreNomsBd,{idBd:_(()=>d.id)}),A=g(w),N=async c=>{const{àEffacer:b,àAjouter:i}=Oe({anciennes:w.value,nouvelles:c});for(const m of b)await o.bds.effacerNomBd({idBd:d.id,langue:m});await o.bds.sauvegarderNomsBd({idBd:d.id,noms:i})},F=k(o.bds.suivreDescriptionsBd,{idBd:_(()=>d.id)}),be=g(F),ne=async c=>{const{àEffacer:b,àAjouter:i}=Oe({anciennes:F.value,nouvelles:c});for(const m of b)await o.bds.effacerDescriptionBd({idBd:d.id,langue:m});await o.bds.sauvegarderDescriptionsBd({idBd:d.id,descriptions:i})},R=oa(k(o.bds.suivreImage,{idBd:_(()=>d.id)})),Ve=S("logoBD"),W=async c=>{c?await o.bds.sauvegarderImage({idBd:d.id,image:{contenu:new Uint8Array(c.contenu),nomFichier:c.fichier}}):await o.bds.effacerImage({idBd:d.id})},ee=k(o.bds.suivreStatutBd,{idBd:_(()=>d.id)}),K=k(o.bds.suivreVariablesBd,{idBd:_(()=>d.id)}),U=k(o.bds.suivreMotsClefsBd,{idBd:_(()=>d.id)}),oe=async c=>{const b=c.filter(m=>!U.value?.includes(m)),i=U.value?.filter(m=>!c.includes(m))||[];await o.bds.ajouterMotsClefsBd({idBd:d.id,idsMotsClefs:b}),await Promise.all(i.map(m=>o.bds.effacerMotClefBd({idBd:d.id,idMotClef:m})))},M=k(o.bds.suivreTableauxBd,{idBd:_(()=>d.id)}),$=E();Ee(()=>{!$.value&&M.value?.length&&($.value=M.value[0].clef),$.value&&!M.value?.map(c=>c.clef).includes($.value)&&($.value=void 0)});const O=E(!1),se=async({noms:c,cols:b})=>{O.value=!0;try{const i=await o.bds.ajouterTableauBd({idBd:d.id});await o.tableaux.sauvegarderNomsTableau({idTableau:i,noms:ze(c)}),await Promise.all(b.map(async m=>{await o.tableaux.ajouterColonneTableau({idTableau:i,idColonne:m.info.id,idVariable:m.info.variable}),m.info.index&&await o.tableaux.changerColIndex({idTableau:i,idColonne:m.info.id,val:!0}),await Promise.all(m.règles.map(async re=>await o.tableaux.ajouterRègleTableau({idTableau:i,idColonne:m.info.id,règle:re})))}))}finally{O.value=!1}},de=k(o.réseau.suivreAuteursBd,{idBd:_(()=>d.id)}),_e=k(o.bds.suivreLicenceBd,{idBd:_(()=>d.id)}),ye=k(o.bds.suivreLicenceContenuBd,{idBd:_(()=>d.id)}),ae=async({licence:c,licenceContenu:b})=>{await o.bds.changerLicenceBd({idBd:d.id,licence:c}),b&&await o.bds.changerLicenceContenuBd({idBd:d.id,licenceContenu:b})},X=_(()=>[{title:s("navigation.données"),href:encodeURI("/données/")},{title:A.value||s("bds.sansNom"),disabled:!0}]),q=async()=>{await o.bds.effacerBd({idBd:d.id})};return(c,b)=>(u(),p(sa,null,{default:t(()=>[L("div",null,[a(v)?(u(),p(Ia,{key:0,items:X.value,class:"pa-0"},{divider:t(()=>[e(Q,null,{default:t(()=>[D(T(a(y)?"mdi-chevron-left":"mdi-chevron-right"),1)]),_:1})]),title:t(({item:i})=>[e(Na,{disabled:i.disabled,onClick:m=>i.href&&c.$router.push(i.href)},{default:t(()=>[e(da,{texte:i.title,"longueur-max":35},null,8,["texte"])]),_:2},1032,["disabled","onClick"])]),_:1},8,["items"])):(u(),p(C,{key:1,icon:"mdi-arrow-left-top",variant:"flat",onClick:b[0]||(b[0]=()=>c.$router.push(encodeURI("/données/")))}))]),e(ua,{"src-image":a(R),"img-defaut":a(Ve),editable:!!a(j),"taille-avatar":a(v)?275:175,"max-taille-image":a(ra),onImageChangee:b[1]||(b[1]=i=>W(i))},null,8,["src-image","img-defaut","editable","taille-avatar","max-taille-image"]),L("div",Ja,[e(Ie,{"etiquette-nom":a(s)("objet.étiquetteNom"),"indice-nom":a(s)("objet.indiceNom"),"indice-langue":a(s)("objet.indiceLangue"),"texte-aucun-nom":a(s)("objet.texteAucunNom"),"noms-initiaux":a(w),titre:a(s)("objet.titreDialogueNoms"),"sous-titre":a(s)("objet.sousTitreDialogueNoms"),"autorisation-modification":!!a(j),onAjusterNoms:N},{activator:t(({props:i})=>[L("span",B(i,{class:"text-h4"}),[D(T(a(A)||a(s)("bds.sansNom"))+" ",1),e(C,{icon:a(j)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"},null,8,["icon"])],16)]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),e(ca,{id:c.id},null,8,["id"]),e(G)]),L("div",Ya,[e(Le,{"n-max":5,items:a(U)},{jeton:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:m})=>[e(fa,B(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Ne,{id:i},{activator:t(({props:m})=>[e(ma,B(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(U)&&!a(U).length?(u(),ie("span",et,T(a(s)("bds.aucunMotClef")),1)):h("",!0),a(j)&&a(U)?(u(),p(va,{key:1,originaux:a(U),onSauvegarder:b[2]||(b[2]=i=>oe(i))},null,8,["originaux"])):h("",!0)]),L("div",at,[e(ba,{"id-bd":c.id},{activator:t(({props:i})=>[e(le,{"open-delay":"200",location:"bottom",text:a(s)("épingler.épingler")},{activator:t(({props:m})=>[e(C,B({...i,...m},{icon:"",variant:"flat"}),{default:t(()=>[e(pa,{id:c.id},null,8,["id"])]),_:2},1040)]),_:2},1032,["text"])]),_:1},8,["id-bd"]),e(He,{"id-objet":c.id,"noms-objet":a(w),"type-objet":"bd"},{activator:t(({props:i})=>[e(le,{text:a(s)("exportations.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(C,B({...i,...m},{icon:"mdi-download",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id-objet","noms-objet"]),e(Ga,{id:c.id},{activator:t(({props:i})=>[e(le,{text:a(s)("code.indice"),"open-delay":200,location:"bottom"},{activator:t(({props:m})=>[e(C,B({...i,...m},{icon:"mdi-xml",variant:"flat"}),null,16)]),_:2},1032,["text"])]),_:1},8,["id"]),h("",!0),a(j)?(u(),p(Ge,{key:1,onEffacer:q},{activator:t(({props:i})=>[e(le,{"open-delay":"200",location:"bottom",text:a(s)("effacer.indice")},{activator:t(({props:m})=>[e(C,B({...i,...m},{variant:"flat",icon:""}),{default:t(()=>[e(Q,{color:"error"},{default:t(()=>b[7]||(b[7]=[D("mdi-delete")])),_:1})]),_:2},1040)]),_:2},1032,["text"])]),_:1})):h("",!0)]),e(ce),e(fe,null,{default:t(()=>[e(Ie,{"etiquette-nom":a(s)("objet.étiquetteDescription"),"indice-nom":a(s)("objet.indiceDescription"),"indice-langue":a(s)("objet.indiceLangue"),"texte-aucun-nom":a(s)("objet.texteAucuneDescription"),"noms-initiaux":a(F),titre:a(s)("objet.titreDialogueDescriptions"),"sous-titre":a(s)("objet.sousTitreDialogueDescriptions"),"autorisation-modification":!!a(j),longue:"",onAjusterNoms:ne},{activator:t(({props:i})=>[L("span",{class:_a({"text-disabled":!a(be)})},T(a(be)||a(s)("communs.baseCarteObjet.sansDescription")),3),e(C,B(i,{icon:a(j)?"mdi-pencil":"mdi-earth",variant:"flat",size:"small"}),null,16,["icon"])]),_:1},8,["etiquette-nom","indice-nom","indice-langue","texte-aucun-nom","noms-initiaux","titre","sous-titre","autorisation-modification"]),L("p",tt,T(a(s)("bds.info")),1),e(ce,{class:"mb-2"}),L("div",it,[a(ee)&&(a(ee).statut!=="active"||a(j))?(u(),p(z,{key:0,flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Ha,{"id-bd":c.id},{activator:t(({props:i})=>[e(La,B(i,{"type-objet":"bd",statut:a(ee)}),null,16,["statut"])]),_:1},8,["id-bd"])]),_:1})):h("",!0),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Qa,{"id-bd":c.id},{activator:t(({props:i})=>[e(Wa,B(i,{id:c.id}),null,16,["id"])]),_:1},8,["id-bd"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ya,{id:c.id,auteurs:a(de),"permission-moderateur":a(j)==="MODÉRATEUR"},{activator:t(({props:i})=>[e(Pa,B(i,{auteurs:a(de)}),null,16,["auteurs"])]),_:1},8,["id","auteurs","permission-moderateur"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(qe,{licence:a(_e),"licence-contenu":a(ye),"permission-modifier":a(j)==="MODÉRATEUR",onChangerLicence:ae},{activator:t(({props:i})=>[e(Ka,B(i,{licence:a(_e),onChangerLicence:ae}),null,16,["licence"])]),_:1},8,["licence","licence-contenu","permission-modifier"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(ga,{id:c.id},{activator:t(({props:i})=>[e(Oa,B(i,{id:c.id}),null,16,["id"])]),_:1},8,["id"])]),_:1}),e(z,{flat:"",width:"200",class:"mb-3"},{default:t(()=>[e(Qe,{"id-objet":c.id,permission:a(j),"type-objet":"bd"},{activator:t(({props:i})=>[e(Ra,B(i,{"id-objet":c.id}),null,16,["id-objet"])]),_:1},8,["id-objet","permission"])]),_:1})]),L("p",lt,T(a(s)("bds.variables")),1),e(ce,{class:"mb-2"}),e(Le,{"n-max":5,items:a(K)},{jeton:t(({id:i})=>[e(Pe,{id:i},{activator:t(({props:m})=>[e(Ba,B(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),itemListe:t(({id:i})=>[e(Pe,{id:i},{activator:t(({props:m})=>[e(xa,B(m,{id:i}),null,16,["id"])]),_:2},1032,["id"])]),_:1},8,["items"]),a(K)?.length?h("",!0):(u(),ie("p",nt,T(a(s)("bds.aucuneVariable")),1)),e(Me,null,{default:t(()=>[L("p",ot,T(a(s)("bds.tableaux")),1),e(ce),a(v)?(u(),p(za,{key:0,modelValue:$.value,"onUpdate:modelValue":b[4]||(b[4]=i=>$.value=i),class:"mt-2"},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(Fa,{key:i.clef,value:i.clef,color:"primary",size:"small",density:"compact"},{default:t(()=>[e(Re,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["value"]))),128)),e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(j)?(u(),p(je,B({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",disabled:O.value,variant:"text",class:"mx-1 my-auto",size:"x-large",label:"",onClick:b[3]||(b[3]=Ca(()=>{},["stop"]))}),{default:t(()=>[D(T(a(s)("tableaux.nouveau"))+" ",1),O.value?(u(),p(J,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):h("",!0)]),_:2},1040,["append-icon","disabled"])):h("",!0)]),_:1})]),_:1},8,["modelValue"])):(u(),p(ka,{key:1,modelValue:$.value,"onUpdate:modelValue":b[5]||(b[5]=i=>$.value=i),class:"mt-4","show-arrows":"","center-active":""},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(Ue,{key:i.clef,value:i.clef},{default:t(({isSelected:m,toggle:re})=>[e(je,{class:"mx-1",variant:"tonal",label:"",active:!1,color:m?"primary":"",onClick:re},{default:t(()=>[e(Re,{id:i.id,clef:i.clef},null,8,["id","clef"])]),_:2},1032,["color","onClick"])]),_:2},1032,["value"]))),128)),e(Ue,{key:"nouveau",value:"nouveau"},{default:t(()=>[e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(j)?(u(),p(je,B({key:0},i,{"append-icon":O.value?void 0:"mdi-plus",variant:"tonal",class:"mx-1",label:"",disabled:O.value}),{default:t(()=>[D(T(a(s)("tableaux.nouveau"))+" ",1),O.value?(u(),p(J,{key:0,class:"ms-2",size:"15",width:"1",indeterminate:""})):h("",!0)]),_:2},1040,["append-icon","disabled"])):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])),a(M)&&!a(M).length?(u(),ie("div",st,[L("p",dt,T(a(s)("tableaux.aucun")),1),e(Va,{src:a(P),class:"my-5",contain:"",height:"175px"},null,8,["src"]),e($e,{onSauvegarder:se},{activator:t(({props:i})=>[a(j)?(u(),p(C,B({key:0},i,{color:"primary",class:"mx-2",variant:"outlined"}),{prepend:t(()=>[e(Q,{icon:"mdi-table",start:""})]),default:t(()=>[D(" "+T(a(s)("tableaux.nouveau")),1)]),_:2},1040)):h("",!0)]),_:1})])):h("",!0)]),_:1}),e(Ta,{modelValue:$.value,"onUpdate:modelValue":b[6]||(b[6]=i=>$.value=i)},{default:t(()=>[(u(!0),ie(we,null,me(a(M),i=>(u(),p(wa,{key:i.clef,value:i.clef},{default:t(()=>[e(Za,{"id-tableau":i.id,"id-bd":c.id},null,8,["id-tableau","id-bd"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{kt as default};
//# sourceMappingURL=PageBd-DQHu1bsD.js.map
